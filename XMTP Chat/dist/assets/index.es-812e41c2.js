import{B as Y1,s as Sa,f as Ia,a as Oa,d as xa,c as kr,g as X1,b as le,e as Nr,h as Z1,w as Lh,r as $s,i as Xt,j as fa,k as Pa,x as qh,H as ev,l as Mh,m as tv,E as Na,_ as rv}from"./index-f9203ab0.js";import{i as wl,c as iv,a as nv,f as Ta,p as sv,J as ti,b as Ca,d as Aa,e as Ra,g as Xr,h as Mr,j as In,k as ov,l as av,H as yi}from"./http-02cc29cb.js";function Vt(o,t="utf8"){const r=Y1[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(o.buffer,o.byteOffset,o.byteLength).toString("utf8"):r.encoder.encode(o).substring(1)}const cv={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};var Le={};Object.defineProperty(Le,"__esModule",{value:!0});Le.getLocalStorage=Le.getLocalStorageOrThrow=Le.getCrypto=Le.getCryptoOrThrow=Le.getLocation=Le.getLocationOrThrow=Le.getNavigator=Le.getNavigatorOrThrow=Le.getDocument=Le.getDocumentOrThrow=Le.getFromWindowOrThrow=Le.getFromWindow=void 0;function mi(o){let t;return typeof window<"u"&&typeof window[o]<"u"&&(t=window[o]),t}Le.getFromWindow=mi;function zi(o){const t=mi(o);if(!t)throw new Error(`${o} is not defined in Window`);return t}Le.getFromWindowOrThrow=zi;function uv(){return zi("document")}Le.getDocumentOrThrow=uv;function lv(){return mi("document")}Le.getDocument=lv;function hv(){return zi("navigator")}Le.getNavigatorOrThrow=hv;function fv(){return mi("navigator")}Le.getNavigator=fv;function dv(){return zi("location")}Le.getLocationOrThrow=dv;function pv(){return mi("location")}Le.getLocation=pv;function gv(){return zi("crypto")}Le.getCryptoOrThrow=gv;function yv(){return mi("crypto")}Le.getCrypto=yv;function mv(){return zi("localStorage")}Le.getLocalStorageOrThrow=mv;function vv(){return mi("localStorage")}Le.getLocalStorage=vv;var $a={};Object.defineProperty($a,"__esModule",{value:!0});$a.getWindowMetadata=void 0;const bl=Le;function _v(){let o,t;try{o=bl.getDocumentOrThrow(),t=bl.getLocationOrThrow()}catch{return null}function r(){const U=o.getElementsByTagName("link"),K=[];for(let J=0;J<U.length;J++){const H=U[J],X=H.getAttribute("rel");if(X&&X.toLowerCase().indexOf("icon")>-1){const G=H.getAttribute("href");if(G)if(G.toLowerCase().indexOf("https:")===-1&&G.toLowerCase().indexOf("http:")===-1&&G.indexOf("//")!==0){let oe=t.protocol+"//"+t.host;if(G.indexOf("/")===0)oe+=G;else{const f=t.pathname.split("/");f.pop();const y=f.join("/");oe+=y+"/"+G}K.push(oe)}else if(G.indexOf("//")===0){const oe=t.protocol+G;K.push(oe)}else K.push(G)}}return K}function n(...U){const K=o.getElementsByTagName("meta");for(let J=0;J<K.length;J++){const H=K[J],X=["itemprop","property","name"].map(G=>H.getAttribute(G)).filter(G=>G?U.includes(G):!1);if(X.length&&X){const G=H.getAttribute("content");if(G)return G}}return""}function a(){let U=n("name","og:site_name","og:title","twitter:title");return U||(U=o.title),U}function l(){return n("description","og:description","twitter:description","keywords")}const g=a(),O=l(),N=t.origin,F=r();return{description:O,url:N,icons:F,name:g}}$a.getWindowMetadata=_v;var wv={};(function(o){const t=Oa,r=xa,n=Sa,a=Ia,l=f=>f==null,g=Symbol("encodeFragmentIdentifier");function O(f){switch(f.arrayFormat){case"index":return y=>(E,b)=>{const m=E.length;return b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,[C(y,f),"[",m,"]"].join("")]:[...E,[C(y,f),"[",C(m,f),"]=",C(b,f)].join("")]};case"bracket":return y=>(E,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,[C(y,f),"[]"].join("")]:[...E,[C(y,f),"[]=",C(b,f)].join("")];case"colon-list-separator":return y=>(E,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,[C(y,f),":list="].join("")]:[...E,[C(y,f),":list=",C(b,f)].join("")];case"comma":case"separator":case"bracket-separator":{const y=f.arrayFormat==="bracket-separator"?"[]=":"=";return E=>(b,m)=>m===void 0||f.skipNull&&m===null||f.skipEmptyString&&m===""?b:(m=m===null?"":m,b.length===0?[[C(E,f),y,C(m,f)].join("")]:[[b,C(m,f)].join(f.arrayFormatSeparator)])}default:return y=>(E,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,C(y,f)]:[...E,[C(y,f),"=",C(b,f)].join("")]}}function N(f){let y;switch(f.arrayFormat){case"index":return(E,b,m)=>{if(y=/\[(\d*)\]$/.exec(E),E=E.replace(/\[\d*\]$/,""),!y){m[E]=b;return}m[E]===void 0&&(m[E]={}),m[E][y[1]]=b};case"bracket":return(E,b,m)=>{if(y=/(\[\])$/.exec(E),E=E.replace(/\[\]$/,""),!y){m[E]=b;return}if(m[E]===void 0){m[E]=[b];return}m[E]=[].concat(m[E],b)};case"colon-list-separator":return(E,b,m)=>{if(y=/(:list)$/.exec(E),E=E.replace(/:list$/,""),!y){m[E]=b;return}if(m[E]===void 0){m[E]=[b];return}m[E]=[].concat(m[E],b)};case"comma":case"separator":return(E,b,m)=>{const $=typeof b=="string"&&b.includes(f.arrayFormatSeparator),x=typeof b=="string"&&!$&&U(b,f).includes(f.arrayFormatSeparator);b=x?U(b,f):b;const re=$||x?b.split(f.arrayFormatSeparator).map(d=>U(d,f)):b===null?b:U(b,f);m[E]=re};case"bracket-separator":return(E,b,m)=>{const $=/(\[\])$/.test(E);if(E=E.replace(/\[\]$/,""),!$){m[E]=b&&U(b,f);return}const x=b===null?[]:b.split(f.arrayFormatSeparator).map(re=>U(re,f));if(m[E]===void 0){m[E]=x;return}m[E]=[].concat(m[E],x)};default:return(E,b,m)=>{if(m[E]===void 0){m[E]=b;return}m[E]=[].concat(m[E],b)}}}function F(f){if(typeof f!="string"||f.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function C(f,y){return y.encode?y.strict?t(f):encodeURIComponent(f):f}function U(f,y){return y.decode?r(f):f}function K(f){return Array.isArray(f)?f.sort():typeof f=="object"?K(Object.keys(f)).sort((y,E)=>Number(y)-Number(E)).map(y=>f[y]):f}function J(f){const y=f.indexOf("#");return y!==-1&&(f=f.slice(0,y)),f}function H(f){let y="";const E=f.indexOf("#");return E!==-1&&(y=f.slice(E)),y}function X(f){f=J(f);const y=f.indexOf("?");return y===-1?"":f.slice(y+1)}function G(f,y){return y.parseNumbers&&!Number.isNaN(Number(f))&&typeof f=="string"&&f.trim()!==""?f=Number(f):y.parseBooleans&&f!==null&&(f.toLowerCase()==="true"||f.toLowerCase()==="false")&&(f=f.toLowerCase()==="true"),f}function oe(f,y){y=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},y),F(y.arrayFormatSeparator);const E=N(y),b=Object.create(null);if(typeof f!="string"||(f=f.trim().replace(/^[?#&]/,""),!f))return b;for(const m of f.split("&")){if(m==="")continue;let[$,x]=n(y.decode?m.replace(/\+/g," "):m,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(y.arrayFormat)?x:U(x,y),E(U($,y),x,b)}for(const m of Object.keys(b)){const $=b[m];if(typeof $=="object"&&$!==null)for(const x of Object.keys($))$[x]=G($[x],y);else b[m]=G($,y)}return y.sort===!1?b:(y.sort===!0?Object.keys(b).sort():Object.keys(b).sort(y.sort)).reduce((m,$)=>{const x=b[$];return x&&typeof x=="object"&&!Array.isArray(x)?m[$]=K(x):m[$]=x,m},Object.create(null))}o.extract=X,o.parse=oe,o.stringify=(f,y)=>{if(!f)return"";y=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},y),F(y.arrayFormatSeparator);const E=x=>y.skipNull&&l(f[x])||y.skipEmptyString&&f[x]==="",b=O(y),m={};for(const x of Object.keys(f))E(x)||(m[x]=f[x]);const $=Object.keys(m);return y.sort!==!1&&$.sort(y.sort),$.map(x=>{const re=f[x];return re===void 0?"":re===null?C(x,y):Array.isArray(re)?re.length===0&&y.arrayFormat==="bracket-separator"?C(x,y)+"[]":re.reduce(b(x),[]).join("&"):C(x,y)+"="+C(re,y)}).filter(x=>x.length>0).join("&")},o.parseUrl=(f,y)=>{y=Object.assign({decode:!0},y);const[E,b]=n(f,"#");return Object.assign({url:E.split("?")[0]||"",query:oe(X(f),y)},y&&y.parseFragmentIdentifier&&b?{fragmentIdentifier:U(b,y)}:{})},o.stringifyUrl=(f,y)=>{y=Object.assign({encode:!0,strict:!0,[g]:!0},y);const E=J(f.url).split("?")[0]||"",b=o.extract(f.url),m=o.parse(b,{sort:!1}),$=Object.assign(m,f.query);let x=o.stringify($,y);x&&(x=`?${x}`);let re=H(f.url);return f.fragmentIdentifier&&(re=`#${y[g]?C(f.fragmentIdentifier,y):f.fragmentIdentifier}`),`${E}${x}${re}`},o.pick=(f,y,E)=>{E=Object.assign({parseFragmentIdentifier:!0,[g]:!1},E);const{url:b,query:m,fragmentIdentifier:$}=o.parseUrl(f,E);return o.stringifyUrl({url:b,query:a(m,y),fragmentIdentifier:$},E)},o.exclude=(f,y,E)=>{const b=Array.isArray(y)?m=>!y.includes(m):(m,$)=>!y(m,$);return o.pick(f,b,E)}})(wv);function bv(o,t=[]){const r=[];return Object.keys(o).forEach(n=>{if(t.length&&!t.includes(n))return;const a=o[n];r.push(...a.accounts)}),r}const Ev={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Sv(o,t){const{message:r,code:n}=Ev[o];return{message:t?`${r} ${t}`:r,code:n}}function da(o,t){return Array.isArray(o)?typeof t<"u"&&o.length?o.every(t):!0:!1}var Fs={},kh={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(o){var t,r,n,a,l,g,O,N,F,C,U,K,J,H,X,G,oe,f,y,E,b,m,$;(function(x){var re=typeof kr=="object"?kr:typeof self=="object"?self:typeof this=="object"?this:{};x(d(re,d(o.exports)));function d(S,I){return S!==re&&(typeof Object.create=="function"?Object.defineProperty(S,"__esModule",{value:!0}):S.__esModule=!0),function(A,w){return S[A]=I?I(A,w):w}}})(function(x){var re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,S){d.__proto__=S}||function(d,S){for(var I in S)S.hasOwnProperty(I)&&(d[I]=S[I])};t=function(d,S){re(d,S);function I(){this.constructor=d}d.prototype=S===null?Object.create(S):(I.prototype=S.prototype,new I)},r=Object.assign||function(d){for(var S,I=1,A=arguments.length;I<A;I++){S=arguments[I];for(var w in S)Object.prototype.hasOwnProperty.call(S,w)&&(d[w]=S[w])}return d},n=function(d,S){var I={};for(var A in d)Object.prototype.hasOwnProperty.call(d,A)&&S.indexOf(A)<0&&(I[A]=d[A]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var w=0,A=Object.getOwnPropertySymbols(d);w<A.length;w++)S.indexOf(A[w])<0&&Object.prototype.propertyIsEnumerable.call(d,A[w])&&(I[A[w]]=d[A[w]]);return I},a=function(d,S,I,A){var w=arguments.length,_=w<3?S:A===null?A=Object.getOwnPropertyDescriptor(S,I):A,k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(d,S,I,A);else for(var ee=d.length-1;ee>=0;ee--)(k=d[ee])&&(_=(w<3?k(_):w>3?k(S,I,_):k(S,I))||_);return w>3&&_&&Object.defineProperty(S,I,_),_},l=function(d,S){return function(I,A){S(I,A,d)}},g=function(d,S){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,S)},O=function(d,S,I,A){function w(_){return _ instanceof I?_:new I(function(k){k(_)})}return new(I||(I=Promise))(function(_,k){function ee(z){try{D(A.next(z))}catch(ie){k(ie)}}function te(z){try{D(A.throw(z))}catch(ie){k(ie)}}function D(z){z.done?_(z.value):w(z.value).then(ee,te)}D((A=A.apply(d,S||[])).next())})},N=function(d,S){var I={label:0,sent:function(){if(_[0]&1)throw _[1];return _[1]},trys:[],ops:[]},A,w,_,k;return k={next:ee(0),throw:ee(1),return:ee(2)},typeof Symbol=="function"&&(k[Symbol.iterator]=function(){return this}),k;function ee(D){return function(z){return te([D,z])}}function te(D){if(A)throw new TypeError("Generator is already executing.");for(;I;)try{if(A=1,w&&(_=D[0]&2?w.return:D[0]?w.throw||((_=w.return)&&_.call(w),0):w.next)&&!(_=_.call(w,D[1])).done)return _;switch(w=0,_&&(D=[D[0]&2,_.value]),D[0]){case 0:case 1:_=D;break;case 4:return I.label++,{value:D[1],done:!1};case 5:I.label++,w=D[1],D=[0];continue;case 7:D=I.ops.pop(),I.trys.pop();continue;default:if(_=I.trys,!(_=_.length>0&&_[_.length-1])&&(D[0]===6||D[0]===2)){I=0;continue}if(D[0]===3&&(!_||D[1]>_[0]&&D[1]<_[3])){I.label=D[1];break}if(D[0]===6&&I.label<_[1]){I.label=_[1],_=D;break}if(_&&I.label<_[2]){I.label=_[2],I.ops.push(D);break}_[2]&&I.ops.pop(),I.trys.pop();continue}D=S.call(d,I)}catch(z){D=[6,z],w=0}finally{A=_=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}},$=function(d,S,I,A){A===void 0&&(A=I),d[A]=S[I]},F=function(d,S){for(var I in d)I!=="default"&&!S.hasOwnProperty(I)&&(S[I]=d[I])},C=function(d){var S=typeof Symbol=="function"&&Symbol.iterator,I=S&&d[S],A=0;if(I)return I.call(d);if(d&&typeof d.length=="number")return{next:function(){return d&&A>=d.length&&(d=void 0),{value:d&&d[A++],done:!d}}};throw new TypeError(S?"Object is not iterable.":"Symbol.iterator is not defined.")},U=function(d,S){var I=typeof Symbol=="function"&&d[Symbol.iterator];if(!I)return d;var A=I.call(d),w,_=[],k;try{for(;(S===void 0||S-- >0)&&!(w=A.next()).done;)_.push(w.value)}catch(ee){k={error:ee}}finally{try{w&&!w.done&&(I=A.return)&&I.call(A)}finally{if(k)throw k.error}}return _},K=function(){for(var d=[],S=0;S<arguments.length;S++)d=d.concat(U(arguments[S]));return d},J=function(){for(var d=0,S=0,I=arguments.length;S<I;S++)d+=arguments[S].length;for(var A=Array(d),w=0,S=0;S<I;S++)for(var _=arguments[S],k=0,ee=_.length;k<ee;k++,w++)A[w]=_[k];return A},H=function(d){return this instanceof H?(this.v=d,this):new H(d)},X=function(d,S,I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var A=I.apply(d,S||[]),w,_=[];return w={},k("next"),k("throw"),k("return"),w[Symbol.asyncIterator]=function(){return this},w;function k(ae){A[ae]&&(w[ae]=function(ge){return new Promise(function(et,nt){_.push([ae,ge,et,nt])>1||ee(ae,ge)})})}function ee(ae,ge){try{te(A[ae](ge))}catch(et){ie(_[0][3],et)}}function te(ae){ae.value instanceof H?Promise.resolve(ae.value.v).then(D,z):ie(_[0][2],ae)}function D(ae){ee("next",ae)}function z(ae){ee("throw",ae)}function ie(ae,ge){ae(ge),_.shift(),_.length&&ee(_[0][0],_[0][1])}},G=function(d){var S,I;return S={},A("next"),A("throw",function(w){throw w}),A("return"),S[Symbol.iterator]=function(){return this},S;function A(w,_){S[w]=d[w]?function(k){return(I=!I)?{value:H(d[w](k)),done:w==="return"}:_?_(k):k}:_}},oe=function(d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var S=d[Symbol.asyncIterator],I;return S?S.call(d):(d=typeof C=="function"?C(d):d[Symbol.iterator](),I={},A("next"),A("throw"),A("return"),I[Symbol.asyncIterator]=function(){return this},I);function A(_){I[_]=d[_]&&function(k){return new Promise(function(ee,te){k=d[_](k),w(ee,te,k.done,k.value)})}}function w(_,k,ee,te){Promise.resolve(te).then(function(D){_({value:D,done:ee})},k)}},f=function(d,S){return Object.defineProperty?Object.defineProperty(d,"raw",{value:S}):d.raw=S,d},y=function(d){if(d&&d.__esModule)return d;var S={};if(d!=null)for(var I in d)Object.hasOwnProperty.call(d,I)&&(S[I]=d[I]);return S.default=d,S},E=function(d){return d&&d.__esModule?d:{default:d}},b=function(d,S){if(!S.has(d))throw new TypeError("attempted to get private field on non-instance");return S.get(d)},m=function(d,S,I){if(!S.has(d))throw new TypeError("attempted to set private field on non-instance");return S.set(d,I),I},x("__extends",t),x("__assign",r),x("__rest",n),x("__decorate",a),x("__param",l),x("__metadata",g),x("__awaiter",O),x("__generator",N),x("__exportStar",F),x("__createBinding",$),x("__values",C),x("__read",U),x("__spread",K),x("__spreadArrays",J),x("__await",H),x("__asyncGenerator",X),x("__asyncDelegator",G),x("__asyncValues",oe),x("__makeTemplateObject",f),x("__importStar",y),x("__importDefault",E),x("__classPrivateFieldGet",b),x("__classPrivateFieldSet",m)})})(kh);var zh=kh.exports,Nn={};Object.defineProperty(Nn,"__esModule",{value:!0});function Iv(o){if(typeof o!="string")throw new Error(`Cannot safe json parse value of type ${typeof o}`);try{return JSON.parse(o)}catch{return o}}Nn.safeJsonParse=Iv;function Ov(o){return typeof o=="string"?o:JSON.stringify(o,(t,r)=>typeof r>"u"?null:r)}Nn.safeJsonStringify=Ov;var hn={exports:{}},El;function xv(){return El||(El=1,function(){let o;function t(){}o=t,o.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},o.prototype.setItem=function(r,n){this[r]=String(n)},o.prototype.removeItem=function(r){delete this[r]},o.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},o.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},o.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof kr<"u"&&kr.localStorage?hn.exports=kr.localStorage:typeof window<"u"&&window.localStorage?hn.exports=window.localStorage:hn.exports=new t}()),hn.exports}var Qo={},fn={},Sl;function Pv(){if(Sl)return fn;Sl=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.IKeyValueStorage=void 0;class o{}return fn.IKeyValueStorage=o,fn}var dn={},Il;function Nv(){if(Il)return dn;Il=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.parseEntry=void 0;const o=Nn;function t(r){var n;return[r[0],o.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return dn.parseEntry=t,dn}var Ol;function Tv(){return Ol||(Ol=1,function(o){Object.defineProperty(o,"__esModule",{value:!0});const t=zh;t.__exportStar(Pv(),o),t.__exportStar(Nv(),o)}(Qo)),Qo}Object.defineProperty(Fs,"__esModule",{value:!0});Fs.KeyValueStorage=void 0;const qi=zh,xl=Nn,Cv=qi.__importDefault(xv()),Av=Tv();class Hh{constructor(){this.localStorage=Cv.default}getKeys(){return qi.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return qi.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Av.parseEntry)})}getItem(t){return qi.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return xl.safeJsonParse(r)})}setItem(t,r){return qi.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,xl.safeJsonStringify(r))})}removeItem(t){return qi.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Fs.KeyValueStorage=Hh;var Rv=Fs.default=Hh,Hi={},Vh={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(o){var t,r,n,a,l,g,O,N,F,C,U,K,J,H,X,G,oe,f,y,E,b,m,$;(function(x){var re=typeof kr=="object"?kr:typeof self=="object"?self:typeof this=="object"?this:{};x(d(re,d(o.exports)));function d(S,I){return S!==re&&(typeof Object.create=="function"?Object.defineProperty(S,"__esModule",{value:!0}):S.__esModule=!0),function(A,w){return S[A]=I?I(A,w):w}}})(function(x){var re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,S){d.__proto__=S}||function(d,S){for(var I in S)S.hasOwnProperty(I)&&(d[I]=S[I])};t=function(d,S){re(d,S);function I(){this.constructor=d}d.prototype=S===null?Object.create(S):(I.prototype=S.prototype,new I)},r=Object.assign||function(d){for(var S,I=1,A=arguments.length;I<A;I++){S=arguments[I];for(var w in S)Object.prototype.hasOwnProperty.call(S,w)&&(d[w]=S[w])}return d},n=function(d,S){var I={};for(var A in d)Object.prototype.hasOwnProperty.call(d,A)&&S.indexOf(A)<0&&(I[A]=d[A]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var w=0,A=Object.getOwnPropertySymbols(d);w<A.length;w++)S.indexOf(A[w])<0&&Object.prototype.propertyIsEnumerable.call(d,A[w])&&(I[A[w]]=d[A[w]]);return I},a=function(d,S,I,A){var w=arguments.length,_=w<3?S:A===null?A=Object.getOwnPropertyDescriptor(S,I):A,k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(d,S,I,A);else for(var ee=d.length-1;ee>=0;ee--)(k=d[ee])&&(_=(w<3?k(_):w>3?k(S,I,_):k(S,I))||_);return w>3&&_&&Object.defineProperty(S,I,_),_},l=function(d,S){return function(I,A){S(I,A,d)}},g=function(d,S){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,S)},O=function(d,S,I,A){function w(_){return _ instanceof I?_:new I(function(k){k(_)})}return new(I||(I=Promise))(function(_,k){function ee(z){try{D(A.next(z))}catch(ie){k(ie)}}function te(z){try{D(A.throw(z))}catch(ie){k(ie)}}function D(z){z.done?_(z.value):w(z.value).then(ee,te)}D((A=A.apply(d,S||[])).next())})},N=function(d,S){var I={label:0,sent:function(){if(_[0]&1)throw _[1];return _[1]},trys:[],ops:[]},A,w,_,k;return k={next:ee(0),throw:ee(1),return:ee(2)},typeof Symbol=="function"&&(k[Symbol.iterator]=function(){return this}),k;function ee(D){return function(z){return te([D,z])}}function te(D){if(A)throw new TypeError("Generator is already executing.");for(;I;)try{if(A=1,w&&(_=D[0]&2?w.return:D[0]?w.throw||((_=w.return)&&_.call(w),0):w.next)&&!(_=_.call(w,D[1])).done)return _;switch(w=0,_&&(D=[D[0]&2,_.value]),D[0]){case 0:case 1:_=D;break;case 4:return I.label++,{value:D[1],done:!1};case 5:I.label++,w=D[1],D=[0];continue;case 7:D=I.ops.pop(),I.trys.pop();continue;default:if(_=I.trys,!(_=_.length>0&&_[_.length-1])&&(D[0]===6||D[0]===2)){I=0;continue}if(D[0]===3&&(!_||D[1]>_[0]&&D[1]<_[3])){I.label=D[1];break}if(D[0]===6&&I.label<_[1]){I.label=_[1],_=D;break}if(_&&I.label<_[2]){I.label=_[2],I.ops.push(D);break}_[2]&&I.ops.pop(),I.trys.pop();continue}D=S.call(d,I)}catch(z){D=[6,z],w=0}finally{A=_=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}},$=function(d,S,I,A){A===void 0&&(A=I),d[A]=S[I]},F=function(d,S){for(var I in d)I!=="default"&&!S.hasOwnProperty(I)&&(S[I]=d[I])},C=function(d){var S=typeof Symbol=="function"&&Symbol.iterator,I=S&&d[S],A=0;if(I)return I.call(d);if(d&&typeof d.length=="number")return{next:function(){return d&&A>=d.length&&(d=void 0),{value:d&&d[A++],done:!d}}};throw new TypeError(S?"Object is not iterable.":"Symbol.iterator is not defined.")},U=function(d,S){var I=typeof Symbol=="function"&&d[Symbol.iterator];if(!I)return d;var A=I.call(d),w,_=[],k;try{for(;(S===void 0||S-- >0)&&!(w=A.next()).done;)_.push(w.value)}catch(ee){k={error:ee}}finally{try{w&&!w.done&&(I=A.return)&&I.call(A)}finally{if(k)throw k.error}}return _},K=function(){for(var d=[],S=0;S<arguments.length;S++)d=d.concat(U(arguments[S]));return d},J=function(){for(var d=0,S=0,I=arguments.length;S<I;S++)d+=arguments[S].length;for(var A=Array(d),w=0,S=0;S<I;S++)for(var _=arguments[S],k=0,ee=_.length;k<ee;k++,w++)A[w]=_[k];return A},H=function(d){return this instanceof H?(this.v=d,this):new H(d)},X=function(d,S,I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var A=I.apply(d,S||[]),w,_=[];return w={},k("next"),k("throw"),k("return"),w[Symbol.asyncIterator]=function(){return this},w;function k(ae){A[ae]&&(w[ae]=function(ge){return new Promise(function(et,nt){_.push([ae,ge,et,nt])>1||ee(ae,ge)})})}function ee(ae,ge){try{te(A[ae](ge))}catch(et){ie(_[0][3],et)}}function te(ae){ae.value instanceof H?Promise.resolve(ae.value.v).then(D,z):ie(_[0][2],ae)}function D(ae){ee("next",ae)}function z(ae){ee("throw",ae)}function ie(ae,ge){ae(ge),_.shift(),_.length&&ee(_[0][0],_[0][1])}},G=function(d){var S,I;return S={},A("next"),A("throw",function(w){throw w}),A("return"),S[Symbol.iterator]=function(){return this},S;function A(w,_){S[w]=d[w]?function(k){return(I=!I)?{value:H(d[w](k)),done:w==="return"}:_?_(k):k}:_}},oe=function(d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var S=d[Symbol.asyncIterator],I;return S?S.call(d):(d=typeof C=="function"?C(d):d[Symbol.iterator](),I={},A("next"),A("throw"),A("return"),I[Symbol.asyncIterator]=function(){return this},I);function A(_){I[_]=d[_]&&function(k){return new Promise(function(ee,te){k=d[_](k),w(ee,te,k.done,k.value)})}}function w(_,k,ee,te){Promise.resolve(te).then(function(D){_({value:D,done:ee})},k)}},f=function(d,S){return Object.defineProperty?Object.defineProperty(d,"raw",{value:S}):d.raw=S,d},y=function(d){if(d&&d.__esModule)return d;var S={};if(d!=null)for(var I in d)Object.hasOwnProperty.call(d,I)&&(S[I]=d[I]);return S.default=d,S},E=function(d){return d&&d.__esModule?d:{default:d}},b=function(d,S){if(!S.has(d))throw new TypeError("attempted to get private field on non-instance");return S.get(d)},m=function(d,S,I){if(!S.has(d))throw new TypeError("attempted to set private field on non-instance");return S.set(d,I),I},x("__extends",t),x("__assign",r),x("__rest",n),x("__decorate",a),x("__param",l),x("__metadata",g),x("__awaiter",O),x("__generator",N),x("__exportStar",F),x("__createBinding",$),x("__values",C),x("__read",U),x("__spread",K),x("__spreadArrays",J),x("__await",H),x("__asyncGenerator",X),x("__asyncDelegator",G),x("__asyncValues",oe),x("__makeTemplateObject",f),x("__importStar",y),x("__importDefault",E),x("__classPrivateFieldGet",b),x("__classPrivateFieldSet",m)})})(Vh);var Ds=Vh.exports,pn={},Yo={},gn={};class vi{}const $v=Object.freeze(Object.defineProperty({__proto__:null,IEvents:vi},Symbol.toStringTag,{value:"Module"})),Fv=X1($v);var Pl;function Dv(){if(Pl)return gn;Pl=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.IHeartBeat=void 0;const o=Fv;class t extends o.IEvents{constructor(n){super()}}return gn.IHeartBeat=t,gn}var Nl;function Bh(){return Nl||(Nl=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),Ds.__exportStar(Dv(),o)}(Yo)),Yo}var Xo={},di={},Tl;function jv(){if(Tl)return di;Tl=1,Object.defineProperty(di,"__esModule",{value:!0}),di.HEARTBEAT_EVENTS=di.HEARTBEAT_INTERVAL=void 0;const o=le;return di.HEARTBEAT_INTERVAL=o.FIVE_SECONDS,di.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},di}var Cl;function Kh(){return Cl||(Cl=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),Ds.__exportStar(jv(),o)}(Xo)),Xo}var Al;function Uv(){if(Al)return pn;Al=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.HeartBeat=void 0;const o=Ds,t=Nr,r=le,n=Bh(),a=Kh();class l extends n.IHeartBeat{constructor(O){super(O),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(O==null?void 0:O.interval)||a.HEARTBEAT_INTERVAL}static init(O){return o.__awaiter(this,void 0,void 0,function*(){const N=new l(O);return yield N.init(),N})}init(){return o.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(O,N){this.events.on(O,N)}once(O,N){this.events.once(O,N)}off(O,N){this.events.off(O,N)}removeListener(O,N){this.events.removeListener(O,N)}initialize(){return o.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return pn.HeartBeat=l,pn}(function(o){Object.defineProperty(o,"__esModule",{value:!0});const t=Ds;t.__exportStar(Uv(),o),t.__exportStar(Bh(),o),t.__exportStar(Kh(),o)})(Hi);var xe={},Wh={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(o){var t,r,n,a,l,g,O,N,F,C,U,K,J,H,X,G,oe,f,y,E,b,m,$;(function(x){var re=typeof kr=="object"?kr:typeof self=="object"?self:typeof this=="object"?this:{};x(d(re,d(o.exports)));function d(S,I){return S!==re&&(typeof Object.create=="function"?Object.defineProperty(S,"__esModule",{value:!0}):S.__esModule=!0),function(A,w){return S[A]=I?I(A,w):w}}})(function(x){var re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,S){d.__proto__=S}||function(d,S){for(var I in S)S.hasOwnProperty(I)&&(d[I]=S[I])};t=function(d,S){re(d,S);function I(){this.constructor=d}d.prototype=S===null?Object.create(S):(I.prototype=S.prototype,new I)},r=Object.assign||function(d){for(var S,I=1,A=arguments.length;I<A;I++){S=arguments[I];for(var w in S)Object.prototype.hasOwnProperty.call(S,w)&&(d[w]=S[w])}return d},n=function(d,S){var I={};for(var A in d)Object.prototype.hasOwnProperty.call(d,A)&&S.indexOf(A)<0&&(I[A]=d[A]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var w=0,A=Object.getOwnPropertySymbols(d);w<A.length;w++)S.indexOf(A[w])<0&&Object.prototype.propertyIsEnumerable.call(d,A[w])&&(I[A[w]]=d[A[w]]);return I},a=function(d,S,I,A){var w=arguments.length,_=w<3?S:A===null?A=Object.getOwnPropertyDescriptor(S,I):A,k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(d,S,I,A);else for(var ee=d.length-1;ee>=0;ee--)(k=d[ee])&&(_=(w<3?k(_):w>3?k(S,I,_):k(S,I))||_);return w>3&&_&&Object.defineProperty(S,I,_),_},l=function(d,S){return function(I,A){S(I,A,d)}},g=function(d,S){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,S)},O=function(d,S,I,A){function w(_){return _ instanceof I?_:new I(function(k){k(_)})}return new(I||(I=Promise))(function(_,k){function ee(z){try{D(A.next(z))}catch(ie){k(ie)}}function te(z){try{D(A.throw(z))}catch(ie){k(ie)}}function D(z){z.done?_(z.value):w(z.value).then(ee,te)}D((A=A.apply(d,S||[])).next())})},N=function(d,S){var I={label:0,sent:function(){if(_[0]&1)throw _[1];return _[1]},trys:[],ops:[]},A,w,_,k;return k={next:ee(0),throw:ee(1),return:ee(2)},typeof Symbol=="function"&&(k[Symbol.iterator]=function(){return this}),k;function ee(D){return function(z){return te([D,z])}}function te(D){if(A)throw new TypeError("Generator is already executing.");for(;I;)try{if(A=1,w&&(_=D[0]&2?w.return:D[0]?w.throw||((_=w.return)&&_.call(w),0):w.next)&&!(_=_.call(w,D[1])).done)return _;switch(w=0,_&&(D=[D[0]&2,_.value]),D[0]){case 0:case 1:_=D;break;case 4:return I.label++,{value:D[1],done:!1};case 5:I.label++,w=D[1],D=[0];continue;case 7:D=I.ops.pop(),I.trys.pop();continue;default:if(_=I.trys,!(_=_.length>0&&_[_.length-1])&&(D[0]===6||D[0]===2)){I=0;continue}if(D[0]===3&&(!_||D[1]>_[0]&&D[1]<_[3])){I.label=D[1];break}if(D[0]===6&&I.label<_[1]){I.label=_[1],_=D;break}if(_&&I.label<_[2]){I.label=_[2],I.ops.push(D);break}_[2]&&I.ops.pop(),I.trys.pop();continue}D=S.call(d,I)}catch(z){D=[6,z],w=0}finally{A=_=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}},$=function(d,S,I,A){A===void 0&&(A=I),d[A]=S[I]},F=function(d,S){for(var I in d)I!=="default"&&!S.hasOwnProperty(I)&&(S[I]=d[I])},C=function(d){var S=typeof Symbol=="function"&&Symbol.iterator,I=S&&d[S],A=0;if(I)return I.call(d);if(d&&typeof d.length=="number")return{next:function(){return d&&A>=d.length&&(d=void 0),{value:d&&d[A++],done:!d}}};throw new TypeError(S?"Object is not iterable.":"Symbol.iterator is not defined.")},U=function(d,S){var I=typeof Symbol=="function"&&d[Symbol.iterator];if(!I)return d;var A=I.call(d),w,_=[],k;try{for(;(S===void 0||S-- >0)&&!(w=A.next()).done;)_.push(w.value)}catch(ee){k={error:ee}}finally{try{w&&!w.done&&(I=A.return)&&I.call(A)}finally{if(k)throw k.error}}return _},K=function(){for(var d=[],S=0;S<arguments.length;S++)d=d.concat(U(arguments[S]));return d},J=function(){for(var d=0,S=0,I=arguments.length;S<I;S++)d+=arguments[S].length;for(var A=Array(d),w=0,S=0;S<I;S++)for(var _=arguments[S],k=0,ee=_.length;k<ee;k++,w++)A[w]=_[k];return A},H=function(d){return this instanceof H?(this.v=d,this):new H(d)},X=function(d,S,I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var A=I.apply(d,S||[]),w,_=[];return w={},k("next"),k("throw"),k("return"),w[Symbol.asyncIterator]=function(){return this},w;function k(ae){A[ae]&&(w[ae]=function(ge){return new Promise(function(et,nt){_.push([ae,ge,et,nt])>1||ee(ae,ge)})})}function ee(ae,ge){try{te(A[ae](ge))}catch(et){ie(_[0][3],et)}}function te(ae){ae.value instanceof H?Promise.resolve(ae.value.v).then(D,z):ie(_[0][2],ae)}function D(ae){ee("next",ae)}function z(ae){ee("throw",ae)}function ie(ae,ge){ae(ge),_.shift(),_.length&&ee(_[0][0],_[0][1])}},G=function(d){var S,I;return S={},A("next"),A("throw",function(w){throw w}),A("return"),S[Symbol.iterator]=function(){return this},S;function A(w,_){S[w]=d[w]?function(k){return(I=!I)?{value:H(d[w](k)),done:w==="return"}:_?_(k):k}:_}},oe=function(d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var S=d[Symbol.asyncIterator],I;return S?S.call(d):(d=typeof C=="function"?C(d):d[Symbol.iterator](),I={},A("next"),A("throw"),A("return"),I[Symbol.asyncIterator]=function(){return this},I);function A(_){I[_]=d[_]&&function(k){return new Promise(function(ee,te){k=d[_](k),w(ee,te,k.done,k.value)})}}function w(_,k,ee,te){Promise.resolve(te).then(function(D){_({value:D,done:ee})},k)}},f=function(d,S){return Object.defineProperty?Object.defineProperty(d,"raw",{value:S}):d.raw=S,d},y=function(d){if(d&&d.__esModule)return d;var S={};if(d!=null)for(var I in d)Object.hasOwnProperty.call(d,I)&&(S[I]=d[I]);return S.default=d,S},E=function(d){return d&&d.__esModule?d:{default:d}},b=function(d,S){if(!S.has(d))throw new TypeError("attempted to get private field on non-instance");return S.get(d)},m=function(d,S,I){if(!S.has(d))throw new TypeError("attempted to set private field on non-instance");return S.set(d,I),I},x("__extends",t),x("__assign",r),x("__rest",n),x("__decorate",a),x("__param",l),x("__metadata",g),x("__awaiter",O),x("__generator",N),x("__exportStar",F),x("__createBinding",$),x("__values",C),x("__read",U),x("__spread",K),x("__spreadArrays",J),x("__await",H),x("__asyncGenerator",X),x("__asyncDelegator",G),x("__asyncValues",oe),x("__makeTemplateObject",f),x("__importStar",y),x("__importDefault",E),x("__classPrivateFieldGet",b),x("__classPrivateFieldSet",m)})})(Wh);var Lv=Wh.exports,Zo,Rl;function qv(){if(Rl)return Zo;Rl=1;function o(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Zo=t;function t(r,n,a){var l=a&&a.stringify||o,g=1;if(typeof r=="object"&&r!==null){var O=n.length+g;if(O===1)return r;var N=new Array(O);N[0]=l(r);for(var F=1;F<O;F++)N[F]=l(n[F]);return N.join(" ")}if(typeof r!="string")return r;var C=n.length;if(C===0)return r;for(var U="",K=1-g,J=-1,H=r&&r.length||0,X=0;X<H;){if(r.charCodeAt(X)===37&&X+1<H){switch(J=J>-1?J:0,r.charCodeAt(X+1)){case 100:case 102:if(K>=C||n[K]==null)break;J<X&&(U+=r.slice(J,X)),U+=Number(n[K]),J=X+2,X++;break;case 105:if(K>=C||n[K]==null)break;J<X&&(U+=r.slice(J,X)),U+=Math.floor(Number(n[K])),J=X+2,X++;break;case 79:case 111:case 106:if(K>=C||n[K]===void 0)break;J<X&&(U+=r.slice(J,X));var G=typeof n[K];if(G==="string"){U+="'"+n[K]+"'",J=X+2,X++;break}if(G==="function"){U+=n[K].name||"<anonymous>",J=X+2,X++;break}U+=l(n[K]),J=X+2,X++;break;case 115:if(K>=C)break;J<X&&(U+=r.slice(J,X)),U+=String(n[K]),J=X+2,X++;break;case 37:J<X&&(U+=r.slice(J,X)),U+="%",J=X+2,X++,K--;break}++K}++X}return J===-1?r:(J<H&&(U+=r.slice(J)),U)}return Zo}var ea,$l;function Mv(){if($l)return ea;$l=1;const o=qv();ea=a;const t=b().console||{},r={mapHttpRequest:H,mapHttpResponse:H,wrapRequestSerializer:X,wrapResponseSerializer:X,wrapErrorSerializer:X,req:H,res:H,err:K};function n(m,$){return Array.isArray(m)?m.filter(function(re){return re!=="!stdSerializers.err"}):m===!0?Object.keys($):!1}function a(m){m=m||{},m.browser=m.browser||{};const $=m.browser.transmit;if($&&typeof $.send!="function")throw Error("pino: transmit option must have a send function");const x=m.browser.write||t;m.browser.write&&(m.browser.asObject=!0);const re=m.serializers||{},d=n(m.browser.serialize,re);let S=m.browser.serialize;Array.isArray(m.browser.serialize)&&m.browser.serialize.indexOf("!stdSerializers.err")>-1&&(S=!1);const I=["error","fatal","warn","info","debug","trace"];typeof x=="function"&&(x.error=x.fatal=x.warn=x.info=x.debug=x.trace=x),m.enabled===!1&&(m.level="silent");const A=m.level||"info",w=Object.create(x);w.log||(w.log=G),Object.defineProperty(w,"levelVal",{get:k}),Object.defineProperty(w,"level",{get:ee,set:te});const _={transmit:$,serialize:d,asObject:m.browser.asObject,levels:I,timestamp:J(m)};w.levels=a.levels,w.level=A,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=G,w.serializers=re,w._serialize=d,w._stdErrSerialize=S,w.child=D,$&&(w._logEvent=U());function k(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ee(){return this._level}function te(z){if(z!=="silent"&&!this.levels.values[z])throw Error("unknown level "+z);this._level=z,l(_,w,"error","log"),l(_,w,"fatal","error"),l(_,w,"warn","error"),l(_,w,"info","log"),l(_,w,"debug","log"),l(_,w,"trace","log")}function D(z,ie){if(!z)throw new Error("missing bindings for child Pino");ie=ie||{},d&&z.serializers&&(ie.serializers=z.serializers);const ae=ie.serializers;if(d&&ae){var ge=Object.assign({},re,ae),et=m.browser.serialize===!0?Object.keys(ge):d;delete z.serializers,N([z],et,ge,this._stdErrSerialize)}function nt(Nt){this._childLevel=(Nt._childLevel|0)+1,this.error=F(Nt,z,"error"),this.fatal=F(Nt,z,"fatal"),this.warn=F(Nt,z,"warn"),this.info=F(Nt,z,"info"),this.debug=F(Nt,z,"debug"),this.trace=F(Nt,z,"trace"),ge&&(this.serializers=ge,this._serialize=et),$&&(this._logEvent=U([].concat(Nt._logEvent.bindings,z)))}return nt.prototype=this,new nt(this)}return w}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:oe,epochTime:f,unixTime:y,isoTime:E});function l(m,$,x,re){const d=Object.getPrototypeOf($);$[x]=$.levelVal>$.levels.values[x]?G:d[x]?d[x]:t[x]||t[re]||G,g(m,$,x)}function g(m,$,x){!m.transmit&&$[x]===G||($[x]=function(re){return function(){const S=m.timestamp(),I=new Array(arguments.length),A=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var w=0;w<I.length;w++)I[w]=arguments[w];if(m.serialize&&!m.asObject&&N(I,this._serialize,this.serializers,this._stdErrSerialize),m.asObject?re.call(A,O(this,x,I,S)):re.apply(A,I),m.transmit){const _=m.transmit.level||$.level,k=a.levels.values[_],ee=a.levels.values[x];if(ee<k)return;C(this,{ts:S,methodLevel:x,methodValue:ee,transmitLevel:_,transmitValue:a.levels.values[m.transmit.level||$.level],send:m.transmit.send,val:$.levelVal},I)}}}($[x]))}function O(m,$,x,re){m._serialize&&N(x,m._serialize,m.serializers,m._stdErrSerialize);const d=x.slice();let S=d[0];const I={};re&&(I.time=re),I.level=a.levels.values[$];let A=(m._childLevel|0)+1;if(A<1&&(A=1),S!==null&&typeof S=="object"){for(;A--&&typeof d[0]=="object";)Object.assign(I,d.shift());S=d.length?o(d.shift(),d):void 0}else typeof S=="string"&&(S=o(d.shift(),d));return S!==void 0&&(I.msg=S),I}function N(m,$,x,re){for(const d in m)if(re&&m[d]instanceof Error)m[d]=a.stdSerializers.err(m[d]);else if(typeof m[d]=="object"&&!Array.isArray(m[d]))for(const S in m[d])$&&$.indexOf(S)>-1&&S in x&&(m[d][S]=x[S](m[d][S]))}function F(m,$,x){return function(){const re=new Array(1+arguments.length);re[0]=$;for(var d=1;d<re.length;d++)re[d]=arguments[d-1];return m[x].apply(this,re)}}function C(m,$,x){const re=$.send,d=$.ts,S=$.methodLevel,I=$.methodValue,A=$.val,w=m._logEvent.bindings;N(x,m._serialize||Object.keys(m.serializers),m.serializers,m._stdErrSerialize===void 0?!0:m._stdErrSerialize),m._logEvent.ts=d,m._logEvent.messages=x.filter(function(_){return w.indexOf(_)===-1}),m._logEvent.level.label=S,m._logEvent.level.value=I,re(S,m._logEvent,A),m._logEvent=U(w)}function U(m){return{ts:0,messages:[],bindings:m||[],level:{label:"",value:0}}}function K(m){const $={type:m.constructor.name,msg:m.message,stack:m.stack};for(const x in m)$[x]===void 0&&($[x]=m[x]);return $}function J(m){return typeof m.timestamp=="function"?m.timestamp:m.timestamp===!1?oe:f}function H(){return{}}function X(m){return m}function G(){}function oe(){return!1}function f(){return Date.now()}function y(){return Math.round(Date.now()/1e3)}function E(){return new Date(Date.now()).toISOString()}function b(){function m($){return typeof $<"u"&&$}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return m(self)||m(window)||m(this)||{}}}return ea}var pi={},Fl;function Gh(){return Fl||(Fl=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.PINO_CUSTOM_CONTEXT_KEY=pi.PINO_LOGGER_DEFAULTS=void 0,pi.PINO_LOGGER_DEFAULTS={level:"info"},pi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),pi}var kt={},Dl;function kv(){if(Dl)return kt;Dl=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.generateChildLogger=kt.formatChildLoggerContext=kt.getLoggerContext=kt.setBrowserLoggerContext=kt.getBrowserLoggerContext=kt.getDefaultLoggerOptions=void 0;const o=Gh();function t(O){return Object.assign(Object.assign({},O),{level:(O==null?void 0:O.level)||o.PINO_LOGGER_DEFAULTS.level})}kt.getDefaultLoggerOptions=t;function r(O,N=o.PINO_CUSTOM_CONTEXT_KEY){return O[N]||""}kt.getBrowserLoggerContext=r;function n(O,N,F=o.PINO_CUSTOM_CONTEXT_KEY){return O[F]=N,O}kt.setBrowserLoggerContext=n;function a(O,N=o.PINO_CUSTOM_CONTEXT_KEY){let F="";return typeof O.bindings>"u"?F=r(O,N):F=O.bindings().context||"",F}kt.getLoggerContext=a;function l(O,N,F=o.PINO_CUSTOM_CONTEXT_KEY){const C=a(O,F);return C.trim()?`${C}/${N}`:N}kt.formatChildLoggerContext=l;function g(O,N,F=o.PINO_CUSTOM_CONTEXT_KEY){const C=l(O,N,F),U=O.child({context:C});return n(U,C,F)}return kt.generateChildLogger=g,kt}(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.pino=void 0;const t=Lv,r=t.__importDefault(Mv());Object.defineProperty(o,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Gh(),o),t.__exportStar(kv(),o)})(xe);class zv extends vi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let Hv=class extends vi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}};class Vv{constructor(t,r){this.logger=t,this.core=r}}let Bv=class extends vi{constructor(t,r){super(),this.relayer=t,this.logger=r}},Kv=class extends vi{constructor(t){super()}},Wv=class{constructor(t,r,n,a){this.core=t,this.logger=r,this.name=n}};class Gv extends vi{constructor(t,r){super(),this.relayer=t,this.logger=r}}let Jv=class extends vi{constructor(t,r){super(),this.core=t,this.logger=r}},Qv=class{constructor(t,r){this.projectId=t,this.logger=r}},Yv=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Xv=class{constructor(t){this.client=t}};const Zv=o=>JSON.stringify(o,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),e_=o=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=o.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function t_(o){if(typeof o!="string")throw new Error(`Cannot safe json parse value of type ${typeof o}`);try{return e_(o)}catch{return o}}function r_(o){return typeof o=="string"?o:Zv(o)||""}var Fa={},Jh={};(function(o){Object.defineProperty(o,"__esModule",{value:!0});var t=Z1,r=Lh;o.DIGEST_LENGTH=64,o.BLOCK_SIZE=128;var n=function(){function O(){this.digestLength=o.DIGEST_LENGTH,this.blockSize=o.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return O.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},O.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},O.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},O.prototype.update=function(N,F){if(F===void 0&&(F=N.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var C=0;if(this._bytesHashed+=F,this._bufferLength>0){for(;this._bufferLength<o.BLOCK_SIZE&&F>0;)this._buffer[this._bufferLength++]=N[C++],F--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(F>=this.blockSize&&(C=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,N,C,F),F%=this.blockSize);F>0;)this._buffer[this._bufferLength++]=N[C++],F--;return this},O.prototype.finish=function(N){if(!this._finished){var F=this._bytesHashed,C=this._bufferLength,U=F/536870912|0,K=F<<3,J=F%128<112?128:256;this._buffer[C]=128;for(var H=C+1;H<J-8;H++)this._buffer[H]=0;t.writeUint32BE(U,this._buffer,J-8),t.writeUint32BE(K,this._buffer,J-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,J),this._finished=!0}for(var H=0;H<this.digestLength/8;H++)t.writeUint32BE(this._stateHi[H],N,H*8),t.writeUint32BE(this._stateLo[H],N,H*8+4);return this},O.prototype.digest=function(){var N=new Uint8Array(this.digestLength);return this.finish(N),N},O.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},O.prototype.restoreState=function(N){return this._stateHi.set(N.stateHi),this._stateLo.set(N.stateLo),this._bufferLength=N.bufferLength,N.buffer&&this._buffer.set(N.buffer),this._bytesHashed=N.bytesHashed,this._finished=!1,this},O.prototype.cleanSavedState=function(N){r.wipe(N.stateHi),r.wipe(N.stateLo),N.buffer&&r.wipe(N.buffer),N.bufferLength=0,N.bytesHashed=0},O}();o.SHA512=n;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(O,N,F,C,U,K,J){for(var H=F[0],X=F[1],G=F[2],oe=F[3],f=F[4],y=F[5],E=F[6],b=F[7],m=C[0],$=C[1],x=C[2],re=C[3],d=C[4],S=C[5],I=C[6],A=C[7],w,_,k,ee,te,D,z,ie;J>=128;){for(var ae=0;ae<16;ae++){var ge=8*ae+K;O[ae]=t.readUint32BE(U,ge),N[ae]=t.readUint32BE(U,ge+4)}for(var ae=0;ae<80;ae++){var et=H,nt=X,Nt=G,V=oe,B=f,q=y,u=E,R=b,he=m,me=$,Ee=x,Te=re,Ae=d,Pe=S,lt=I,st=A;if(w=b,_=A,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=(f>>>14|d<<32-14)^(f>>>18|d<<32-18)^(d>>>41-32|f<<32-(41-32)),_=(d>>>14|f<<32-14)^(d>>>18|f<<32-18)^(f>>>41-32|d<<32-(41-32)),te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,w=f&y^~f&E,_=d&S^~d&I,te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,w=a[ae*2],_=a[ae*2+1],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,w=O[ae%16],_=N[ae%16],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,k=z&65535|ie<<16,ee=te&65535|D<<16,w=k,_=ee,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=(H>>>28|m<<32-28)^(m>>>34-32|H<<32-(34-32))^(m>>>39-32|H<<32-(39-32)),_=(m>>>28|H<<32-28)^(H>>>34-32|m<<32-(34-32))^(H>>>39-32|m<<32-(39-32)),te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,w=H&X^H&G^X&G,_=m&$^m&x^$&x,te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,R=z&65535|ie<<16,st=te&65535|D<<16,w=V,_=Te,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=k,_=ee,te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,V=z&65535|ie<<16,Te=te&65535|D<<16,X=et,G=nt,oe=Nt,f=V,y=B,E=q,b=u,H=R,$=he,x=me,re=Ee,d=Te,S=Ae,I=Pe,A=lt,m=st,ae%16===15)for(var ge=0;ge<16;ge++)w=O[ge],_=N[ge],te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=O[(ge+9)%16],_=N[(ge+9)%16],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,k=O[(ge+1)%16],ee=N[(ge+1)%16],w=(k>>>1|ee<<32-1)^(k>>>8|ee<<32-8)^k>>>7,_=(ee>>>1|k<<32-1)^(ee>>>8|k<<32-8)^(ee>>>7|k<<32-7),te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,k=O[(ge+14)%16],ee=N[(ge+14)%16],w=(k>>>19|ee<<32-19)^(ee>>>61-32|k<<32-(61-32))^k>>>6,_=(ee>>>19|k<<32-19)^(k>>>61-32|ee<<32-(61-32))^(ee>>>6|k<<32-6),te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,O[ge]=z&65535|ie<<16,N[ge]=te&65535|D<<16}w=H,_=m,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=F[0],_=C[0],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,F[0]=H=z&65535|ie<<16,C[0]=m=te&65535|D<<16,w=X,_=$,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=F[1],_=C[1],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,F[1]=X=z&65535|ie<<16,C[1]=$=te&65535|D<<16,w=G,_=x,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=F[2],_=C[2],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,F[2]=G=z&65535|ie<<16,C[2]=x=te&65535|D<<16,w=oe,_=re,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=F[3],_=C[3],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,F[3]=oe=z&65535|ie<<16,C[3]=re=te&65535|D<<16,w=f,_=d,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=F[4],_=C[4],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,F[4]=f=z&65535|ie<<16,C[4]=d=te&65535|D<<16,w=y,_=S,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=F[5],_=C[5],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,F[5]=y=z&65535|ie<<16,C[5]=S=te&65535|D<<16,w=E,_=I,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=F[6],_=C[6],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,F[6]=E=z&65535|ie<<16,C[6]=I=te&65535|D<<16,w=b,_=A,te=_&65535,D=_>>>16,z=w&65535,ie=w>>>16,w=F[7],_=C[7],te+=_&65535,D+=_>>>16,z+=w&65535,ie+=w>>>16,D+=te>>>16,z+=D>>>16,ie+=z>>>16,F[7]=b=z&65535|ie<<16,C[7]=A=te&65535|D<<16,K+=128,J-=128}return K}function g(O){var N=new n;N.update(O);var F=N.digest();return N.clean(),F}o.hash=g})(Jh);(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.convertSecretKeyToX25519=o.convertPublicKeyToX25519=o.verify=o.sign=o.extractPublicKeyFromSecretKey=o.generateKeyPair=o.generateKeyPairFromSeed=o.SEED_LENGTH=o.SECRET_KEY_LENGTH=o.PUBLIC_KEY_LENGTH=o.SIGNATURE_LENGTH=void 0;const t=$s,r=Jh,n=Lh;o.SIGNATURE_LENGTH=64,o.PUBLIC_KEY_LENGTH=32,o.SECRET_KEY_LENGTH=64,o.SEED_LENGTH=32;function a(V){const B=new Float64Array(16);if(V)for(let q=0;q<V.length;q++)B[q]=V[q];return B}const l=new Uint8Array(32);l[0]=9;const g=a(),O=a([1]),N=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),F=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),C=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),U=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),K=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function J(V,B){for(let q=0;q<16;q++)V[q]=B[q]|0}function H(V){let B=1;for(let q=0;q<16;q++){let u=V[q]+B+65535;B=Math.floor(u/65536),V[q]=u-B*65536}V[0]+=B-1+37*(B-1)}function X(V,B,q){const u=~(q-1);for(let R=0;R<16;R++){const he=u&(V[R]^B[R]);V[R]^=he,B[R]^=he}}function G(V,B){const q=a(),u=a();for(let R=0;R<16;R++)u[R]=B[R];H(u),H(u),H(u);for(let R=0;R<2;R++){q[0]=u[0]-65517;for(let me=1;me<15;me++)q[me]=u[me]-65535-(q[me-1]>>16&1),q[me-1]&=65535;q[15]=u[15]-32767-(q[14]>>16&1);const he=q[15]>>16&1;q[14]&=65535,X(u,q,1-he)}for(let R=0;R<16;R++)V[2*R]=u[R]&255,V[2*R+1]=u[R]>>8}function oe(V,B){let q=0;for(let u=0;u<32;u++)q|=V[u]^B[u];return(1&q-1>>>8)-1}function f(V,B){const q=new Uint8Array(32),u=new Uint8Array(32);return G(q,V),G(u,B),oe(q,u)}function y(V){const B=new Uint8Array(32);return G(B,V),B[0]&1}function E(V,B){for(let q=0;q<16;q++)V[q]=B[2*q]+(B[2*q+1]<<8);V[15]&=32767}function b(V,B,q){for(let u=0;u<16;u++)V[u]=B[u]+q[u]}function m(V,B,q){for(let u=0;u<16;u++)V[u]=B[u]-q[u]}function $(V,B,q){let u,R,he=0,me=0,Ee=0,Te=0,Ae=0,Pe=0,lt=0,st=0,Je=0,$e=0,He=0,Ve=0,Qe=0,je=0,Be=0,Fe=0,Ke=0,ot=0,ht=0,Tt=0,$t=0,Ut=0,Bt=0,Zt=0,ar=0,mr=0,zr=0,ii=0,Si=0,Ii=0,Gi=0,ft=q[0],dt=q[1],pt=q[2],gt=q[3],at=q[4],yt=q[5],mt=q[6],vt=q[7],tt=q[8],_t=q[9],rt=q[10],wt=q[11],bt=q[12],Et=q[13],St=q[14],It=q[15];u=B[0],he+=u*ft,me+=u*dt,Ee+=u*pt,Te+=u*gt,Ae+=u*at,Pe+=u*yt,lt+=u*mt,st+=u*vt,Je+=u*tt,$e+=u*_t,He+=u*rt,Ve+=u*wt,Qe+=u*bt,je+=u*Et,Be+=u*St,Fe+=u*It,u=B[1],me+=u*ft,Ee+=u*dt,Te+=u*pt,Ae+=u*gt,Pe+=u*at,lt+=u*yt,st+=u*mt,Je+=u*vt,$e+=u*tt,He+=u*_t,Ve+=u*rt,Qe+=u*wt,je+=u*bt,Be+=u*Et,Fe+=u*St,Ke+=u*It,u=B[2],Ee+=u*ft,Te+=u*dt,Ae+=u*pt,Pe+=u*gt,lt+=u*at,st+=u*yt,Je+=u*mt,$e+=u*vt,He+=u*tt,Ve+=u*_t,Qe+=u*rt,je+=u*wt,Be+=u*bt,Fe+=u*Et,Ke+=u*St,ot+=u*It,u=B[3],Te+=u*ft,Ae+=u*dt,Pe+=u*pt,lt+=u*gt,st+=u*at,Je+=u*yt,$e+=u*mt,He+=u*vt,Ve+=u*tt,Qe+=u*_t,je+=u*rt,Be+=u*wt,Fe+=u*bt,Ke+=u*Et,ot+=u*St,ht+=u*It,u=B[4],Ae+=u*ft,Pe+=u*dt,lt+=u*pt,st+=u*gt,Je+=u*at,$e+=u*yt,He+=u*mt,Ve+=u*vt,Qe+=u*tt,je+=u*_t,Be+=u*rt,Fe+=u*wt,Ke+=u*bt,ot+=u*Et,ht+=u*St,Tt+=u*It,u=B[5],Pe+=u*ft,lt+=u*dt,st+=u*pt,Je+=u*gt,$e+=u*at,He+=u*yt,Ve+=u*mt,Qe+=u*vt,je+=u*tt,Be+=u*_t,Fe+=u*rt,Ke+=u*wt,ot+=u*bt,ht+=u*Et,Tt+=u*St,$t+=u*It,u=B[6],lt+=u*ft,st+=u*dt,Je+=u*pt,$e+=u*gt,He+=u*at,Ve+=u*yt,Qe+=u*mt,je+=u*vt,Be+=u*tt,Fe+=u*_t,Ke+=u*rt,ot+=u*wt,ht+=u*bt,Tt+=u*Et,$t+=u*St,Ut+=u*It,u=B[7],st+=u*ft,Je+=u*dt,$e+=u*pt,He+=u*gt,Ve+=u*at,Qe+=u*yt,je+=u*mt,Be+=u*vt,Fe+=u*tt,Ke+=u*_t,ot+=u*rt,ht+=u*wt,Tt+=u*bt,$t+=u*Et,Ut+=u*St,Bt+=u*It,u=B[8],Je+=u*ft,$e+=u*dt,He+=u*pt,Ve+=u*gt,Qe+=u*at,je+=u*yt,Be+=u*mt,Fe+=u*vt,Ke+=u*tt,ot+=u*_t,ht+=u*rt,Tt+=u*wt,$t+=u*bt,Ut+=u*Et,Bt+=u*St,Zt+=u*It,u=B[9],$e+=u*ft,He+=u*dt,Ve+=u*pt,Qe+=u*gt,je+=u*at,Be+=u*yt,Fe+=u*mt,Ke+=u*vt,ot+=u*tt,ht+=u*_t,Tt+=u*rt,$t+=u*wt,Ut+=u*bt,Bt+=u*Et,Zt+=u*St,ar+=u*It,u=B[10],He+=u*ft,Ve+=u*dt,Qe+=u*pt,je+=u*gt,Be+=u*at,Fe+=u*yt,Ke+=u*mt,ot+=u*vt,ht+=u*tt,Tt+=u*_t,$t+=u*rt,Ut+=u*wt,Bt+=u*bt,Zt+=u*Et,ar+=u*St,mr+=u*It,u=B[11],Ve+=u*ft,Qe+=u*dt,je+=u*pt,Be+=u*gt,Fe+=u*at,Ke+=u*yt,ot+=u*mt,ht+=u*vt,Tt+=u*tt,$t+=u*_t,Ut+=u*rt,Bt+=u*wt,Zt+=u*bt,ar+=u*Et,mr+=u*St,zr+=u*It,u=B[12],Qe+=u*ft,je+=u*dt,Be+=u*pt,Fe+=u*gt,Ke+=u*at,ot+=u*yt,ht+=u*mt,Tt+=u*vt,$t+=u*tt,Ut+=u*_t,Bt+=u*rt,Zt+=u*wt,ar+=u*bt,mr+=u*Et,zr+=u*St,ii+=u*It,u=B[13],je+=u*ft,Be+=u*dt,Fe+=u*pt,Ke+=u*gt,ot+=u*at,ht+=u*yt,Tt+=u*mt,$t+=u*vt,Ut+=u*tt,Bt+=u*_t,Zt+=u*rt,ar+=u*wt,mr+=u*bt,zr+=u*Et,ii+=u*St,Si+=u*It,u=B[14],Be+=u*ft,Fe+=u*dt,Ke+=u*pt,ot+=u*gt,ht+=u*at,Tt+=u*yt,$t+=u*mt,Ut+=u*vt,Bt+=u*tt,Zt+=u*_t,ar+=u*rt,mr+=u*wt,zr+=u*bt,ii+=u*Et,Si+=u*St,Ii+=u*It,u=B[15],Fe+=u*ft,Ke+=u*dt,ot+=u*pt,ht+=u*gt,Tt+=u*at,$t+=u*yt,Ut+=u*mt,Bt+=u*vt,Zt+=u*tt,ar+=u*_t,mr+=u*rt,zr+=u*wt,ii+=u*bt,Si+=u*Et,Ii+=u*St,Gi+=u*It,he+=38*Ke,me+=38*ot,Ee+=38*ht,Te+=38*Tt,Ae+=38*$t,Pe+=38*Ut,lt+=38*Bt,st+=38*Zt,Je+=38*ar,$e+=38*mr,He+=38*zr,Ve+=38*ii,Qe+=38*Si,je+=38*Ii,Be+=38*Gi,R=1,u=he+R+65535,R=Math.floor(u/65536),he=u-R*65536,u=me+R+65535,R=Math.floor(u/65536),me=u-R*65536,u=Ee+R+65535,R=Math.floor(u/65536),Ee=u-R*65536,u=Te+R+65535,R=Math.floor(u/65536),Te=u-R*65536,u=Ae+R+65535,R=Math.floor(u/65536),Ae=u-R*65536,u=Pe+R+65535,R=Math.floor(u/65536),Pe=u-R*65536,u=lt+R+65535,R=Math.floor(u/65536),lt=u-R*65536,u=st+R+65535,R=Math.floor(u/65536),st=u-R*65536,u=Je+R+65535,R=Math.floor(u/65536),Je=u-R*65536,u=$e+R+65535,R=Math.floor(u/65536),$e=u-R*65536,u=He+R+65535,R=Math.floor(u/65536),He=u-R*65536,u=Ve+R+65535,R=Math.floor(u/65536),Ve=u-R*65536,u=Qe+R+65535,R=Math.floor(u/65536),Qe=u-R*65536,u=je+R+65535,R=Math.floor(u/65536),je=u-R*65536,u=Be+R+65535,R=Math.floor(u/65536),Be=u-R*65536,u=Fe+R+65535,R=Math.floor(u/65536),Fe=u-R*65536,he+=R-1+37*(R-1),R=1,u=he+R+65535,R=Math.floor(u/65536),he=u-R*65536,u=me+R+65535,R=Math.floor(u/65536),me=u-R*65536,u=Ee+R+65535,R=Math.floor(u/65536),Ee=u-R*65536,u=Te+R+65535,R=Math.floor(u/65536),Te=u-R*65536,u=Ae+R+65535,R=Math.floor(u/65536),Ae=u-R*65536,u=Pe+R+65535,R=Math.floor(u/65536),Pe=u-R*65536,u=lt+R+65535,R=Math.floor(u/65536),lt=u-R*65536,u=st+R+65535,R=Math.floor(u/65536),st=u-R*65536,u=Je+R+65535,R=Math.floor(u/65536),Je=u-R*65536,u=$e+R+65535,R=Math.floor(u/65536),$e=u-R*65536,u=He+R+65535,R=Math.floor(u/65536),He=u-R*65536,u=Ve+R+65535,R=Math.floor(u/65536),Ve=u-R*65536,u=Qe+R+65535,R=Math.floor(u/65536),Qe=u-R*65536,u=je+R+65535,R=Math.floor(u/65536),je=u-R*65536,u=Be+R+65535,R=Math.floor(u/65536),Be=u-R*65536,u=Fe+R+65535,R=Math.floor(u/65536),Fe=u-R*65536,he+=R-1+37*(R-1),V[0]=he,V[1]=me,V[2]=Ee,V[3]=Te,V[4]=Ae,V[5]=Pe,V[6]=lt,V[7]=st,V[8]=Je,V[9]=$e,V[10]=He,V[11]=Ve,V[12]=Qe,V[13]=je,V[14]=Be,V[15]=Fe}function x(V,B){$(V,B,B)}function re(V,B){const q=a();let u;for(u=0;u<16;u++)q[u]=B[u];for(u=253;u>=0;u--)x(q,q),u!==2&&u!==4&&$(q,q,B);for(u=0;u<16;u++)V[u]=q[u]}function d(V,B){const q=a();let u;for(u=0;u<16;u++)q[u]=B[u];for(u=250;u>=0;u--)x(q,q),u!==1&&$(q,q,B);for(u=0;u<16;u++)V[u]=q[u]}function S(V,B){const q=a(),u=a(),R=a(),he=a(),me=a(),Ee=a(),Te=a(),Ae=a(),Pe=a();m(q,V[1],V[0]),m(Pe,B[1],B[0]),$(q,q,Pe),b(u,V[0],V[1]),b(Pe,B[0],B[1]),$(u,u,Pe),$(R,V[3],B[3]),$(R,R,F),$(he,V[2],B[2]),b(he,he,he),m(me,u,q),m(Ee,he,R),b(Te,he,R),b(Ae,u,q),$(V[0],me,Ee),$(V[1],Ae,Te),$(V[2],Te,Ee),$(V[3],me,Ae)}function I(V,B,q){for(let u=0;u<4;u++)X(V[u],B[u],q)}function A(V,B){const q=a(),u=a(),R=a();re(R,B[2]),$(q,B[0],R),$(u,B[1],R),G(V,u),V[31]^=y(q)<<7}function w(V,B,q){J(V[0],g),J(V[1],O),J(V[2],O),J(V[3],g);for(let u=255;u>=0;--u){const R=q[u/8|0]>>(u&7)&1;I(V,B,R),S(B,V),S(V,V),I(V,B,R)}}function _(V,B){const q=[a(),a(),a(),a()];J(q[0],C),J(q[1],U),J(q[2],O),$(q[3],C,U),w(V,q,B)}function k(V){if(V.length!==o.SEED_LENGTH)throw new Error(`ed25519: seed must be ${o.SEED_LENGTH} bytes`);const B=(0,r.hash)(V);B[0]&=248,B[31]&=127,B[31]|=64;const q=new Uint8Array(32),u=[a(),a(),a(),a()];_(u,B),A(q,u);const R=new Uint8Array(64);return R.set(V),R.set(q,32),{publicKey:q,secretKey:R}}o.generateKeyPairFromSeed=k;function ee(V){const B=(0,t.randomBytes)(32,V),q=k(B);return(0,n.wipe)(B),q}o.generateKeyPair=ee;function te(V){if(V.length!==o.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${o.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(V.subarray(32))}o.extractPublicKeyFromSecretKey=te;const D=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function z(V,B){let q,u,R,he;for(u=63;u>=32;--u){for(q=0,R=u-32,he=u-12;R<he;++R)B[R]+=q-16*B[u]*D[R-(u-32)],q=Math.floor((B[R]+128)/256),B[R]-=q*256;B[R]+=q,B[u]=0}for(q=0,R=0;R<32;R++)B[R]+=q-(B[31]>>4)*D[R],q=B[R]>>8,B[R]&=255;for(R=0;R<32;R++)B[R]-=q*D[R];for(u=0;u<32;u++)B[u+1]+=B[u]>>8,V[u]=B[u]&255}function ie(V){const B=new Float64Array(64);for(let q=0;q<64;q++)B[q]=V[q];for(let q=0;q<64;q++)V[q]=0;z(V,B)}function ae(V,B){const q=new Float64Array(64),u=[a(),a(),a(),a()],R=(0,r.hash)(V.subarray(0,32));R[0]&=248,R[31]&=127,R[31]|=64;const he=new Uint8Array(64);he.set(R.subarray(32),32);const me=new r.SHA512;me.update(he.subarray(32)),me.update(B);const Ee=me.digest();me.clean(),ie(Ee),_(u,Ee),A(he,u),me.reset(),me.update(he.subarray(0,32)),me.update(V.subarray(32)),me.update(B);const Te=me.digest();ie(Te);for(let Ae=0;Ae<32;Ae++)q[Ae]=Ee[Ae];for(let Ae=0;Ae<32;Ae++)for(let Pe=0;Pe<32;Pe++)q[Ae+Pe]+=Te[Ae]*R[Pe];return z(he.subarray(32),q),he}o.sign=ae;function ge(V,B){const q=a(),u=a(),R=a(),he=a(),me=a(),Ee=a(),Te=a();return J(V[2],O),E(V[1],B),x(R,V[1]),$(he,R,N),m(R,R,V[2]),b(he,V[2],he),x(me,he),x(Ee,me),$(Te,Ee,me),$(q,Te,R),$(q,q,he),d(q,q),$(q,q,R),$(q,q,he),$(q,q,he),$(V[0],q,he),x(u,V[0]),$(u,u,he),f(u,R)&&$(V[0],V[0],K),x(u,V[0]),$(u,u,he),f(u,R)?-1:(y(V[0])===B[31]>>7&&m(V[0],g,V[0]),$(V[3],V[0],V[1]),0)}function et(V,B,q){const u=new Uint8Array(32),R=[a(),a(),a(),a()],he=[a(),a(),a(),a()];if(q.length!==o.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${o.SIGNATURE_LENGTH} bytes`);if(ge(he,V))return!1;const me=new r.SHA512;me.update(q.subarray(0,32)),me.update(V),me.update(B);const Ee=me.digest();return ie(Ee),w(R,he,Ee),_(he,q.subarray(32)),S(R,he),A(u,R),!oe(q,u)}o.verify=et;function nt(V){let B=[a(),a(),a(),a()];if(ge(B,V))throw new Error("Ed25519: invalid public key");let q=a(),u=a(),R=B[1];b(q,O,R),m(u,O,R),re(u,u),$(q,q,u);let he=new Uint8Array(32);return G(he,q),he}o.convertPublicKeyToX25519=nt;function Nt(V){const B=(0,r.hash)(V.subarray(0,32));B[0]&=248,B[31]&=127,B[31]|=64;const q=new Uint8Array(B.subarray(0,32));return(0,n.wipe)(B),q}o.convertSecretKeyToX25519=Nt})(Fa);const i_="EdDSA",n_="JWT",Qh=".",Yh="base64url",s_="utf8",o_="utf8",a_=":",c_="did",u_="key",jl="base58btc",l_="z",h_="K36",f_=32,d_=o=>JSON.stringify(o,(t,r)=>typeof r=="bigint"?r.toString()+"n":r);function p_(o){return typeof o=="string"?o:d_(o)||""}function Ts(o){return Vt(Xt(p_(o),s_),Yh)}function Xh(o){const t=Xt(h_,jl),r=l_+Vt(fa([t,o]),jl);return[c_,u_,r].join(a_)}function g_(o){return Vt(o,Yh)}function y_(o){return Xt([Ts(o.header),Ts(o.payload)].join(Qh),o_)}function m_(o){return[Ts(o.header),Ts(o.payload),g_(o.signature)].join(Qh)}function Ul(o=$s.randomBytes(f_)){return Fa.generateKeyPairFromSeed(o)}async function v_(o,t,r,n,a=le.fromMiliseconds(Date.now())){const l={alg:i_,typ:n_},g=Xh(n.publicKey),O=a+r,N={iss:g,sub:o,aud:t,iat:a,exp:O},F=y_({header:l,payload:N}),C=Fa.sign(n.secretKey,F);return m_({header:l,payload:N,signature:C})}var Ll=globalThis&&globalThis.__spreadArray||function(o,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return o.concat(l||Array.prototype.slice.call(t))},__=function(){function o(t,r,n){this.name=t,this.version=r,this.os=n,this.type="browser"}return o}(),w_=function(){function o(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return o}(),b_=function(){function o(t,r,n,a){this.name=t,this.version=r,this.os=n,this.bot=a,this.type="bot-device"}return o}(),E_=function(){function o(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return o}(),S_=function(){function o(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return o}(),I_=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,O_=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ql=3,x_=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",I_]],Ml=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function P_(o){return o?kl(o):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new S_:typeof navigator<"u"?kl(navigator.userAgent):C_()}function N_(o){return o!==""&&x_.reduce(function(t,r){var n=r[0],a=r[1];if(t)return t;var l=a.exec(o);return!!l&&[n,l]},!1)}function kl(o){var t=N_(o);if(!t)return null;var r=t[0],n=t[1];if(r==="searchbot")return new E_;var a=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);a?a.length<ql&&(a=Ll(Ll([],a,!0),A_(ql-a.length),!0)):a=[];var l=a.join("."),g=T_(o),O=O_.exec(o);return O&&O[1]?new b_(r,l,g,O[1]):new __(r,l,g)}function T_(o){for(var t=0,r=Ml.length;t<r;t++){var n=Ml[t],a=n[0],l=n[1],g=l.exec(o);if(g)return a}return null}function C_(){var o=typeof process<"u"&&process.version;return o?new w_(process.version.slice(1)):null}function A_(o){for(var t=[],r=0;r<o;r++)t.push("0");return t}var qe={};Object.defineProperty(qe,"__esModule",{value:!0});qe.getLocalStorage=qe.getLocalStorageOrThrow=qe.getCrypto=qe.getCryptoOrThrow=ef=qe.getLocation=qe.getLocationOrThrow=Da=qe.getNavigator=qe.getNavigatorOrThrow=Zh=qe.getDocument=qe.getDocumentOrThrow=qe.getFromWindowOrThrow=qe.getFromWindow=void 0;function _i(o){let t;return typeof window<"u"&&typeof window[o]<"u"&&(t=window[o]),t}qe.getFromWindow=_i;function Vi(o){const t=_i(o);if(!t)throw new Error(`${o} is not defined in Window`);return t}qe.getFromWindowOrThrow=Vi;function R_(){return Vi("document")}qe.getDocumentOrThrow=R_;function $_(){return _i("document")}var Zh=qe.getDocument=$_;function F_(){return Vi("navigator")}qe.getNavigatorOrThrow=F_;function D_(){return _i("navigator")}var Da=qe.getNavigator=D_;function j_(){return Vi("location")}qe.getLocationOrThrow=j_;function U_(){return _i("location")}var ef=qe.getLocation=U_;function L_(){return Vi("crypto")}qe.getCryptoOrThrow=L_;function q_(){return _i("crypto")}qe.getCrypto=q_;function M_(){return Vi("localStorage")}qe.getLocalStorageOrThrow=M_;function k_(){return _i("localStorage")}qe.getLocalStorage=k_;var ja={};Object.defineProperty(ja,"__esModule",{value:!0});var tf=ja.getWindowMetadata=void 0;const zl=qe;function z_(){let o,t;try{o=zl.getDocumentOrThrow(),t=zl.getLocationOrThrow()}catch{return null}function r(){const U=o.getElementsByTagName("link"),K=[];for(let J=0;J<U.length;J++){const H=U[J],X=H.getAttribute("rel");if(X&&X.toLowerCase().indexOf("icon")>-1){const G=H.getAttribute("href");if(G)if(G.toLowerCase().indexOf("https:")===-1&&G.toLowerCase().indexOf("http:")===-1&&G.indexOf("//")!==0){let oe=t.protocol+"//"+t.host;if(G.indexOf("/")===0)oe+=G;else{const f=t.pathname.split("/");f.pop();const y=f.join("/");oe+=y+"/"+G}K.push(oe)}else if(G.indexOf("//")===0){const oe=t.protocol+G;K.push(oe)}else K.push(G)}}return K}function n(...U){const K=o.getElementsByTagName("meta");for(let J=0;J<K.length;J++){const H=K[J],X=["itemprop","property","name"].map(G=>H.getAttribute(G)).filter(G=>G?U.includes(G):!1);if(X.length&&X){const G=H.getAttribute("content");if(G)return G}}return""}function a(){let U=n("name","og:site_name","og:title","twitter:title");return U||(U=o.title),U}function l(){return n("description","og:description","twitter:description","keywords")}const g=a(),O=l(),N=t.origin,F=r();return{description:O,url:N,icons:F,name:g}}tf=ja.getWindowMetadata=z_;var xn={};(function(o){const t=Oa,r=xa,n=Sa,a=Ia,l=f=>f==null,g=Symbol("encodeFragmentIdentifier");function O(f){switch(f.arrayFormat){case"index":return y=>(E,b)=>{const m=E.length;return b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,[C(y,f),"[",m,"]"].join("")]:[...E,[C(y,f),"[",C(m,f),"]=",C(b,f)].join("")]};case"bracket":return y=>(E,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,[C(y,f),"[]"].join("")]:[...E,[C(y,f),"[]=",C(b,f)].join("")];case"colon-list-separator":return y=>(E,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,[C(y,f),":list="].join("")]:[...E,[C(y,f),":list=",C(b,f)].join("")];case"comma":case"separator":case"bracket-separator":{const y=f.arrayFormat==="bracket-separator"?"[]=":"=";return E=>(b,m)=>m===void 0||f.skipNull&&m===null||f.skipEmptyString&&m===""?b:(m=m===null?"":m,b.length===0?[[C(E,f),y,C(m,f)].join("")]:[[b,C(m,f)].join(f.arrayFormatSeparator)])}default:return y=>(E,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,C(y,f)]:[...E,[C(y,f),"=",C(b,f)].join("")]}}function N(f){let y;switch(f.arrayFormat){case"index":return(E,b,m)=>{if(y=/\[(\d*)\]$/.exec(E),E=E.replace(/\[\d*\]$/,""),!y){m[E]=b;return}m[E]===void 0&&(m[E]={}),m[E][y[1]]=b};case"bracket":return(E,b,m)=>{if(y=/(\[\])$/.exec(E),E=E.replace(/\[\]$/,""),!y){m[E]=b;return}if(m[E]===void 0){m[E]=[b];return}m[E]=[].concat(m[E],b)};case"colon-list-separator":return(E,b,m)=>{if(y=/(:list)$/.exec(E),E=E.replace(/:list$/,""),!y){m[E]=b;return}if(m[E]===void 0){m[E]=[b];return}m[E]=[].concat(m[E],b)};case"comma":case"separator":return(E,b,m)=>{const $=typeof b=="string"&&b.includes(f.arrayFormatSeparator),x=typeof b=="string"&&!$&&U(b,f).includes(f.arrayFormatSeparator);b=x?U(b,f):b;const re=$||x?b.split(f.arrayFormatSeparator).map(d=>U(d,f)):b===null?b:U(b,f);m[E]=re};case"bracket-separator":return(E,b,m)=>{const $=/(\[\])$/.test(E);if(E=E.replace(/\[\]$/,""),!$){m[E]=b&&U(b,f);return}const x=b===null?[]:b.split(f.arrayFormatSeparator).map(re=>U(re,f));if(m[E]===void 0){m[E]=x;return}m[E]=[].concat(m[E],x)};default:return(E,b,m)=>{if(m[E]===void 0){m[E]=b;return}m[E]=[].concat(m[E],b)}}}function F(f){if(typeof f!="string"||f.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function C(f,y){return y.encode?y.strict?t(f):encodeURIComponent(f):f}function U(f,y){return y.decode?r(f):f}function K(f){return Array.isArray(f)?f.sort():typeof f=="object"?K(Object.keys(f)).sort((y,E)=>Number(y)-Number(E)).map(y=>f[y]):f}function J(f){const y=f.indexOf("#");return y!==-1&&(f=f.slice(0,y)),f}function H(f){let y="";const E=f.indexOf("#");return E!==-1&&(y=f.slice(E)),y}function X(f){f=J(f);const y=f.indexOf("?");return y===-1?"":f.slice(y+1)}function G(f,y){return y.parseNumbers&&!Number.isNaN(Number(f))&&typeof f=="string"&&f.trim()!==""?f=Number(f):y.parseBooleans&&f!==null&&(f.toLowerCase()==="true"||f.toLowerCase()==="false")&&(f=f.toLowerCase()==="true"),f}function oe(f,y){y=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},y),F(y.arrayFormatSeparator);const E=N(y),b=Object.create(null);if(typeof f!="string"||(f=f.trim().replace(/^[?#&]/,""),!f))return b;for(const m of f.split("&")){if(m==="")continue;let[$,x]=n(y.decode?m.replace(/\+/g," "):m,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(y.arrayFormat)?x:U(x,y),E(U($,y),x,b)}for(const m of Object.keys(b)){const $=b[m];if(typeof $=="object"&&$!==null)for(const x of Object.keys($))$[x]=G($[x],y);else b[m]=G($,y)}return y.sort===!1?b:(y.sort===!0?Object.keys(b).sort():Object.keys(b).sort(y.sort)).reduce((m,$)=>{const x=b[$];return x&&typeof x=="object"&&!Array.isArray(x)?m[$]=K(x):m[$]=x,m},Object.create(null))}o.extract=X,o.parse=oe,o.stringify=(f,y)=>{if(!f)return"";y=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},y),F(y.arrayFormatSeparator);const E=x=>y.skipNull&&l(f[x])||y.skipEmptyString&&f[x]==="",b=O(y),m={};for(const x of Object.keys(f))E(x)||(m[x]=f[x]);const $=Object.keys(m);return y.sort!==!1&&$.sort(y.sort),$.map(x=>{const re=f[x];return re===void 0?"":re===null?C(x,y):Array.isArray(re)?re.length===0&&y.arrayFormat==="bracket-separator"?C(x,y)+"[]":re.reduce(b(x),[]).join("&"):C(x,y)+"="+C(re,y)}).filter(x=>x.length>0).join("&")},o.parseUrl=(f,y)=>{y=Object.assign({decode:!0},y);const[E,b]=n(f,"#");return Object.assign({url:E.split("?")[0]||"",query:oe(X(f),y)},y&&y.parseFragmentIdentifier&&b?{fragmentIdentifier:U(b,y)}:{})},o.stringifyUrl=(f,y)=>{y=Object.assign({encode:!0,strict:!0,[g]:!0},y);const E=J(f.url).split("?")[0]||"",b=o.extract(f.url),m=o.parse(b,{sort:!1}),$=Object.assign(m,f.query);let x=o.stringify($,y);x&&(x=`?${x}`);let re=H(f.url);return f.fragmentIdentifier&&(re=`#${y[g]?C(f.fragmentIdentifier,y):f.fragmentIdentifier}`),`${E}${x}${re}`},o.pick=(f,y,E)=>{E=Object.assign({parseFragmentIdentifier:!0,[g]:!1},E);const{url:b,query:m,fragmentIdentifier:$}=o.parseUrl(f,E);return o.stringifyUrl({url:b,query:a(m,y),fragmentIdentifier:$},E)},o.exclude=(f,y,E)=>{const b=Array.isArray(y)?m=>!y.includes(m):(m,$)=>!y(m,$);return o.pick(f,b,E)}})(xn);function rf(o,t){return o.includes(":")?[o]:t.chains||[]}const nf="base10",Ht="base16",pa="base64pad",Ua="utf8",sf=0,wi=1,H_=0,Hl=1,ga=12,La=32;function V_(){const o=qh.generateKeyPair();return{privateKey:Vt(o.secretKey,Ht),publicKey:Vt(o.publicKey,Ht)}}function ya(){const o=$s.randomBytes(La);return Vt(o,Ht)}function B_(o,t){const r=qh.sharedKey(Xt(o,Ht),Xt(t,Ht),!0),n=new ev(Pa.SHA256,r).expand(La);return Vt(n,Ht)}function K_(o){const t=Pa.hash(Xt(o,Ht));return Vt(t,Ht)}function ki(o){const t=Pa.hash(Xt(o,Ua));return Vt(t,Ht)}function W_(o){return Xt(`${o}`,nf)}function Tn(o){return Number(Vt(o,nf))}function G_(o){const t=W_(typeof o.type<"u"?o.type:sf);if(Tn(t)===wi&&typeof o.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof o.senderPublicKey<"u"?Xt(o.senderPublicKey,Ht):void 0,n=typeof o.iv<"u"?Xt(o.iv,Ht):$s.randomBytes(ga),a=new Mh.ChaCha20Poly1305(Xt(o.symKey,Ht)).seal(n,Xt(o.message,Ua));return Q_({type:t,sealed:a,iv:n,senderPublicKey:r})}function J_(o){const t=new Mh.ChaCha20Poly1305(Xt(o.symKey,Ht)),{sealed:r,iv:n}=Cs(o.encoded),a=t.open(n,r);if(a===null)throw new Error("Failed to decrypt");return Vt(a,Ua)}function Q_(o){if(Tn(o.type)===wi){if(typeof o.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Vt(fa([o.type,o.senderPublicKey,o.iv,o.sealed]),pa)}return Vt(fa([o.type,o.iv,o.sealed]),pa)}function Cs(o){const t=Xt(o,pa),r=t.slice(H_,Hl),n=Hl;if(Tn(r)===wi){const O=n+La,N=O+ga,F=t.slice(n,O),C=t.slice(O,N),U=t.slice(N);return{type:r,sealed:U,iv:C,senderPublicKey:F}}const a=n+ga,l=t.slice(n,a),g=t.slice(a);return{type:r,sealed:g,iv:l}}function Y_(o,t){const r=Cs(o);return of({type:Tn(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Vt(r.senderPublicKey,Ht):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function of(o){const t=(o==null?void 0:o.type)||sf;if(t===wi){if(typeof(o==null?void 0:o.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(o==null?void 0:o.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:o==null?void 0:o.senderPublicKey,receiverPublicKey:o==null?void 0:o.receiverPublicKey}}function Vl(o){return o.type===wi&&typeof o.senderPublicKey=="string"&&typeof o.receiverPublicKey=="string"}var X_=Object.defineProperty,Bl=Object.getOwnPropertySymbols,Z_=Object.prototype.hasOwnProperty,ew=Object.prototype.propertyIsEnumerable,Kl=(o,t,r)=>t in o?X_(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Wl=(o,t)=>{for(var r in t||(t={}))Z_.call(t,r)&&Kl(o,r,t[r]);if(Bl)for(var r of Bl(t))ew.call(t,r)&&Kl(o,r,t[r]);return o};const tw="ReactNative",or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},rw="js";function qa(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function js(){return!Zh()&&!!Da()&&navigator.product===tw}function Cn(){return!qa()&&!!Da()}function An(){return js()?or.reactNative:qa()?or.node:Cn()?or.browser:or.unknown}function iw(o,t){let r=xn.parse(o);return r=Wl(Wl({},r),t),o=xn.stringify(r),o}function nw(){return tf()||{name:"",description:"",url:"",icons:[""]}}function sw(){if(An()===or.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const o=P_();if(o===null)return"unknown";const t=o.os?o.os.replace(" ","").toLowerCase():"unknown";return o.type==="browser"?[t,o.name,o.version].join("-"):[t,o.version].join("-")}function ow(){var o;const t=An();return t===or.browser?[t,((o=ef())==null?void 0:o.host)||"unknown"].join(":"):t}function aw(o,t,r){const n=sw(),a=ow();return[[o,t].join("-"),[rw,r].join("-"),n,a].join("/")}function cw({protocol:o,version:t,relayUrl:r,sdkVersion:n,auth:a,projectId:l,useOnCloseEvent:g}){const O=r.split("?"),N=aw(o,t,n),F={auth:a,ua:N,projectId:l,useOnCloseEvent:g||void 0},C=iw(O[1]||"",F);return O[0]+"?"+C}function gi(o,t){return o.filter(r=>t.includes(r)).length===o.length}function af(o){return Object.fromEntries(o.entries())}function cf(o){return new Map(Object.entries(o))}function Mi(o=le.FIVE_MINUTES,t){const r=le.toMiliseconds(o||le.FIVE_MINUTES);let n,a,l;return{resolve:g=>{l&&n&&(clearTimeout(l),n(g))},reject:g=>{l&&a&&(clearTimeout(l),a(g))},done:()=>new Promise((g,O)=>{l=setTimeout(()=>{O(new Error(t))},r),n=g,a=O})}}function Pn(o,t,r){return new Promise(async(n,a)=>{const l=setTimeout(()=>a(new Error(r)),t);try{const g=await o;n(g)}catch(g){a(g)}clearTimeout(l)})}function uf(o,t){if(typeof t=="string"&&t.startsWith(`${o}:`))return t;if(o.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(o.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${o}`)}function uw(o){return uf("topic",o)}function lw(o){return uf("id",o)}function lf(o){const[t,r]=o.split(":"),n={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")n.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return n}function Er(o,t){return le.fromMiliseconds((t||Date.now())+le.toMiliseconds(o))}function Zr(o){return Date.now()>=le.toMiliseconds(o)}function it(o,t){return`${o}${t?`:${t}`:""}`}async function hw({id:o,topic:t,wcDeepLink:r}){try{if(!r)return;const n=typeof r=="string"?JSON.parse(r):r;let a=n==null?void 0:n.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const l=`${a}/wc?requestId=${o}&sessionTopic=${t}`,g=An();g===or.browser?l.startsWith("https://")?window.open(l,"_blank","noreferrer noopener"):window.open(l,"_self","noreferrer noopener"):g===or.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(l)}catch(n){console.error(n)}}const fw="irn";function ma(o){return(o==null?void 0:o.relay)||{protocol:fw}}function xs(o){const t=cv[o];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${o}`);return t}var dw=Object.defineProperty,Gl=Object.getOwnPropertySymbols,pw=Object.prototype.hasOwnProperty,gw=Object.prototype.propertyIsEnumerable,Jl=(o,t,r)=>t in o?dw(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,yw=(o,t)=>{for(var r in t||(t={}))pw.call(t,r)&&Jl(o,r,t[r]);if(Gl)for(var r of Gl(t))gw.call(t,r)&&Jl(o,r,t[r]);return o};function mw(o,t="-"){const r={},n="relay"+t;return Object.keys(o).forEach(a=>{if(a.startsWith(n)){const l=a.replace(n,""),g=o[a];r[l]=g}}),r}function vw(o){const t=o.indexOf(":"),r=o.indexOf("?")!==-1?o.indexOf("?"):void 0,n=o.substring(0,t),a=o.substring(t+1,r).split("@"),l=typeof r<"u"?o.substring(r):"",g=xn.parse(l);return{protocol:n,topic:_w(a[0]),version:parseInt(a[1],10),symKey:g.symKey,relay:mw(g)}}function _w(o){return o.startsWith("//")?o.substring(2):o}function ww(o,t="-"){const r="relay",n={};return Object.keys(o).forEach(a=>{const l=r+t+a;o[a]&&(n[l]=o[a])}),n}function bw(o){return`${o.protocol}:${o.topic}@${o.version}?`+xn.stringify(yw({symKey:o.symKey},ww(o.relay)))}function Bi(o){const t=[];return o.forEach(r=>{const[n,a]=r.split(":");t.push(`${n}:${a}`)}),t}function Ew(o){const t=[];return Object.values(o).forEach(r=>{t.push(...Bi(r.accounts))}),t}function Sw(o,t){const r=[];return Object.values(o).forEach(n=>{Bi(n.accounts).includes(t)&&r.push(...n.methods)}),r}function Iw(o,t){const r=[];return Object.values(o).forEach(n=>{Bi(n.accounts).includes(t)&&r.push(...n.events)}),r}function Ow(o,t){const r=Ps(o,t);if(r)throw new Error(r.message);const n={};for(const[a,l]of Object.entries(o))n[a]={methods:l.methods,events:l.events,chains:l.accounts.map(g=>`${g.split(":")[0]}:${g.split(":")[1]}`)};return n}const xw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Pw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function se(o,t){const{message:r,code:n}=Pw[o];return{message:t?`${r} ${t}`:r,code:n}}function xt(o,t){const{message:r,code:n}=xw[o];return{message:t?`${r} ${t}`:r,code:n}}function Rn(o,t){return Array.isArray(o)?typeof t<"u"&&o.length?o.every(t):!0:!1}function On(o){return Object.getPrototypeOf(o)===Object.prototype&&Object.keys(o).length}function zt(o){return typeof o>"u"}function Pt(o,t){return t&&zt(o)?!0:typeof o=="string"&&!!o.trim().length}function Ma(o,t){return t&&zt(o)?!0:typeof o=="number"&&!isNaN(o)}function Nw(o,t){const{requiredNamespaces:r}=t,n=Object.keys(o.namespaces),a=Object.keys(r);let l=!0;return gi(a,n)?(n.forEach(g=>{const{accounts:O,methods:N,events:F}=o.namespaces[g],C=Bi(O),U=r[g];(!gi(rf(g,U),C)||!gi(U.methods,N)||!gi(U.events,F))&&(l=!1)}),l):!1}function As(o){return Pt(o,!1)&&o.includes(":")?o.split(":").length===2:!1}function Tw(o){if(Pt(o,!1)&&o.includes(":")){const t=o.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&As(r)}}return!1}function Cw(o){if(Pt(o,!1))try{return typeof new URL(o)<"u"}catch{return!1}return!1}function Aw(o){var t;return(t=o==null?void 0:o.proposer)==null?void 0:t.publicKey}function Rw(o){return o==null?void 0:o.topic}function $w(o,t){let r=null;return Pt(o==null?void 0:o.publicKey,!1)||(r=se("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Ql(o){let t=!0;return Rn(o)?o.length&&(t=o.every(r=>Pt(r,!1))):t=!1,t}function Fw(o,t,r){let n=null;return Rn(t)&&t.length?t.forEach(a=>{n||As(a)||(n=xt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):As(o)||(n=xt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function Dw(o,t,r){let n=null;return Object.entries(o).forEach(([a,l])=>{if(n)return;const g=Fw(a,rf(a,l),`${t} ${r}`);g&&(n=g)}),n}function jw(o,t){let r=null;return Rn(o)?o.forEach(n=>{r||Tw(n)||(r=xt("UNSUPPORTED_ACCOUNTS",`${t}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=xt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Uw(o,t){let r=null;return Object.values(o).forEach(n=>{if(r)return;const a=jw(n==null?void 0:n.accounts,`${t} namespace`);a&&(r=a)}),r}function Lw(o,t){let r=null;return Ql(o==null?void 0:o.methods)?Ql(o==null?void 0:o.events)||(r=xt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=xt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function hf(o,t){let r=null;return Object.values(o).forEach(n=>{if(r)return;const a=Lw(n,`${t}, namespace`);a&&(r=a)}),r}function qw(o,t,r){let n=null;if(o&&On(o)){const a=hf(o,t);a&&(n=a);const l=Dw(o,t,r);l&&(n=l)}else n=se("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}function Ps(o,t){let r=null;if(o&&On(o)){const n=hf(o,t);n&&(r=n);const a=Uw(o,t);a&&(r=a)}else r=se("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function ff(o){return Pt(o.protocol,!0)}function Mw(o,t){let r=!1;return t&&!o?r=!0:o&&Rn(o)&&o.length&&o.forEach(n=>{r=ff(n)}),r}function kw(o){return typeof o=="number"}function Yt(o){return typeof o<"u"&&typeof o!==null}function zw(o){return!(!o||typeof o!="object"||!o.code||!Ma(o.code,!1)||!o.message||!Pt(o.message,!1))}function Hw(o){return!(zt(o)||!Pt(o.method,!1))}function Vw(o){return!(zt(o)||zt(o.result)&&zt(o.error)||!Ma(o.id,!1)||!Pt(o.jsonrpc,!1))}function Bw(o){return!(zt(o)||!Pt(o.name,!1))}function Yl(o,t){return!(!As(t)||!Ew(o).includes(t))}function Kw(o,t,r){return Pt(r,!1)?Sw(o,t).includes(r):!1}function Ww(o,t,r){return Pt(r,!1)?Iw(o,t).includes(r):!1}function Xl(o,t,r){let n=null;const a=Gw(o),l=Jw(t),g=Object.keys(a),O=Object.keys(l),N=Zl(Object.keys(o)),F=Zl(Object.keys(t)),C=N.filter(U=>!F.includes(U));return C.length&&(n=se("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${C.toString()}
      Received: ${Object.keys(t).toString()}`)),gi(g,O)||(n=se("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${g.toString()}
      Approved: ${O.toString()}`)),Object.keys(t).forEach(U=>{if(!U.includes(":")||n)return;const K=Bi(t[U].accounts);K.includes(U)||(n=se("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${U}
        Required: ${U}
        Approved: ${K.toString()}`))}),g.forEach(U=>{n||(gi(a[U].methods,l[U].methods)?gi(a[U].events,l[U].events)||(n=se("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${U}`)):n=se("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${U}`))}),n}function Gw(o){const t={};return Object.keys(o).forEach(r=>{var n;r.includes(":")?t[r]=o[r]:(n=o[r].chains)==null||n.forEach(a=>{t[a]={methods:o[r].methods,events:o[r].events}})}),t}function Zl(o){return[...new Set(o.map(t=>t.includes(":")?t.split(":")[0]:t))]}function Jw(o){const t={};return Object.keys(o).forEach(r=>{if(r.includes(":"))t[r]=o[r];else{const n=Bi(o[r].accounts);n==null||n.forEach(a=>{t[a]={accounts:o[r].accounts.filter(l=>l.includes(`${a}:`)),methods:o[r].methods,events:o[r].events}})}}),t}function Qw(o,t){return Ma(o,!1)&&o<=t.max&&o>=t.min}function eh(){const o=An();return new Promise(t=>{switch(o){case or.browser:t(Yw());break;case or.reactNative:t(Xw());break;case or.node:t(Zw());break;default:t(!0)}})}function Yw(){return Cn()&&(navigator==null?void 0:navigator.onLine)}async function Xw(){if(js()&&typeof global<"u"&&global!=null&&global.NetInfo){const o=await(global==null?void 0:global.NetInfo.fetch());return o==null?void 0:o.isConnected}return!0}function Zw(){return!0}function eb(o){switch(An()){case or.browser:tb(o);break;case or.reactNative:rb(o);break}}function tb(o){Cn()&&(window.addEventListener("online",()=>o(!0)),window.addEventListener("offline",()=>o(!1)))}function rb(o){js()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>o(t==null?void 0:t.isConnected)))}const ta={};let Es=class{static get(t){return ta[t]}static set(t,r){ta[t]=r}static delete(t){delete ta[t]}};const ib=o=>JSON.stringify(o,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),nb=o=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=o.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function sb(o){if(typeof o!="string")throw new Error(`Cannot safe json parse value of type ${typeof o}`);try{return nb(o)}catch{return o}}function ob(o){return typeof o=="string"?o:ib(o)||""}const ab=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),cb=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",th=o=>o.split("?")[0],rh=10,ub=ab();class lb{constructor(t){if(this.url=t,this.events=new Nr.EventEmitter,this.registering=!1,!wl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ob(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!wl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const a=iv.isReactNative()?void 0:{rejectUnauthorized:!nv(t)},l=new ub(t,[],a);cb()?l.onerror=g=>{const O=g;n(this.emitError(O.error))}:l.on("error",g=>{n(this.emitError(g))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?sb(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),a=n.message||n.toString(),l=Ta(t,a);this.events.emit("payload",l)}parseError(t,r=this.url){return sv(t,th(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>rh&&this.events.setMaxListeners(rh)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${th(this.url)}`));return this.events.emit("register_error",r),r}}function hb(o,t){if(o.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var a=0;a<o.length;a++){var l=o.charAt(a),g=l.charCodeAt(0);if(r[g]!==255)throw new TypeError(l+" is ambiguous");r[g]=a}var O=o.length,N=o.charAt(0),F=Math.log(O)/Math.log(256),C=Math.log(256)/Math.log(O);function U(H){if(H instanceof Uint8Array||(ArrayBuffer.isView(H)?H=new Uint8Array(H.buffer,H.byteOffset,H.byteLength):Array.isArray(H)&&(H=Uint8Array.from(H))),!(H instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(H.length===0)return"";for(var X=0,G=0,oe=0,f=H.length;oe!==f&&H[oe]===0;)oe++,X++;for(var y=(f-oe)*C+1>>>0,E=new Uint8Array(y);oe!==f;){for(var b=H[oe],m=0,$=y-1;(b!==0||m<G)&&$!==-1;$--,m++)b+=256*E[$]>>>0,E[$]=b%O>>>0,b=b/O>>>0;if(b!==0)throw new Error("Non-zero carry");G=m,oe++}for(var x=y-G;x!==y&&E[x]===0;)x++;for(var re=N.repeat(X);x<y;++x)re+=o.charAt(E[x]);return re}function K(H){if(typeof H!="string")throw new TypeError("Expected String");if(H.length===0)return new Uint8Array;var X=0;if(H[X]!==" "){for(var G=0,oe=0;H[X]===N;)G++,X++;for(var f=(H.length-X)*F+1>>>0,y=new Uint8Array(f);H[X];){var E=r[H.charCodeAt(X)];if(E===255)return;for(var b=0,m=f-1;(E!==0||b<oe)&&m!==-1;m--,b++)E+=O*y[m]>>>0,y[m]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");oe=b,X++}if(H[X]!==" "){for(var $=f-oe;$!==f&&y[$]===0;)$++;for(var x=new Uint8Array(G+(f-$)),re=G;$!==f;)x[re++]=y[$++];return x}}}function J(H){var X=K(H);if(X)return X;throw new Error(`Non-${t} character`)}return{encode:U,decodeUnsafe:K,decode:J}}var fb=hb,db=fb;const df=o=>{if(o instanceof Uint8Array&&o.constructor.name==="Uint8Array")return o;if(o instanceof ArrayBuffer)return new Uint8Array(o);if(ArrayBuffer.isView(o))return new Uint8Array(o.buffer,o.byteOffset,o.byteLength);throw new Error("Unknown type, must be binary type")},pb=o=>new TextEncoder().encode(o),gb=o=>new TextDecoder().decode(o);class yb{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class mb{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return pf(this,t)}}class vb{constructor(t){this.decoders=t}or(t){return pf(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const pf=(o,t)=>new vb({...o.decoders||{[o.prefix]:o},...t.decoders||{[t.prefix]:t}});class _b{constructor(t,r,n,a){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=a,this.encoder=new yb(t,r,n),this.decoder=new mb(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Us=({name:o,prefix:t,encode:r,decode:n})=>new _b(o,t,r,n),$n=({prefix:o,name:t,alphabet:r})=>{const{encode:n,decode:a}=db(r,t);return Us({prefix:o,name:t,encode:n,decode:l=>df(a(l))})},wb=(o,t,r,n)=>{const a={};for(let C=0;C<t.length;++C)a[t[C]]=C;let l=o.length;for(;o[l-1]==="=";)--l;const g=new Uint8Array(l*r/8|0);let O=0,N=0,F=0;for(let C=0;C<l;++C){const U=a[o[C]];if(U===void 0)throw new SyntaxError(`Non-${n} character`);N=N<<r|U,O+=r,O>=8&&(O-=8,g[F++]=255&N>>O)}if(O>=r||255&N<<8-O)throw new SyntaxError("Unexpected end of data");return g},bb=(o,t,r)=>{const n=t[t.length-1]==="=",a=(1<<r)-1;let l="",g=0,O=0;for(let N=0;N<o.length;++N)for(O=O<<8|o[N],g+=8;g>r;)g-=r,l+=t[a&O>>g];if(g&&(l+=t[a&O<<r-g]),n)for(;l.length*r&7;)l+="=";return l},Rt=({name:o,prefix:t,bitsPerChar:r,alphabet:n})=>Us({prefix:t,name:o,encode(a){return bb(a,n,r)},decode(a){return wb(a,n,r,o)}}),Eb=Us({prefix:"\0",name:"identity",encode:o=>gb(o),decode:o=>pb(o)});var Sb=Object.freeze({__proto__:null,identity:Eb});const Ib=Rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ob=Object.freeze({__proto__:null,base2:Ib});const xb=Rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Pb=Object.freeze({__proto__:null,base8:xb});const Nb=$n({prefix:"9",name:"base10",alphabet:"0123456789"});var Tb=Object.freeze({__proto__:null,base10:Nb});const Cb=Rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ab=Rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Rb=Object.freeze({__proto__:null,base16:Cb,base16upper:Ab});const $b=Rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Fb=Rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Db=Rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),jb=Rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ub=Rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Lb=Rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),qb=Rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Mb=Rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),kb=Rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var zb=Object.freeze({__proto__:null,base32:$b,base32upper:Fb,base32pad:Db,base32padupper:jb,base32hex:Ub,base32hexupper:Lb,base32hexpad:qb,base32hexpadupper:Mb,base32z:kb});const Hb=$n({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Vb=$n({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Bb=Object.freeze({__proto__:null,base36:Hb,base36upper:Vb});const Kb=$n({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Wb=$n({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Gb=Object.freeze({__proto__:null,base58btc:Kb,base58flickr:Wb});const Jb=Rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Qb=Rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Yb=Rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Xb=Rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Zb=Object.freeze({__proto__:null,base64:Jb,base64pad:Qb,base64url:Yb,base64urlpad:Xb});const gf=Array.from(""),eE=gf.reduce((o,t,r)=>(o[r]=t,o),[]),tE=gf.reduce((o,t,r)=>(o[t.codePointAt(0)]=r,o),[]);function rE(o){return o.reduce((t,r)=>(t+=eE[r],t),"")}function iE(o){const t=[];for(const r of o){const n=tE[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const nE=Us({prefix:"",name:"base256emoji",encode:rE,decode:iE});var sE=Object.freeze({__proto__:null,base256emoji:nE}),oE=yf,ih=128,aE=127,cE=~aE,uE=Math.pow(2,31);function yf(o,t,r){t=t||[],r=r||0;for(var n=r;o>=uE;)t[r++]=o&255|ih,o/=128;for(;o&cE;)t[r++]=o&255|ih,o>>>=7;return t[r]=o|0,yf.bytes=r-n+1,t}var lE=va,hE=128,nh=127;function va(o,n){var r=0,n=n||0,a=0,l=n,g,O=o.length;do{if(l>=O)throw va.bytes=0,new RangeError("Could not decode varint");g=o[l++],r+=a<28?(g&nh)<<a:(g&nh)*Math.pow(2,a),a+=7}while(g>=hE);return va.bytes=l-n,r}var fE=Math.pow(2,7),dE=Math.pow(2,14),pE=Math.pow(2,21),gE=Math.pow(2,28),yE=Math.pow(2,35),mE=Math.pow(2,42),vE=Math.pow(2,49),_E=Math.pow(2,56),wE=Math.pow(2,63),bE=function(o){return o<fE?1:o<dE?2:o<pE?3:o<gE?4:o<yE?5:o<mE?6:o<vE?7:o<_E?8:o<wE?9:10},EE={encode:oE,decode:lE,encodingLength:bE},mf=EE;const sh=(o,t,r=0)=>(mf.encode(o,t,r),t),oh=o=>mf.encodingLength(o),_a=(o,t)=>{const r=t.byteLength,n=oh(o),a=n+oh(r),l=new Uint8Array(a+r);return sh(o,l,0),sh(r,l,n),l.set(t,a),new SE(o,r,t,l)};class SE{constructor(t,r,n,a){this.code=t,this.size=r,this.digest=n,this.bytes=a}}const vf=({name:o,code:t,encode:r})=>new IE(o,t,r);class IE{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?_a(this.code,r):r.then(n=>_a(this.code,n))}else throw Error("Unknown type, must be binary type")}}const _f=o=>async t=>new Uint8Array(await crypto.subtle.digest(o,t)),OE=vf({name:"sha2-256",code:18,encode:_f("SHA-256")}),xE=vf({name:"sha2-512",code:19,encode:_f("SHA-512")});var PE=Object.freeze({__proto__:null,sha256:OE,sha512:xE});const wf=0,NE="identity",bf=df,TE=o=>_a(wf,bf(o)),CE={code:wf,name:NE,encode:bf,digest:TE};var AE=Object.freeze({__proto__:null,identity:CE});new TextEncoder,new TextDecoder;const ah={...Sb,...Ob,...Pb,...Tb,...Rb,...zb,...Bb,...Gb,...Zb,...sE};({...PE,...AE});function Ef(o){return globalThis.Buffer!=null?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):o}function RE(o=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ef(globalThis.Buffer.allocUnsafe(o)):new Uint8Array(o)}function Sf(o,t,r,n){return{name:o,prefix:t,encoder:{name:o,prefix:t,encode:r},decoder:{decode:n}}}const ch=Sf("utf8","u",o=>"u"+new TextDecoder("utf8").decode(o),o=>new TextEncoder().encode(o.substring(1))),ra=Sf("ascii","a",o=>{let t="a";for(let r=0;r<o.length;r++)t+=String.fromCharCode(o[r]);return t},o=>{o=o.substring(1);const t=RE(o.length);for(let r=0;r<o.length;r++)t[r]=o.charCodeAt(r);return t}),$E={utf8:ch,"utf-8":ch,hex:ah.base16,latin1:ra,ascii:ra,binary:ra,...ah};function FE(o,t="utf8"){const r=$E[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ef(globalThis.Buffer.from(o,"utf-8")):r.decoder.decode(`${r.prefix}${o}`)}const If="wc",DE=2,ka="core",ei=`${If}@2:${ka}:`,jE={name:ka,logger:"error"},UE={database:":memory:"},LE="crypto",uh="client_ed25519_seed",qE=le.ONE_DAY,ME="keychain",kE="0.3",zE="messages",HE="0.3",VE=le.SIX_HOURS,BE="publisher",Of="irn",KE="error",xf="wss://relay.walletconnect.com",lh="wss://relay.walletconnect.org",WE="relayer",jt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},GE="_subscription",Lr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},JE=le.ONE_SECOND,QE="2.10.1",YE=1e4,XE="0.3",ZE="WALLETCONNECT_CLIENT_ID",Pr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},eS="subscription",tS="0.3",rS=le.FIVE_SECONDS*1e3,iS="pairing",nS="0.3",yn={wc_pairingDelete:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:le.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:le.ONE_DAY,prompt:!1,tag:0},res:{ttl:le.ONE_DAY,prompt:!1,tag:0}}},bn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},xr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},sS="history",oS="0.3",aS="expirer",yr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},cS="0.3",ia="verify-api",Ns="https://verify.walletconnect.com",hh="https://verify.walletconnect.org";class uS{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=ME,this.version=kE,this.initialized=!1,this.storagePrefix=ei,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,a)=>{this.isInitialized(),this.keychain.set(n,a),await this.persist()},this.get=n=>{this.isInitialized();const a=this.keychain.get(n);if(typeof a>"u"){const{message:l}=se("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(l)}return a},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,af(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?cf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}let lS=class{constructor(t,r,n){this.core=t,this.logger=r,this.name=LE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=Ul(a);return Xh(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=V_();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),g=Ul(l),O=ya();return await v_(O,a,qE,g)},this.generateSharedKey=(a,l,g)=>{this.isInitialized();const O=this.getPrivateKey(a),N=B_(O,l);return this.setSymKey(N,g)},this.setSymKey=async(a,l)=>{this.isInitialized();const g=l||K_(a);return await this.keychain.set(g,a),g},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,g)=>{this.isInitialized();const O=of(g),N=r_(l);if(Vl(O)){const K=O.senderPublicKey,J=O.receiverPublicKey;a=await this.generateSharedKey(K,J)}const F=this.getSymKey(a),{type:C,senderPublicKey:U}=O;return G_({type:C,symKey:F,message:N,senderPublicKey:U})},this.decode=async(a,l,g)=>{this.isInitialized();const O=Y_(l,g);if(Vl(O)){const N=O.receiverPublicKey,F=O.senderPublicKey;a=await this.generateSharedKey(N,F)}try{const N=this.getSymKey(a),F=J_({symKey:N,encoded:l});return t_(F)}catch(N){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(N)}},this.getPayloadType=a=>{const l=Cs(a);return Tn(l.type)},this.getPayloadSenderPublicKey=a=>{const l=Cs(a);return l.senderPublicKey?Vt(l.senderPublicKey,Ht):void 0},this.core=t,this.logger=xe.generateChildLogger(r,this.name),this.keychain=n||new uS(this.core,this.logger)}get context(){return xe.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(uh)}catch{t=ya(),await this.keychain.set(uh,t)}return FE(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}};class hS extends Vv{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=zE,this.version=HE,this.initialized=!1,this.storagePrefix=ei,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,a)=>{this.isInitialized();const l=ki(a);let g=this.messages.get(n);return typeof g>"u"&&(g={}),typeof g[l]<"u"||(g[l]=a,this.messages.set(n,g),await this.persist()),l},this.get=n=>{this.isInitialized();let a=this.messages.get(n);return typeof a>"u"&&(a={}),a},this.has=(n,a)=>{this.isInitialized();const l=this.get(n),g=ki(a);return typeof l[g]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=xe.generateChildLogger(t,this.name),this.core=r}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,af(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?cf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class fS extends Bv{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Nr.EventEmitter,this.name=BE,this.queue=new Map,this.publishTimeout=le.toMiliseconds(le.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,a,l)=>{var g;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:l}});try{const O=(l==null?void 0:l.ttl)||VE,N=ma(l),F=(l==null?void 0:l.prompt)||!1,C=(l==null?void 0:l.tag)||0,U=(l==null?void 0:l.id)||ov().toString(),K={topic:n,message:a,opts:{ttl:O,relay:N,prompt:F,tag:C,id:U}},J=setTimeout(()=>this.queue.set(U,K),this.publishTimeout);try{await await Pn(this.rpcPublish(n,a,O,N,F,C,U),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(U),this.relayer.events.emit(jt.publish,K)}catch(H){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(g=l==null?void 0:l.internal)!=null&&g.throwOnFailedPublish)throw this.removeRequestFromQueue(U),H;return}finally{clearTimeout(J)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:l}})}catch(O){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(O),O}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.relayer=t,this.logger=xe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return xe.getLoggerContext(this.logger)}rpcPublish(t,r,n,a,l,g,O){var N,F,C,U;const K={method:xs(a.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:l,tag:g},id:O};return zt((N=K.params)==null?void 0:N.prompt)&&((F=K.params)==null||delete F.prompt),zt((C=K.params)==null?void 0:C.tag)&&((U=K.params)==null||delete U.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:K}),this.relayer.request(K)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:a}=t;await this.publish(r,n,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Hi.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(jt.connection_stalled);return}this.checkQueue()}),this.relayer.on(jt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class dS{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const a=n.filter(l=>l!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var pS=Object.defineProperty,gS=Object.defineProperties,yS=Object.getOwnPropertyDescriptors,fh=Object.getOwnPropertySymbols,mS=Object.prototype.hasOwnProperty,vS=Object.prototype.propertyIsEnumerable,dh=(o,t,r)=>t in o?pS(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,mn=(o,t)=>{for(var r in t||(t={}))mS.call(t,r)&&dh(o,r,t[r]);if(fh)for(var r of fh(t))vS.call(t,r)&&dh(o,r,t[r]);return o},na=(o,t)=>gS(o,yS(t));class _S extends Gv{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new dS,this.events=new Nr.EventEmitter,this.name=eS,this.version=tS,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=ei,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}});try{const l=ma(a),g={topic:n,relay:l};this.pending.set(n,g);const O=await this.rpcSubscribe(n,l);return this.onSubscribe(O,g),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}}),O}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(n,a.id,a):await this.unsubscribeByTopic(n,a)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((a,l)=>{const g=new le.Watch;g.start(this.pendingSubscriptionWatchLabel);const O=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(O),g.stop(this.pendingSubscriptionWatchLabel),a(!0)),g.elapsed(this.pendingSubscriptionWatchLabel)>=rS&&(clearInterval(O),g.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=xe.generateChildLogger(r,this.name),this.clientId=""}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const a=ma(n);await this.rpcUnsubscribe(t,r,a);const l=xt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const n={method:xs(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Pn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(jt.connection_stalled)}return ki(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:xs(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Pn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(jt.connection_stalled)}}rpcUnsubscribe(t,r,n){const a={method:xs(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,na(mn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,mn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,mn({},r)),this.topicMap.set(r.topic,t),this.events.emit(Pr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(Pr.deleted,na(mn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Pr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Pr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Rn(r)&&this.onBatchSubscribe(r.map((n,a)=>na(mn({},t[a]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Hi.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(jt.connect,async()=>{await this.onConnect()}),this.relayer.on(jt.disconnect,()=>{this.onDisconnect()}),this.events.on(Pr.created,async t=>{const r=Pr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Pr.deleted,async t=>{const r=Pr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var wS=Object.defineProperty,ph=Object.getOwnPropertySymbols,bS=Object.prototype.hasOwnProperty,ES=Object.prototype.propertyIsEnumerable,gh=(o,t,r)=>t in o?wS(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,SS=(o,t)=>{for(var r in t||(t={}))bS.call(t,r)&&gh(o,r,t[r]);if(ph)for(var r of ph(t))ES.call(t,r)&&gh(o,r,t[r]);return o};class IS extends Kv{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Nr.EventEmitter,this.name=WE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(jt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(jt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Lr.payload,this.onPayloadHandler),this.provider.on(Lr.connect,this.onConnectHandler),this.provider.on(Lr.disconnect,this.onDisconnectHandler),this.provider.on(Lr.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?xe.generateChildLogger(t.logger,this.name):xe.pino(xe.getDefaultLoggerOptions({level:t.logger||KE})),this.messages=new hS(this.logger,t.core),this.subscriber=new _S(this,this.logger),this.publisher=new fS(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||xf,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${lh}...`),await this.restartTransport(lh)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},YE)}get context(){return xe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let a=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";return a||(await Promise.all([new Promise(l=>{this.subscriber.once(Pr.created,g=>{g.topic===t&&l()})}),new Promise(async l=>{a=await this.subscriber.subscribe(t,r),l()})]),a)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Pn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Pr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Pn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){n(a);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(Lr.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await eh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ti(new lb(cw({sdkVersion:QE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,n);return a&&this.logger.debug(`Ignoring duplicate message: ${n}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Ca(t)){if(!t.method.endsWith(GE))return;const r=t.params,{topic:n,message:a,publishedAt:l}=r.data,g={topic:n,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(SS({type:"event",event:r.id},g)),this.events.emit(r.id,g),await this.acknowledgePayload(t),await this.onMessageEvent(g)}else Aa(t)&&this.events.emit(jt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(jt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Ra(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Lr.payload,this.onPayloadHandler),this.provider.off(Lr.connect,this.onConnectHandler),this.provider.off(Lr.disconnect,this.onDisconnectHandler),this.provider.off(Lr.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(jt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await eh();eb(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(jt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},le.toMiliseconds(JE)))}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var OS=Object.defineProperty,yh=Object.getOwnPropertySymbols,xS=Object.prototype.hasOwnProperty,PS=Object.prototype.propertyIsEnumerable,mh=(o,t,r)=>t in o?OS(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,vh=(o,t)=>{for(var r in t||(t={}))xS.call(t,r)&&mh(o,r,t[r]);if(yh)for(var r of yh(t))PS.call(t,r)&&mh(o,r,t[r]);return o};class Ls extends Wv{constructor(t,r,n,a=ei,l=void 0){super(t,r,n,a),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=XE,this.cached=[],this.initialized=!1,this.storagePrefix=ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(g=>{this.getKey&&g!==null&&!zt(g)?this.map.set(this.getKey(g),g):Aw(g)?this.map.set(g.id,g):Rw(g)&&this.map.set(g.topic,g)}),this.cached=[],this.initialized=!0)},this.set=async(g,O)=>{this.isInitialized(),this.map.has(g)?await this.update(g,O):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:g,value:O}),this.map.set(g,O),await this.persist())},this.get=g=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:g}),this.getData(g)),this.getAll=g=>(this.isInitialized(),g?this.values.filter(O=>Object.keys(g).every(N=>tv(O[N],g[N]))):this.values),this.update=async(g,O)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:g,update:O});const N=vh(vh({},this.getData(g)),O);this.map.set(g,N),await this.persist()},this.delete=async(g,O)=>{this.isInitialized(),this.map.has(g)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:g,reason:O}),this.map.delete(g),await this.persist())},this.logger=xe.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class NS{constructor(t,r){this.core=t,this.logger=r,this.name=iS,this.version=nS,this.events=new Na,this.initialized=!1,this.storagePrefix=ei,this.ignoredPayloadTypes=[wi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=ya(),a=await this.core.crypto.setSymKey(n),l=Er(le.FIVE_MINUTES),g={protocol:Of},O={topic:a,expiry:l,relay:g,active:!1},N=bw({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:n,relay:g});return await this.pairings.set(a,O),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:N}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:a,symKey:l,relay:g}=vw(n.uri);let O;if(this.pairings.keys.includes(a)&&(O=this.pairings.get(a),O.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:g}));const N=Er(le.FIVE_MINUTES),F={topic:a,relay:g,expiry:N,active:!1};return await this.pairings.set(a,F),this.core.expirer.set(a,N),n.activatePairing&&await this.activate({topic:a}),this.events.emit(bn.create,F),F},this.activate=async({topic:n})=>{this.isInitialized();const a=Er(le.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:a}),this.core.expirer.set(n,a)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:a}=n;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:g,resolve:O,reject:N}=Mi();this.events.once(it("pairing_ping",l),({error:F})=>{F?N(F):O()}),await g()}},this.updateExpiry=async({topic:n,expiry:a})=>{this.isInitialized(),await this.pairings.update(n,{expiry:a})},this.updateMetadata=async({topic:n,metadata:a})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:a}=n;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",xt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(n,a,l)=>{const g=In(a,l),O=await this.core.crypto.encode(n,g),N=yn[a].req;return this.core.history.set(n,g),this.core.relayer.publish(n,O,N),g.id},this.sendResult=async(n,a,l)=>{const g=Ra(n,l),O=await this.core.crypto.encode(a,g),N=await this.core.history.get(a,n),F=yn[N.request.method].res;await this.core.relayer.publish(a,O,F),await this.core.history.resolve(g)},this.sendError=async(n,a,l)=>{const g=Ta(n,l),O=await this.core.crypto.encode(a,g),N=await this.core.history.get(a,n),F=yn[N.request.method]?yn[N.request.method].res:yn.unregistered_method.res;await this.core.relayer.publish(a,O,F),await this.core.history.resolve(g)},this.deletePairing=async(n,a)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,xt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),a?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(a=>Zr(a.expiry));await Promise.all(n.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=n=>{const{topic:a,payload:l}=n;switch(l.method){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async n=>{const{topic:a,payload:l}=n,g=(await this.core.history.get(a,l.id)).request.method;switch(g){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(g)}},this.onPairingPingRequest=async(n,a)=>{const{id:l}=a;try{this.isValidPing({topic:n}),await this.sendResult(l,n,!0),this.events.emit(bn.ping,{id:l,topic:n})}catch(g){await this.sendError(l,n,g),this.logger.error(g)}},this.onPairingPingResponse=(n,a)=>{const{id:l}=a;setTimeout(()=>{Xr(a)?this.events.emit(it("pairing_ping",l),{}):Mr(a)&&this.events.emit(it("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(n,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(bn.delete,{id:l,topic:n})}catch(g){await this.sendError(l,n,g),this.logger.error(g)}},this.onUnknownRpcMethodRequest=async(n,a)=>{const{id:l,method:g}=a;try{if(this.registeredMethods.includes(g))return;const O=xt("WC_METHOD_UNSUPPORTED",g);await this.sendError(l,n,O),this.logger.error(O)}catch(O){await this.sendError(l,n,O),this.logger.error(O)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(xt("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!Yt(n)){const{message:a}=se("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(a)}if(!Cw(n.uri)){const{message:a}=se("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(a)}},this.isValidPing=async n=>{if(!Yt(n)){const{message:l}=se("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(l)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidDisconnect=async n=>{if(!Yt(n)){const{message:l}=se("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(l)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async n=>{if(!Pt(n,!1)){const{message:a}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(a)}if(!this.pairings.keys.includes(n)){const{message:a}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(a)}if(Zr(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:a}=se("EXPIRED",`pairing topic: ${n}`);throw new Error(a)}},this.core=t,this.logger=xe.generateChildLogger(r,this.name),this.pairings=new Ls(this.core,this.logger,this.name,this.storagePrefix)}get context(){return xe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(jt.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(r,n);try{Ca(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Aa(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(l){this.logger.error(l)}})}registerExpirerEvents(){this.core.expirer.on(yr.expired,async t=>{const{topic:r}=lf(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(bn.expire,{topic:r}))})}}class TS extends Hv{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Nr.EventEmitter,this.name=sS,this.version=oS,this.cached=[],this.initialized=!1,this.storagePrefix=ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:a,chainId:l}),this.records.has(a.id))return;const g={id:a.id,topic:n,request:{method:a.method,params:a.params||null},chainId:l,expiry:Er(le.THIRTY_DAYS)};this.records.set(g.id,g),this.events.emit(xr.created,g)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const a=await this.getRecord(n.id);typeof a.response>"u"&&(a.response=Mr(n)?{error:n.error}:{result:n.result},this.records.set(a.id,a),this.events.emit(xr.updated,a))},this.get=async(n,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:a}),await this.getRecord(a)),this.delete=(n,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===n){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(xr.deleted,l)}})},this.exists=async(n,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===n:!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:In(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(xr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(xr.created,t=>{const r=xr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(xr.updated,t=>{const r=xr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(xr.deleted,t=>{const r=xr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Hi.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{le.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class CS extends Jv{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Nr.EventEmitter,this.name=aS,this.version=cS,this.cached=[],this.initialized=!1,this.storagePrefix=ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const a=this.formatTarget(n);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(n,a)=>{this.isInitialized();const l=this.formatTarget(n),g={target:l,expiry:a};this.expirations.set(l,g),this.checkExpiry(l,g),this.events.emit(yr.created,{target:l,expiration:g})},this.get=n=>{this.isInitialized();const a=this.formatTarget(n);return this.getExpiration(a)},this.del=n=>{if(this.isInitialized(),this.has(n)){const a=this.formatTarget(n),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(yr.deleted,{target:a,expiration:l})}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return uw(t);if(typeof t=="number")return lw(t);const{message:r}=se("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(yr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;le.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(yr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Hi.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(yr.created,t=>{const r=yr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(yr.expired,t=>{const r=yr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(yr.deleted,t=>{const r=yr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class AS extends Qv{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=ia,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||js()||!Cn())return;const a=(n==null?void 0:n.verifyUrl)||Ns;this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(l){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(l)}if(!this.initialized){this.removeIframe(),this.verifyUrl=hh;try{await this.createIframe()}catch(l){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(l),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const a=(n==null?void 0:n.verifyUrl)||Ns;let l;try{l=await this.fetchAttestation(n.attestationId,a)}catch(g){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${a}`),this.logger.info(g),l=await this.fetchAttestation(n.attestationId,hh)}return l},this.fetchAttestation=async(n,a)=>{this.logger.info(`resolving attestation: ${n} from url: ${a}`);const l=this.startAbortTimer(le.ONE_SECOND*2),g=await fetch(`${a}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(l),g.status===200?await g.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const a=l=>{l.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),n())};await Promise.race([new Promise(l=>{if(document.getElementById(ia))return l();window.addEventListener("message",a);const g=document.createElement("iframe");g.id=ia,g.src=`${this.verifyUrl}/${this.projectId}`,g.style.display="none",document.body.append(g),this.iframe=g,n=l}),new Promise((l,g)=>setTimeout(()=>{window.removeEventListener("message",a),g("verify iframe load timeout")},le.toMiliseconds(le.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=xe.generateChildLogger(r,this.name),this.verifyUrl=Ns,this.abortController=new AbortController,this.isDevEnv=qa()&&{}.IS_VITEST}get context(){return xe.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),le.toMiliseconds(t))}}var RS=Object.defineProperty,_h=Object.getOwnPropertySymbols,$S=Object.prototype.hasOwnProperty,FS=Object.prototype.propertyIsEnumerable,wh=(o,t,r)=>t in o?RS(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,bh=(o,t)=>{for(var r in t||(t={}))$S.call(t,r)&&wh(o,r,t[r]);if(_h)for(var r of _h(t))FS.call(t,r)&&wh(o,r,t[r]);return o};class za extends zv{constructor(t){super(t),this.protocol=If,this.version=DE,this.name=ka,this.events=new Nr.EventEmitter,this.initialized=!1,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||xf;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:xe.pino(xe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||jE.logger}));this.logger=xe.generateChildLogger(r,this.name),this.heartbeat=new Hi.HeartBeat,this.crypto=new lS(this,this.logger,t==null?void 0:t.keychain),this.history=new TS(this,this.logger),this.expirer=new CS(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Rv(bh(bh({},UE),t==null?void 0:t.storageOptions)),this.relayer=new IS({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new NS(this,this.logger),this.verify=new AS(this.projectId||"",this.logger)}static async init(t){const r=new za(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(ZE,n),r}get context(){return xe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const DS=za,Pf="wc",Nf=2,Tf="client",Ha=`${Pf}@${Nf}:${Tf}:`,sa={name:Tf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Eh="WALLETCONNECT_DEEPLINK_CHOICE",jS="proposal",Cf="Proposal expired",US="session",Ss=le.SEVEN_DAYS,LS="engine",vn={wc_sessionPropose:{req:{ttl:le.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1104},res:{ttl:le.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1106},res:{ttl:le.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:le.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:le.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:le.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:le.ONE_DAY,prompt:!1,tag:1112},res:{ttl:le.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:le.THIRTY_SECONDS,prompt:!1,tag:1115}}},oa={min:le.FIVE_MINUTES,max:le.SEVEN_DAYS},qr={idle:"IDLE",active:"ACTIVE"},qS="request",MS=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var kS=Object.defineProperty,zS=Object.defineProperties,HS=Object.getOwnPropertyDescriptors,Sh=Object.getOwnPropertySymbols,VS=Object.prototype.hasOwnProperty,BS=Object.prototype.propertyIsEnumerable,Ih=(o,t,r)=>t in o?kS(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Qt=(o,t)=>{for(var r in t||(t={}))VS.call(t,r)&&Ih(o,r,t[r]);if(Sh)for(var r of Sh(t))BS.call(t,r)&&Ih(o,r,t[r]);return o},_n=(o,t)=>zS(o,HS(t));class KS extends Xv{constructor(t){super(t),this.name=LS,this.events=new Na,this.initialized=!1,this.ignoredPayloadTypes=[wi],this.requestQueue={state:qr.idle,queue:[]},this.sessionRequestQueue={state:qr.idle,queue:[]},this.requestQueueDelay=le.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(vn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},le.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=_n(Qt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:g,sessionProperties:O,relays:N}=n;let F=a,C,U=!1;if(F&&(U=this.client.core.pairing.pairings.get(F).active),!F||!U){const{topic:y,uri:E}=await this.client.core.pairing.create();F=y,C=E}const K=await this.client.core.crypto.generateKeyPair(),J=Qt({requiredNamespaces:l,optionalNamespaces:g,relays:N??[{protocol:Of}],proposer:{publicKey:K,metadata:this.client.metadata}},O&&{sessionProperties:O}),{reject:H,resolve:X,done:G}=Mi(le.FIVE_MINUTES,Cf);if(this.events.once(it("session_connect"),async({error:y,session:E})=>{if(y)H(y);else if(E){E.self.publicKey=K;const b=_n(Qt({},E),{requiredNamespaces:E.requiredNamespaces,optionalNamespaces:E.optionalNamespaces});await this.client.session.set(E.topic,b),await this.setExpiry(E.topic,E.expiry),F&&await this.client.core.pairing.updateMetadata({topic:F,metadata:E.peer.metadata}),X(b)}}),!F){const{message:y}=se("NO_MATCHING_KEY",`connect() pairing topic: ${F}`);throw new Error(y)}const oe=await this.sendRequest({topic:F,method:"wc_sessionPropose",params:J}),f=Er(le.FIVE_MINUTES);return await this.setProposal(oe,Qt({id:oe,expiry:f},J)),{uri:C,approval:G}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:a,namespaces:l,sessionProperties:g}=r,O=this.client.proposal.get(n);let{pairingTopic:N,proposer:F,requiredNamespaces:C,optionalNamespaces:U}=O;N=N||"",On(C)||(C=Ow(l,"approve()"));const K=await this.client.core.crypto.generateKeyPair(),J=F.publicKey,H=await this.client.core.crypto.generateSharedKey(K,J);N&&n&&(await this.client.core.pairing.updateMetadata({topic:N,metadata:F.metadata}),await this.sendResult({id:n,topic:N,result:{relay:{protocol:a??"irn"},responderPublicKey:K}}),await this.client.proposal.delete(n,xt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:N}));const X=Qt({relay:{protocol:a??"irn"},namespaces:l,requiredNamespaces:C,optionalNamespaces:U,pairingTopic:N,controller:{publicKey:K,metadata:this.client.metadata},expiry:Er(Ss)},g&&{sessionProperties:g});await this.client.core.relayer.subscribe(H),await this.sendRequest({topic:H,method:"wc_sessionSettle",params:X,throwOnFailedPublish:!0});const G=_n(Qt({},X),{topic:H,pairingTopic:N,acknowledged:!1,self:X.controller,peer:{publicKey:F.publicKey,metadata:F.metadata},controller:K});return await this.client.session.set(H,G),await this.setExpiry(H,Er(Ss)),{topic:H,acknowledged:()=>new Promise(oe=>setTimeout(()=>oe(this.client.session.get(H)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(n);l&&(await this.sendError(n,l,a),await this.client.proposal.delete(n,xt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:a}=r,l=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:g,resolve:O,reject:N}=Mi();return this.events.once(it("session_update",l),({error:F})=>{F?N(F):O()}),await this.client.session.update(n,{namespaces:a}),{acknowledged:g}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,a=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:l,resolve:g,reject:O}=Mi();return this.events.once(it("session_extend",a),({error:N})=>{N?O(N):g()}),await this.setExpiry(n,Er(Ss)),{acknowledged:l}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:a,topic:l,expiry:g}=r,O=av(),{done:N,resolve:F,reject:C}=Mi(g);return this.events.once(it("session_request",O),({error:U,result:K})=>{U?C(U):F(K)}),await Promise.all([new Promise(async U=>{await this.sendRequest({clientRpcId:O,topic:l,method:"wc_sessionRequest",params:{request:a,chainId:n},expiry:g,throwOnFailedPublish:!0}).catch(K=>C(K)),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:n,id:O}),U()}),new Promise(async U=>{const K=await this.client.core.storage.getItem(Eh);hw({id:O,topic:l,wcDeepLink:K}),U()}),N()]).then(U=>U[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:a}=r,{id:l}=a;Xr(a)?await this.sendResult({id:l,topic:n,result:a.result,throwOnFailedPublish:!0}):Mr(a)&&await this.sendError(l,n,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const a=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:l,resolve:g,reject:O}=Mi();this.events.once(it("session_ping",a),({error:N})=>{N?O(N):g()}),await l()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:a,chainId:l}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:a,chainId:l}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:xt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>Nw(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(l=>{var g,O;return((g=l.peerMetadata)==null?void 0:g.url)&&((O=l.peerMetadata)==null?void 0:O.url)===r.peer.metadata.url&&l.topic&&l.topic!==n.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,xt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Eh).catch(l=>this.client.logger.warn(l))},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,xt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(l=>l.id!==r),a&&(this.sessionRequestQueue.state=qr.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=vn.wc_sessionRequest.req.ttl,{id:a,topic:l,params:g,verifyContext:O}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:g,verifyContext:O}),n&&this.client.core.expirer.set(a,Er(n))},this.sendRequest=async r=>{const{topic:n,method:a,params:l,expiry:g,relayRpcId:O,clientRpcId:N,throwOnFailedPublish:F}=r,C=In(a,l,N);if(Cn()&&MS.includes(a)){const J=ki(JSON.stringify(C));this.client.core.verify.register({attestationId:J})}const U=await this.client.core.crypto.encode(n,C),K=vn[a].req;return g&&(K.ttl=g),O&&(K.id=O),this.client.core.history.set(n,C),F?(K.internal=_n(Qt({},K.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,U,K)):this.client.core.relayer.publish(n,U,K).catch(J=>this.client.logger.error(J)),C.id},this.sendResult=async r=>{const{id:n,topic:a,result:l,throwOnFailedPublish:g}=r,O=Ra(n,l),N=await this.client.core.crypto.encode(a,O),F=await this.client.core.history.get(a,n),C=vn[F.request.method].res;g?(C.internal=_n(Qt({},C.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,N,C)):this.client.core.relayer.publish(a,N,C).catch(U=>this.client.logger.error(U)),await this.client.core.history.resolve(O)},this.sendError=async(r,n,a)=>{const l=Ta(r,a),g=await this.client.core.crypto.encode(n,l),O=await this.client.core.history.get(n,r),N=vn[O.request.method].res;this.client.core.relayer.publish(n,g,N),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(a=>{Zr(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Zr(a.expiry)&&n.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...n.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===qr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=qr.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=qr.idle},this.processRequest=r=>{const{topic:n,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(n,a);case"wc_sessionSettle":return this.onSessionSettleRequest(n,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,a);case"wc_sessionExtend":return this.onSessionExtendRequest(n,a);case"wc_sessionPing":return this.onSessionPingRequest(n,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,a);case"wc_sessionRequest":return this.onSessionRequest(n,a);case"wc_sessionEvent":return this.onSessionEventRequest(n,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:a}=r,l=(await this.client.core.history.get(n,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(n,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,a);case"wc_sessionExtend":return this.onSessionExtendResponse(n,a);case"wc_sessionPing":return this.onSessionPingResponse(n,a);case"wc_sessionRequest":return this.onSessionRequestResponse(n,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:a}=se("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,n)=>{const{params:a,id:l}=n;try{this.isValidConnect(Qt({},n.params));const g=Er(le.FIVE_MINUTES),O=Qt({id:l,pairingTopic:r,expiry:g},a);await this.setProposal(l,O);const N=ki(JSON.stringify(n)),F=await this.getVerifyContext(N,O.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:O,verifyContext:F})}catch(g){await this.sendError(l,r,g),this.client.logger.error(g)}},this.onSessionProposeResponse=async(r,n)=>{const{id:a}=n;if(Xr(n)){const{result:l}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const g=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:g});const O=g.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:O});const N=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:N});const F=await this.client.core.crypto.generateSharedKey(O,N);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:F});const C=await this.client.core.relayer.subscribe(F);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:C}),await this.client.core.pairing.activate({topic:r})}else Mr(n)&&(await this.client.proposal.delete(a,xt("USER_DISCONNECTED")),this.events.emit(it("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:a,params:l}=n;try{this.isValidSessionSettleRequest(l);const{relay:g,controller:O,expiry:N,namespaces:F,requiredNamespaces:C,optionalNamespaces:U,sessionProperties:K,pairingTopic:J}=n.params,H=Qt({topic:r,relay:g,expiry:N,namespaces:F,acknowledged:!0,pairingTopic:J,requiredNamespaces:C,optionalNamespaces:U,controller:O.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:O.publicKey,metadata:O.metadata}},K&&{sessionProperties:K});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(it("session_connect"),{session:H}),this.cleanupDuplicatePairings(H)}catch(g){await this.sendError(a,r,g),this.client.logger.error(g)}},this.onSessionSettleResponse=async(r,n)=>{const{id:a}=n;Xr(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(it("session_approve",a),{})):Mr(n)&&(await this.client.session.delete(r,xt("USER_DISCONNECTED")),this.events.emit(it("session_approve",a),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:a,id:l}=n;try{const g=`${r}_session_update`,O=Es.get(g);if(O&&this.isRequestOutOfSync(O,l)){this.client.logger.info(`Discarding out of sync request - ${l}`);return}this.isValidUpdate(Qt({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:l,topic:r,result:!0}),this.client.events.emit("session_update",{id:l,topic:r,params:a}),Es.set(g,l)}catch(g){await this.sendError(l,r,g),this.client.logger.error(g)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:a}=n;Xr(n)?this.events.emit(it("session_update",a),{}):Mr(n)&&this.events.emit(it("session_update",a),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:a}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Er(Ss)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,n)=>{const{id:a}=n;Xr(n)?this.events.emit(it("session_extend",a),{}):Mr(n)&&this.events.emit(it("session_extend",a),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:a}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,n)=>{const{id:a}=n;setTimeout(()=>{Xr(n)?this.events.emit(it("session_ping",a),{}):Mr(n)&&this.events.emit(it("session_ping",a),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(jt.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,n)=>{const{id:a,params:l}=n;try{this.isValidRequest(Qt({topic:r},l));const g=ki(JSON.stringify(In("wc_sessionRequest",l,a))),O=this.client.session.get(r),N=await this.getVerifyContext(g,O.peer.metadata),F={id:a,topic:r,params:l,verifyContext:N};await this.setPendingSessionRequest(F),this.addSessionRequestToSessionRequestQueue(F),this.processSessionRequestQueue()}catch(g){await this.sendError(a,r,g),this.client.logger.error(g)}},this.onSessionRequestResponse=(r,n)=>{const{id:a}=n;Xr(n)?this.events.emit(it("session_request",a),{result:n.result}):Mr(n)&&this.events.emit(it("session_request",a),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:a,params:l}=n;try{const g=`${r}_session_event_${l.event.name}`,O=Es.get(g);if(O&&this.isRequestOutOfSync(O,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(Qt({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l}),Es.set(g,a)}catch(g){await this.sendError(a,r,g),this.client.logger.error(g)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=qr.idle,this.processSessionRequestQueue()},le.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===qr.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=qr.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,In("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer},n.id))},this.isValidConnect=async r=>{if(!Yt(r)){const{message:N}=se("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(N)}const{pairingTopic:n,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:g,relays:O}=r;if(zt(n)||await this.isValidPairingTopic(n),!Mw(O,!0)){const{message:N}=se("MISSING_OR_INVALID",`connect() relays: ${O}`);throw new Error(N)}!zt(a)&&On(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!zt(l)&&On(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),zt(g)||this.validateSessionProps(g,"sessionProperties")},this.validateNamespaces=(r,n)=>{const a=qw(r,"connect()",n);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!Yt(r))throw new Error(se("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:a,relayProtocol:l,sessionProperties:g}=r;await this.isValidProposalId(n);const O=this.client.proposal.get(n),N=Ps(a,"approve()");if(N)throw new Error(N.message);const F=Xl(O.requiredNamespaces,a,"approve()");if(F)throw new Error(F.message);if(!Pt(l,!0)){const{message:C}=se("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(C)}zt(g)||this.validateSessionProps(g,"sessionProperties")},this.isValidReject=async r=>{if(!Yt(r)){const{message:l}=se("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:n,reason:a}=r;if(await this.isValidProposalId(n),!zw(a)){const{message:l}=se("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!Yt(r)){const{message:F}=se("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(F)}const{relay:n,controller:a,namespaces:l,expiry:g}=r;if(!ff(n)){const{message:F}=se("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(F)}const O=$w(a,"onSessionSettleRequest()");if(O)throw new Error(O.message);const N=Ps(l,"onSessionSettleRequest()");if(N)throw new Error(N.message);if(Zr(g)){const{message:F}=se("EXPIRED","onSessionSettleRequest()");throw new Error(F)}},this.isValidUpdate=async r=>{if(!Yt(r)){const{message:N}=se("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(N)}const{topic:n,namespaces:a}=r;await this.isValidSessionTopic(n);const l=this.client.session.get(n),g=Ps(a,"update()");if(g)throw new Error(g.message);const O=Xl(l.requiredNamespaces,a,"update()");if(O)throw new Error(O.message)},this.isValidExtend=async r=>{if(!Yt(r)){const{message:a}=se("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!Yt(r)){const{message:N}=se("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(N)}const{topic:n,request:a,chainId:l,expiry:g}=r;await this.isValidSessionTopic(n);const{namespaces:O}=this.client.session.get(n);if(!Yl(O,l)){const{message:N}=se("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(N)}if(!Hw(a)){const{message:N}=se("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(N)}if(!Kw(O,l,a.method)){const{message:N}=se("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(N)}if(g&&!Qw(g,oa)){const{message:N}=se("MISSING_OR_INVALID",`request() expiry: ${g}. Expiry must be a number (in seconds) between ${oa.min} and ${oa.max}`);throw new Error(N)}},this.isValidRespond=async r=>{if(!Yt(r)){const{message:l}=se("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:n,response:a}=r;if(await this.isValidSessionTopic(n),!Vw(a)){const{message:l}=se("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!Yt(r)){const{message:a}=se("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!Yt(r)){const{message:O}=se("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(O)}const{topic:n,event:a,chainId:l}=r;await this.isValidSessionTopic(n);const{namespaces:g}=this.client.session.get(n);if(!Yl(g,l)){const{message:O}=se("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(O)}if(!Bw(a)){const{message:O}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(O)}if(!Ww(g,l,a.name)){const{message:O}=se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(O)}},this.isValidDisconnect=async r=>{if(!Yt(r)){const{message:a}=se("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const a={verified:{verifyUrl:n.verifyUrl||Ns,validation:"UNKNOWN",origin:n.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});l&&(a.verified.origin=l.origin,a.verified.isScam=l.isScam,a.verified.validation=l.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.info(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(a=>{if(!Pt(a,!1)){const{message:l}=se("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}async isInitialized(){if(!this.initialized){const{message:t}=se("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(jt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const a=await this.client.core.crypto.decode(r,n);try{Ca(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Aa(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(l){this.client.logger.error(l)}})}registerExpirerEvents(){this.client.core.expirer.on(yr.expired,async t=>{const{topic:r,id:n}=lf(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,se("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(bn.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Pt(t,!1)){const{message:r}=se("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Zr(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=se("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Pt(t,!1)){const{message:r}=se("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=se("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Zr(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=se("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Pt(t,!1)){const{message:r}=se("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=se("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!kw(t)){const{message:r}=se("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=se("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Zr(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=se("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class WS extends Ls{constructor(t,r){super(t,r,jS,Ha),this.core=t,this.logger=r}}class GS extends Ls{constructor(t,r){super(t,r,US,Ha),this.core=t,this.logger=r}}class JS extends Ls{constructor(t,r){super(t,r,qS,Ha,n=>n.id),this.core=t,this.logger=r}}let QS=class Af extends Yv{constructor(t){super(t),this.protocol=Pf,this.version=Nf,this.name=sa.name,this.events=new Nr.EventEmitter,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(a){throw this.logger.error(a.message),a}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(a){throw this.logger.error(a.message),a}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(a){throw this.logger.error(a.message),a}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(a){throw this.logger.error(a.message),a}},this.update=async n=>{try{return await this.engine.update(n)}catch(a){throw this.logger.error(a.message),a}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(a){throw this.logger.error(a.message),a}},this.request=async n=>{try{return await this.engine.request(n)}catch(a){throw this.logger.error(a.message),a}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(a){throw this.logger.error(a.message),a}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(a){throw this.logger.error(a.message),a}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(a){throw this.logger.error(a.message),a}},this.find=n=>{try{return this.engine.find(n)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||sa.name,this.metadata=(t==null?void 0:t.metadata)||nw();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:xe.pino(xe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||sa.logger}));this.core=(t==null?void 0:t.core)||new DS(t),this.logger=xe.generateChildLogger(r,this.name),this.session=new GS(this.core,this.logger),this.proposal=new WS(this.core,this.logger),this.pendingRequest=new JS(this.core,this.logger),this.engine=new KS(this)}static async init(t){const r=new Af(t);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Me={};Object.defineProperty(Me,"__esModule",{value:!0});Me.getLocalStorage=Me.getLocalStorageOrThrow=Me.getCrypto=Me.getCryptoOrThrow=Me.getLocation=Me.getLocationOrThrow=Me.getNavigator=Me.getNavigatorOrThrow=Me.getDocument=Me.getDocumentOrThrow=Me.getFromWindowOrThrow=Me.getFromWindow=void 0;function bi(o){let t;return typeof window<"u"&&typeof window[o]<"u"&&(t=window[o]),t}Me.getFromWindow=bi;function Ki(o){const t=bi(o);if(!t)throw new Error(`${o} is not defined in Window`);return t}Me.getFromWindowOrThrow=Ki;function YS(){return Ki("document")}Me.getDocumentOrThrow=YS;function XS(){return bi("document")}Me.getDocument=XS;function ZS(){return Ki("navigator")}Me.getNavigatorOrThrow=ZS;function eI(){return bi("navigator")}Me.getNavigator=eI;function tI(){return Ki("location")}Me.getLocationOrThrow=tI;function rI(){return bi("location")}Me.getLocation=rI;function iI(){return Ki("crypto")}Me.getCryptoOrThrow=iI;function nI(){return bi("crypto")}Me.getCrypto=nI;function sI(){return Ki("localStorage")}Me.getLocalStorageOrThrow=sI;function oI(){return bi("localStorage")}Me.getLocalStorage=oI;var Va={};Object.defineProperty(Va,"__esModule",{value:!0});Va.getWindowMetadata=void 0;const Oh=Me;function aI(){let o,t;try{o=Oh.getDocumentOrThrow(),t=Oh.getLocationOrThrow()}catch{return null}function r(){const U=o.getElementsByTagName("link"),K=[];for(let J=0;J<U.length;J++){const H=U[J],X=H.getAttribute("rel");if(X&&X.toLowerCase().indexOf("icon")>-1){const G=H.getAttribute("href");if(G)if(G.toLowerCase().indexOf("https:")===-1&&G.toLowerCase().indexOf("http:")===-1&&G.indexOf("//")!==0){let oe=t.protocol+"//"+t.host;if(G.indexOf("/")===0)oe+=G;else{const f=t.pathname.split("/");f.pop();const y=f.join("/");oe+=y+"/"+G}K.push(oe)}else if(G.indexOf("//")===0){const oe=t.protocol+G;K.push(oe)}else K.push(G)}}return K}function n(...U){const K=o.getElementsByTagName("meta");for(let J=0;J<K.length;J++){const H=K[J],X=["itemprop","property","name"].map(G=>H.getAttribute(G)).filter(G=>G?U.includes(G):!1);if(X.length&&X){const G=H.getAttribute("content");if(G)return G}}return""}function a(){let U=n("name","og:site_name","og:title","twitter:title");return U||(U=o.title),U}function l(){return n("description","og:description","twitter:description","keywords")}const g=a(),O=l(),N=t.origin,F=r();return{description:O,url:N,icons:F,name:g}}Va.getWindowMetadata=aI;var cI={};(function(o){const t=Oa,r=xa,n=Sa,a=Ia,l=f=>f==null,g=Symbol("encodeFragmentIdentifier");function O(f){switch(f.arrayFormat){case"index":return y=>(E,b)=>{const m=E.length;return b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,[C(y,f),"[",m,"]"].join("")]:[...E,[C(y,f),"[",C(m,f),"]=",C(b,f)].join("")]};case"bracket":return y=>(E,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,[C(y,f),"[]"].join("")]:[...E,[C(y,f),"[]=",C(b,f)].join("")];case"colon-list-separator":return y=>(E,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,[C(y,f),":list="].join("")]:[...E,[C(y,f),":list=",C(b,f)].join("")];case"comma":case"separator":case"bracket-separator":{const y=f.arrayFormat==="bracket-separator"?"[]=":"=";return E=>(b,m)=>m===void 0||f.skipNull&&m===null||f.skipEmptyString&&m===""?b:(m=m===null?"":m,b.length===0?[[C(E,f),y,C(m,f)].join("")]:[[b,C(m,f)].join(f.arrayFormatSeparator)])}default:return y=>(E,b)=>b===void 0||f.skipNull&&b===null||f.skipEmptyString&&b===""?E:b===null?[...E,C(y,f)]:[...E,[C(y,f),"=",C(b,f)].join("")]}}function N(f){let y;switch(f.arrayFormat){case"index":return(E,b,m)=>{if(y=/\[(\d*)\]$/.exec(E),E=E.replace(/\[\d*\]$/,""),!y){m[E]=b;return}m[E]===void 0&&(m[E]={}),m[E][y[1]]=b};case"bracket":return(E,b,m)=>{if(y=/(\[\])$/.exec(E),E=E.replace(/\[\]$/,""),!y){m[E]=b;return}if(m[E]===void 0){m[E]=[b];return}m[E]=[].concat(m[E],b)};case"colon-list-separator":return(E,b,m)=>{if(y=/(:list)$/.exec(E),E=E.replace(/:list$/,""),!y){m[E]=b;return}if(m[E]===void 0){m[E]=[b];return}m[E]=[].concat(m[E],b)};case"comma":case"separator":return(E,b,m)=>{const $=typeof b=="string"&&b.includes(f.arrayFormatSeparator),x=typeof b=="string"&&!$&&U(b,f).includes(f.arrayFormatSeparator);b=x?U(b,f):b;const re=$||x?b.split(f.arrayFormatSeparator).map(d=>U(d,f)):b===null?b:U(b,f);m[E]=re};case"bracket-separator":return(E,b,m)=>{const $=/(\[\])$/.test(E);if(E=E.replace(/\[\]$/,""),!$){m[E]=b&&U(b,f);return}const x=b===null?[]:b.split(f.arrayFormatSeparator).map(re=>U(re,f));if(m[E]===void 0){m[E]=x;return}m[E]=[].concat(m[E],x)};default:return(E,b,m)=>{if(m[E]===void 0){m[E]=b;return}m[E]=[].concat(m[E],b)}}}function F(f){if(typeof f!="string"||f.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function C(f,y){return y.encode?y.strict?t(f):encodeURIComponent(f):f}function U(f,y){return y.decode?r(f):f}function K(f){return Array.isArray(f)?f.sort():typeof f=="object"?K(Object.keys(f)).sort((y,E)=>Number(y)-Number(E)).map(y=>f[y]):f}function J(f){const y=f.indexOf("#");return y!==-1&&(f=f.slice(0,y)),f}function H(f){let y="";const E=f.indexOf("#");return E!==-1&&(y=f.slice(E)),y}function X(f){f=J(f);const y=f.indexOf("?");return y===-1?"":f.slice(y+1)}function G(f,y){return y.parseNumbers&&!Number.isNaN(Number(f))&&typeof f=="string"&&f.trim()!==""?f=Number(f):y.parseBooleans&&f!==null&&(f.toLowerCase()==="true"||f.toLowerCase()==="false")&&(f=f.toLowerCase()==="true"),f}function oe(f,y){y=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},y),F(y.arrayFormatSeparator);const E=N(y),b=Object.create(null);if(typeof f!="string"||(f=f.trim().replace(/^[?#&]/,""),!f))return b;for(const m of f.split("&")){if(m==="")continue;let[$,x]=n(y.decode?m.replace(/\+/g," "):m,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(y.arrayFormat)?x:U(x,y),E(U($,y),x,b)}for(const m of Object.keys(b)){const $=b[m];if(typeof $=="object"&&$!==null)for(const x of Object.keys($))$[x]=G($[x],y);else b[m]=G($,y)}return y.sort===!1?b:(y.sort===!0?Object.keys(b).sort():Object.keys(b).sort(y.sort)).reduce((m,$)=>{const x=b[$];return x&&typeof x=="object"&&!Array.isArray(x)?m[$]=K(x):m[$]=x,m},Object.create(null))}o.extract=X,o.parse=oe,o.stringify=(f,y)=>{if(!f)return"";y=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},y),F(y.arrayFormatSeparator);const E=x=>y.skipNull&&l(f[x])||y.skipEmptyString&&f[x]==="",b=O(y),m={};for(const x of Object.keys(f))E(x)||(m[x]=f[x]);const $=Object.keys(m);return y.sort!==!1&&$.sort(y.sort),$.map(x=>{const re=f[x];return re===void 0?"":re===null?C(x,y):Array.isArray(re)?re.length===0&&y.arrayFormat==="bracket-separator"?C(x,y)+"[]":re.reduce(b(x),[]).join("&"):C(x,y)+"="+C(re,y)}).filter(x=>x.length>0).join("&")},o.parseUrl=(f,y)=>{y=Object.assign({decode:!0},y);const[E,b]=n(f,"#");return Object.assign({url:E.split("?")[0]||"",query:oe(X(f),y)},y&&y.parseFragmentIdentifier&&b?{fragmentIdentifier:U(b,y)}:{})},o.stringifyUrl=(f,y)=>{y=Object.assign({encode:!0,strict:!0,[g]:!0},y);const E=J(f.url).split("?")[0]||"",b=o.extract(f.url),m=o.parse(b,{sort:!1}),$=Object.assign(m,f.query);let x=o.stringify($,y);x&&(x=`?${x}`);let re=H(f.url);return f.fragmentIdentifier&&(re=`#${y[g]?C(f.fragmentIdentifier,y):f.fragmentIdentifier}`),`${E}${x}${re}`},o.pick=(f,y,E)=>{E=Object.assign({parseFragmentIdentifier:!0,[g]:!1},E);const{url:b,query:m,fragmentIdentifier:$}=o.parseUrl(f,E);return o.stringifyUrl({url:b,query:a(m,y),fragmentIdentifier:$},E)},o.exclude=(f,y,E)=>{const b=Array.isArray(y)?m=>!y.includes(m):(m,$)=>!y(m,$);return o.pick(f,b,E)}})(cI);const uI=":";function lI(o){const[t,r]=o.split(uI);return{namespace:t,reference:r}}function aa(o=[],t=[]){return[...new Set([...o,...t])]}function Ba(o){return o.includes(":")}function En(o){return Ba(o)?o.split(":")[0]:o}const hI={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function xh(o,t){const{message:r,code:n}=hI[o];return{message:t?`${r} ${t}`:r,code:n}}function Ph(o,t){return Array.isArray(o)?typeof t<"u"&&o.length?o.every(t):!0:!1}function fI(o){return Object.getPrototypeOf(o)===Object.prototype&&Object.keys(o).length}const Nh="error",dI="wss://relay.walletconnect.com",pI="wc",gI="universal_provider",Th=`${pI}@2:${gI}:`,yI="https://rpc.walletconnect.com/v1/",ri={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var wn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},wa={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(o,t){(function(){var r,n="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",g="Expected a function",O="Invalid `variable` option passed into `_.template`",N="__lodash_hash_undefined__",F=500,C="__lodash_placeholder__",U=1,K=2,J=4,H=1,X=2,G=1,oe=2,f=4,y=8,E=16,b=32,m=64,$=128,x=256,re=512,d=30,S="...",I=800,A=16,w=1,_=2,k=3,ee=1/0,te=9007199254740991,D=17976931348623157e292,z=0/0,ie=4294967295,ae=ie-1,ge=ie>>>1,et=[["ary",$],["bind",G],["bindKey",oe],["curry",y],["curryRight",E],["flip",re],["partial",b],["partialRight",m],["rearg",x]],nt="[object Arguments]",Nt="[object Array]",V="[object AsyncFunction]",B="[object Boolean]",q="[object Date]",u="[object DOMException]",R="[object Error]",he="[object Function]",me="[object GeneratorFunction]",Ee="[object Map]",Te="[object Number]",Ae="[object Null]",Pe="[object Object]",lt="[object Promise]",st="[object Proxy]",Je="[object RegExp]",$e="[object Set]",He="[object String]",Ve="[object Symbol]",Qe="[object Undefined]",je="[object WeakMap]",Be="[object WeakSet]",Fe="[object ArrayBuffer]",Ke="[object DataView]",ot="[object Float32Array]",ht="[object Float64Array]",Tt="[object Int8Array]",$t="[object Int16Array]",Ut="[object Int32Array]",Bt="[object Uint8Array]",Zt="[object Uint8ClampedArray]",ar="[object Uint16Array]",mr="[object Uint32Array]",zr=/\b__p \+= '';/g,ii=/\b(__p \+=) '' \+/g,Si=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ii=/&(?:amp|lt|gt|quot|#39);/g,Gi=/[&<>"']/g,ft=RegExp(Ii.source),dt=RegExp(Gi.source),pt=/<%-([\s\S]+?)%>/g,gt=/<%([\s\S]+?)%>/g,at=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mt=/^\w*$/,vt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tt=/[\\^$.*+?()[\]{}|]/g,_t=RegExp(tt.source),rt=/^\s+/,wt=/\s/,bt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Et=/\{\n\/\* \[wrapped with (.+)\] \*/,St=/,? & /,It=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ff=/[()=,{}\[\]\/\s]/,Df=/\\(\\)?/g,jf=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ga=/\w*$/,Uf=/^[-+]0x[0-9a-f]+$/i,Lf=/^0b[01]+$/i,qf=/^\[object .+?Constructor\]$/,Mf=/^0o[0-7]+$/i,kf=/^(?:0|[1-9]\d*)$/,zf=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Fn=/($^)/,Hf=/['\n\r\u2028\u2029\\]/g,Dn="\\ud800-\\udfff",Vf="\\u0300-\\u036f",Bf="\\ufe20-\\ufe2f",Kf="\\u20d0-\\u20ff",Ja=Vf+Bf+Kf,Qa="\\u2700-\\u27bf",Ya="a-z\\xdf-\\xf6\\xf8-\\xff",Wf="\\xac\\xb1\\xd7\\xf7",Gf="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Jf="\\u2000-\\u206f",Qf=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Xa="A-Z\\xc0-\\xd6\\xd8-\\xde",Za="\\ufe0e\\ufe0f",ec=Wf+Gf+Jf+Qf,qs="[']",Yf="["+Dn+"]",tc="["+ec+"]",jn="["+Ja+"]",rc="\\d+",Xf="["+Qa+"]",ic="["+Ya+"]",nc="[^"+Dn+ec+rc+Qa+Ya+Xa+"]",Ms="\\ud83c[\\udffb-\\udfff]",Zf="(?:"+jn+"|"+Ms+")",sc="[^"+Dn+"]",ks="(?:\\ud83c[\\udde6-\\uddff]){2}",zs="[\\ud800-\\udbff][\\udc00-\\udfff]",Oi="["+Xa+"]",oc="\\u200d",ac="(?:"+ic+"|"+nc+")",ed="(?:"+Oi+"|"+nc+")",cc="(?:"+qs+"(?:d|ll|m|re|s|t|ve))?",uc="(?:"+qs+"(?:D|LL|M|RE|S|T|VE))?",lc=Zf+"?",hc="["+Za+"]?",td="(?:"+oc+"(?:"+[sc,ks,zs].join("|")+")"+hc+lc+")*",rd="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",id="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",fc=hc+lc+td,nd="(?:"+[Xf,ks,zs].join("|")+")"+fc,sd="(?:"+[sc+jn+"?",jn,ks,zs,Yf].join("|")+")",od=RegExp(qs,"g"),ad=RegExp(jn,"g"),Hs=RegExp(Ms+"(?="+Ms+")|"+sd+fc,"g"),cd=RegExp([Oi+"?"+ic+"+"+cc+"(?="+[tc,Oi,"$"].join("|")+")",ed+"+"+uc+"(?="+[tc,Oi+ac,"$"].join("|")+")",Oi+"?"+ac+"+"+cc,Oi+"+"+uc,id,rd,rc,nd].join("|"),"g"),ud=RegExp("["+oc+Dn+Ja+Za+"]"),ld=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,hd=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],fd=-1,ke={};ke[ot]=ke[ht]=ke[Tt]=ke[$t]=ke[Ut]=ke[Bt]=ke[Zt]=ke[ar]=ke[mr]=!0,ke[nt]=ke[Nt]=ke[Fe]=ke[B]=ke[Ke]=ke[q]=ke[R]=ke[he]=ke[Ee]=ke[Te]=ke[Pe]=ke[Je]=ke[$e]=ke[He]=ke[je]=!1;var Ue={};Ue[nt]=Ue[Nt]=Ue[Fe]=Ue[Ke]=Ue[B]=Ue[q]=Ue[ot]=Ue[ht]=Ue[Tt]=Ue[$t]=Ue[Ut]=Ue[Ee]=Ue[Te]=Ue[Pe]=Ue[Je]=Ue[$e]=Ue[He]=Ue[Ve]=Ue[Bt]=Ue[Zt]=Ue[ar]=Ue[mr]=!0,Ue[R]=Ue[he]=Ue[je]=!1;var dd={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},pd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},gd={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},yd={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},md=parseFloat,vd=parseInt,dc=typeof wn=="object"&&wn&&wn.Object===Object&&wn,_d=typeof self=="object"&&self&&self.Object===Object&&self,Ct=dc||_d||Function("return this")(),Vs=t&&!t.nodeType&&t,ni=Vs&&!0&&o&&!o.nodeType&&o,pc=ni&&ni.exports===Vs,Bs=pc&&dc.process,cr=function(){try{var j=ni&&ni.require&&ni.require("util").types;return j||Bs&&Bs.binding&&Bs.binding("util")}catch{}}(),gc=cr&&cr.isArrayBuffer,yc=cr&&cr.isDate,mc=cr&&cr.isMap,vc=cr&&cr.isRegExp,_c=cr&&cr.isSet,wc=cr&&cr.isTypedArray;function er(j,W,M){switch(M.length){case 0:return j.call(W);case 1:return j.call(W,M[0]);case 2:return j.call(W,M[0],M[1]);case 3:return j.call(W,M[0],M[1],M[2])}return j.apply(W,M)}function wd(j,W,M,ce){for(var ye=-1,Ne=j==null?0:j.length;++ye<Ne;){var ct=j[ye];W(ce,ct,M(ct),j)}return ce}function ur(j,W){for(var M=-1,ce=j==null?0:j.length;++M<ce&&W(j[M],M,j)!==!1;);return j}function bd(j,W){for(var M=j==null?0:j.length;M--&&W(j[M],M,j)!==!1;);return j}function bc(j,W){for(var M=-1,ce=j==null?0:j.length;++M<ce;)if(!W(j[M],M,j))return!1;return!0}function Hr(j,W){for(var M=-1,ce=j==null?0:j.length,ye=0,Ne=[];++M<ce;){var ct=j[M];W(ct,M,j)&&(Ne[ye++]=ct)}return Ne}function Un(j,W){var M=j==null?0:j.length;return!!M&&xi(j,W,0)>-1}function Ks(j,W,M){for(var ce=-1,ye=j==null?0:j.length;++ce<ye;)if(M(W,j[ce]))return!0;return!1}function ze(j,W){for(var M=-1,ce=j==null?0:j.length,ye=Array(ce);++M<ce;)ye[M]=W(j[M],M,j);return ye}function Vr(j,W){for(var M=-1,ce=W.length,ye=j.length;++M<ce;)j[ye+M]=W[M];return j}function Ws(j,W,M,ce){var ye=-1,Ne=j==null?0:j.length;for(ce&&Ne&&(M=j[++ye]);++ye<Ne;)M=W(M,j[ye],ye,j);return M}function Ed(j,W,M,ce){var ye=j==null?0:j.length;for(ce&&ye&&(M=j[--ye]);ye--;)M=W(M,j[ye],ye,j);return M}function Gs(j,W){for(var M=-1,ce=j==null?0:j.length;++M<ce;)if(W(j[M],M,j))return!0;return!1}var Sd=Js("length");function Id(j){return j.split("")}function Od(j){return j.match(It)||[]}function Ec(j,W,M){var ce;return M(j,function(ye,Ne,ct){if(W(ye,Ne,ct))return ce=Ne,!1}),ce}function Ln(j,W,M,ce){for(var ye=j.length,Ne=M+(ce?1:-1);ce?Ne--:++Ne<ye;)if(W(j[Ne],Ne,j))return Ne;return-1}function xi(j,W,M){return W===W?Ud(j,W,M):Ln(j,Sc,M)}function xd(j,W,M,ce){for(var ye=M-1,Ne=j.length;++ye<Ne;)if(ce(j[ye],W))return ye;return-1}function Sc(j){return j!==j}function Ic(j,W){var M=j==null?0:j.length;return M?Ys(j,W)/M:z}function Js(j){return function(W){return W==null?r:W[j]}}function Qs(j){return function(W){return j==null?r:j[W]}}function Oc(j,W,M,ce,ye){return ye(j,function(Ne,ct,De){M=ce?(ce=!1,Ne):W(M,Ne,ct,De)}),M}function Pd(j,W){var M=j.length;for(j.sort(W);M--;)j[M]=j[M].value;return j}function Ys(j,W){for(var M,ce=-1,ye=j.length;++ce<ye;){var Ne=W(j[ce]);Ne!==r&&(M=M===r?Ne:M+Ne)}return M}function Xs(j,W){for(var M=-1,ce=Array(j);++M<j;)ce[M]=W(M);return ce}function Nd(j,W){return ze(W,function(M){return[M,j[M]]})}function xc(j){return j&&j.slice(0,Cc(j)+1).replace(rt,"")}function tr(j){return function(W){return j(W)}}function Zs(j,W){return ze(W,function(M){return j[M]})}function Ji(j,W){return j.has(W)}function Pc(j,W){for(var M=-1,ce=j.length;++M<ce&&xi(W,j[M],0)>-1;);return M}function Nc(j,W){for(var M=j.length;M--&&xi(W,j[M],0)>-1;);return M}function Td(j,W){for(var M=j.length,ce=0;M--;)j[M]===W&&++ce;return ce}var Cd=Qs(dd),Ad=Qs(pd);function Rd(j){return"\\"+yd[j]}function $d(j,W){return j==null?r:j[W]}function Pi(j){return ud.test(j)}function Fd(j){return ld.test(j)}function Dd(j){for(var W,M=[];!(W=j.next()).done;)M.push(W.value);return M}function eo(j){var W=-1,M=Array(j.size);return j.forEach(function(ce,ye){M[++W]=[ye,ce]}),M}function Tc(j,W){return function(M){return j(W(M))}}function Br(j,W){for(var M=-1,ce=j.length,ye=0,Ne=[];++M<ce;){var ct=j[M];(ct===W||ct===C)&&(j[M]=C,Ne[ye++]=M)}return Ne}function qn(j){var W=-1,M=Array(j.size);return j.forEach(function(ce){M[++W]=ce}),M}function jd(j){var W=-1,M=Array(j.size);return j.forEach(function(ce){M[++W]=[ce,ce]}),M}function Ud(j,W,M){for(var ce=M-1,ye=j.length;++ce<ye;)if(j[ce]===W)return ce;return-1}function Ld(j,W,M){for(var ce=M+1;ce--;)if(j[ce]===W)return ce;return ce}function Ni(j){return Pi(j)?Md(j):Sd(j)}function vr(j){return Pi(j)?kd(j):Id(j)}function Cc(j){for(var W=j.length;W--&&wt.test(j.charAt(W)););return W}var qd=Qs(gd);function Md(j){for(var W=Hs.lastIndex=0;Hs.test(j);)++W;return W}function kd(j){return j.match(Hs)||[]}function zd(j){return j.match(cd)||[]}var Hd=function j(W){W=W==null?Ct:Ti.defaults(Ct.Object(),W,Ti.pick(Ct,hd));var M=W.Array,ce=W.Date,ye=W.Error,Ne=W.Function,ct=W.Math,De=W.Object,to=W.RegExp,Vd=W.String,lr=W.TypeError,Mn=M.prototype,Bd=Ne.prototype,Ci=De.prototype,kn=W["__core-js_shared__"],zn=Bd.toString,Re=Ci.hasOwnProperty,Kd=0,Ac=function(){var e=/[^.]+$/.exec(kn&&kn.keys&&kn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Hn=Ci.toString,Wd=zn.call(De),Gd=Ct._,Jd=to("^"+zn.call(Re).replace(tt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vn=pc?W.Buffer:r,Kr=W.Symbol,Bn=W.Uint8Array,Rc=Vn?Vn.allocUnsafe:r,Kn=Tc(De.getPrototypeOf,De),$c=De.create,Fc=Ci.propertyIsEnumerable,Wn=Mn.splice,Dc=Kr?Kr.isConcatSpreadable:r,Qi=Kr?Kr.iterator:r,si=Kr?Kr.toStringTag:r,Gn=function(){try{var e=li(De,"defineProperty");return e({},"",{}),e}catch{}}(),Qd=W.clearTimeout!==Ct.clearTimeout&&W.clearTimeout,Yd=ce&&ce.now!==Ct.Date.now&&ce.now,Xd=W.setTimeout!==Ct.setTimeout&&W.setTimeout,Jn=ct.ceil,Qn=ct.floor,ro=De.getOwnPropertySymbols,Zd=Vn?Vn.isBuffer:r,jc=W.isFinite,ep=Mn.join,tp=Tc(De.keys,De),ut=ct.max,Ft=ct.min,rp=ce.now,ip=W.parseInt,Uc=ct.random,np=Mn.reverse,io=li(W,"DataView"),Yi=li(W,"Map"),no=li(W,"Promise"),Ai=li(W,"Set"),Xi=li(W,"WeakMap"),Zi=li(De,"create"),Yn=Xi&&new Xi,Ri={},sp=hi(io),op=hi(Yi),ap=hi(no),cp=hi(Ai),up=hi(Xi),Xn=Kr?Kr.prototype:r,en=Xn?Xn.valueOf:r,Lc=Xn?Xn.toString:r;function p(e){if(Ge(e)&&!ve(e)&&!(e instanceof Ie)){if(e instanceof hr)return e;if(Re.call(e,"__wrapped__"))return qu(e)}return new hr(e)}var $i=function(){function e(){}return function(i){if(!We(i))return{};if($c)return $c(i);e.prototype=i;var s=new e;return e.prototype=r,s}}();function Zn(){}function hr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}p.templateSettings={escape:pt,evaluate:gt,interpolate:at,variable:"",imports:{_:p}},p.prototype=Zn.prototype,p.prototype.constructor=p,hr.prototype=$i(Zn.prototype),hr.prototype.constructor=hr;function Ie(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ie,this.__views__=[]}function lp(){var e=new Ie(this.__wrapped__);return e.__actions__=Kt(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Kt(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Kt(this.__views__),e}function hp(){if(this.__filtered__){var e=new Ie(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function fp(){var e=this.__wrapped__.value(),i=this.__dir__,s=ve(e),c=i<0,h=s?e.length:0,v=Ig(0,h,this.__views__),P=v.start,T=v.end,L=T-P,Q=c?T:P-1,Y=this.__iteratees__,Z=Y.length,ne=0,ue=Ft(L,this.__takeCount__);if(!s||!c&&h==L&&ue==L)return cu(e,this.__actions__);var de=[];e:for(;L--&&ne<ue;){Q+=i;for(var we=-1,pe=e[Q];++we<Z;){var Se=Y[we],Oe=Se.iteratee,nr=Se.type,Mt=Oe(pe);if(nr==_)pe=Mt;else if(!Mt){if(nr==w)continue e;break e}}de[ne++]=pe}return de}Ie.prototype=$i(Zn.prototype),Ie.prototype.constructor=Ie;function oi(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var c=e[i];this.set(c[0],c[1])}}function dp(){this.__data__=Zi?Zi(null):{},this.size=0}function pp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function gp(e){var i=this.__data__;if(Zi){var s=i[e];return s===N?r:s}return Re.call(i,e)?i[e]:r}function yp(e){var i=this.__data__;return Zi?i[e]!==r:Re.call(i,e)}function mp(e,i){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Zi&&i===r?N:i,this}oi.prototype.clear=dp,oi.prototype.delete=pp,oi.prototype.get=gp,oi.prototype.has=yp,oi.prototype.set=mp;function Tr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var c=e[i];this.set(c[0],c[1])}}function vp(){this.__data__=[],this.size=0}function _p(e){var i=this.__data__,s=es(i,e);if(s<0)return!1;var c=i.length-1;return s==c?i.pop():Wn.call(i,s,1),--this.size,!0}function wp(e){var i=this.__data__,s=es(i,e);return s<0?r:i[s][1]}function bp(e){return es(this.__data__,e)>-1}function Ep(e,i){var s=this.__data__,c=es(s,e);return c<0?(++this.size,s.push([e,i])):s[c][1]=i,this}Tr.prototype.clear=vp,Tr.prototype.delete=_p,Tr.prototype.get=wp,Tr.prototype.has=bp,Tr.prototype.set=Ep;function Cr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var c=e[i];this.set(c[0],c[1])}}function Sp(){this.size=0,this.__data__={hash:new oi,map:new(Yi||Tr),string:new oi}}function Ip(e){var i=fs(this,e).delete(e);return this.size-=i?1:0,i}function Op(e){return fs(this,e).get(e)}function xp(e){return fs(this,e).has(e)}function Pp(e,i){var s=fs(this,e),c=s.size;return s.set(e,i),this.size+=s.size==c?0:1,this}Cr.prototype.clear=Sp,Cr.prototype.delete=Ip,Cr.prototype.get=Op,Cr.prototype.has=xp,Cr.prototype.set=Pp;function ai(e){var i=-1,s=e==null?0:e.length;for(this.__data__=new Cr;++i<s;)this.add(e[i])}function Np(e){return this.__data__.set(e,N),this}function Tp(e){return this.__data__.has(e)}ai.prototype.add=ai.prototype.push=Np,ai.prototype.has=Tp;function _r(e){var i=this.__data__=new Tr(e);this.size=i.size}function Cp(){this.__data__=new Tr,this.size=0}function Ap(e){var i=this.__data__,s=i.delete(e);return this.size=i.size,s}function Rp(e){return this.__data__.get(e)}function $p(e){return this.__data__.has(e)}function Fp(e,i){var s=this.__data__;if(s instanceof Tr){var c=s.__data__;if(!Yi||c.length<a-1)return c.push([e,i]),this.size=++s.size,this;s=this.__data__=new Cr(c)}return s.set(e,i),this.size=s.size,this}_r.prototype.clear=Cp,_r.prototype.delete=Ap,_r.prototype.get=Rp,_r.prototype.has=$p,_r.prototype.set=Fp;function qc(e,i){var s=ve(e),c=!s&&fi(e),h=!s&&!c&&Yr(e),v=!s&&!c&&!h&&Ui(e),P=s||c||h||v,T=P?Xs(e.length,Vd):[],L=T.length;for(var Q in e)(i||Re.call(e,Q))&&!(P&&(Q=="length"||h&&(Q=="offset"||Q=="parent")||v&&(Q=="buffer"||Q=="byteLength"||Q=="byteOffset")||Fr(Q,L)))&&T.push(Q);return T}function Mc(e){var i=e.length;return i?e[yo(0,i-1)]:r}function Dp(e,i){return ds(Kt(e),ci(i,0,e.length))}function jp(e){return ds(Kt(e))}function so(e,i,s){(s!==r&&!wr(e[i],s)||s===r&&!(i in e))&&Ar(e,i,s)}function tn(e,i,s){var c=e[i];(!(Re.call(e,i)&&wr(c,s))||s===r&&!(i in e))&&Ar(e,i,s)}function es(e,i){for(var s=e.length;s--;)if(wr(e[s][0],i))return s;return-1}function Up(e,i,s,c){return Wr(e,function(h,v,P){i(c,h,s(h),P)}),c}function kc(e,i){return e&&Ir(i,Ot(i),e)}function Lp(e,i){return e&&Ir(i,Gt(i),e)}function Ar(e,i,s){i=="__proto__"&&Gn?Gn(e,i,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[i]=s}function oo(e,i){for(var s=-1,c=i.length,h=M(c),v=e==null;++s<c;)h[s]=v?r:ko(e,i[s]);return h}function ci(e,i,s){return e===e&&(s!==r&&(e=e<=s?e:s),i!==r&&(e=e>=i?e:i)),e}function fr(e,i,s,c,h,v){var P,T=i&U,L=i&K,Q=i&J;if(s&&(P=h?s(e,c,h,v):s(e)),P!==r)return P;if(!We(e))return e;var Y=ve(e);if(Y){if(P=xg(e),!T)return Kt(e,P)}else{var Z=Dt(e),ne=Z==he||Z==me;if(Yr(e))return hu(e,T);if(Z==Pe||Z==nt||ne&&!h){if(P=L||ne?{}:Cu(e),!T)return L?gg(e,Lp(P,e)):pg(e,kc(P,e))}else{if(!Ue[Z])return h?e:{};P=Pg(e,Z,T)}}v||(v=new _r);var ue=v.get(e);if(ue)return ue;v.set(e,P),sl(e)?e.forEach(function(pe){P.add(fr(pe,i,s,pe,e,v))}):il(e)&&e.forEach(function(pe,Se){P.set(Se,fr(pe,i,s,Se,e,v))});var de=Q?L?Po:xo:L?Gt:Ot,we=Y?r:de(e);return ur(we||e,function(pe,Se){we&&(Se=pe,pe=e[Se]),tn(P,Se,fr(pe,i,s,Se,e,v))}),P}function qp(e){var i=Ot(e);return function(s){return zc(s,e,i)}}function zc(e,i,s){var c=s.length;if(e==null)return!c;for(e=De(e);c--;){var h=s[c],v=i[h],P=e[h];if(P===r&&!(h in e)||!v(P))return!1}return!0}function Hc(e,i,s){if(typeof e!="function")throw new lr(g);return un(function(){e.apply(r,s)},i)}function rn(e,i,s,c){var h=-1,v=Un,P=!0,T=e.length,L=[],Q=i.length;if(!T)return L;s&&(i=ze(i,tr(s))),c?(v=Ks,P=!1):i.length>=a&&(v=Ji,P=!1,i=new ai(i));e:for(;++h<T;){var Y=e[h],Z=s==null?Y:s(Y);if(Y=c||Y!==0?Y:0,P&&Z===Z){for(var ne=Q;ne--;)if(i[ne]===Z)continue e;L.push(Y)}else v(i,Z,c)||L.push(Y)}return L}var Wr=yu(Sr),Vc=yu(co,!0);function Mp(e,i){var s=!0;return Wr(e,function(c,h,v){return s=!!i(c,h,v),s}),s}function ts(e,i,s){for(var c=-1,h=e.length;++c<h;){var v=e[c],P=i(v);if(P!=null&&(T===r?P===P&&!ir(P):s(P,T)))var T=P,L=v}return L}function kp(e,i,s,c){var h=e.length;for(s=_e(s),s<0&&(s=-s>h?0:h+s),c=c===r||c>h?h:_e(c),c<0&&(c+=h),c=s>c?0:al(c);s<c;)e[s++]=i;return e}function Bc(e,i){var s=[];return Wr(e,function(c,h,v){i(c,h,v)&&s.push(c)}),s}function At(e,i,s,c,h){var v=-1,P=e.length;for(s||(s=Tg),h||(h=[]);++v<P;){var T=e[v];i>0&&s(T)?i>1?At(T,i-1,s,c,h):Vr(h,T):c||(h[h.length]=T)}return h}var ao=mu(),Kc=mu(!0);function Sr(e,i){return e&&ao(e,i,Ot)}function co(e,i){return e&&Kc(e,i,Ot)}function rs(e,i){return Hr(i,function(s){return Dr(e[s])})}function ui(e,i){i=Jr(i,e);for(var s=0,c=i.length;e!=null&&s<c;)e=e[Or(i[s++])];return s&&s==c?e:r}function Wc(e,i,s){var c=i(e);return ve(e)?c:Vr(c,s(e))}function Lt(e){return e==null?e===r?Qe:Ae:si&&si in De(e)?Sg(e):jg(e)}function uo(e,i){return e>i}function zp(e,i){return e!=null&&Re.call(e,i)}function Hp(e,i){return e!=null&&i in De(e)}function Vp(e,i,s){return e>=Ft(i,s)&&e<ut(i,s)}function lo(e,i,s){for(var c=s?Ks:Un,h=e[0].length,v=e.length,P=v,T=M(v),L=1/0,Q=[];P--;){var Y=e[P];P&&i&&(Y=ze(Y,tr(i))),L=Ft(Y.length,L),T[P]=!s&&(i||h>=120&&Y.length>=120)?new ai(P&&Y):r}Y=e[0];var Z=-1,ne=T[0];e:for(;++Z<h&&Q.length<L;){var ue=Y[Z],de=i?i(ue):ue;if(ue=s||ue!==0?ue:0,!(ne?Ji(ne,de):c(Q,de,s))){for(P=v;--P;){var we=T[P];if(!(we?Ji(we,de):c(e[P],de,s)))continue e}ne&&ne.push(de),Q.push(ue)}}return Q}function Bp(e,i,s,c){return Sr(e,function(h,v,P){i(c,s(h),v,P)}),c}function nn(e,i,s){i=Jr(i,e),e=Fu(e,i);var c=e==null?e:e[Or(pr(i))];return c==null?r:er(c,e,s)}function Gc(e){return Ge(e)&&Lt(e)==nt}function Kp(e){return Ge(e)&&Lt(e)==Fe}function Wp(e){return Ge(e)&&Lt(e)==q}function sn(e,i,s,c,h){return e===i?!0:e==null||i==null||!Ge(e)&&!Ge(i)?e!==e&&i!==i:Gp(e,i,s,c,sn,h)}function Gp(e,i,s,c,h,v){var P=ve(e),T=ve(i),L=P?Nt:Dt(e),Q=T?Nt:Dt(i);L=L==nt?Pe:L,Q=Q==nt?Pe:Q;var Y=L==Pe,Z=Q==Pe,ne=L==Q;if(ne&&Yr(e)){if(!Yr(i))return!1;P=!0,Y=!1}if(ne&&!Y)return v||(v=new _r),P||Ui(e)?Pu(e,i,s,c,h,v):bg(e,i,L,s,c,h,v);if(!(s&H)){var ue=Y&&Re.call(e,"__wrapped__"),de=Z&&Re.call(i,"__wrapped__");if(ue||de){var we=ue?e.value():e,pe=de?i.value():i;return v||(v=new _r),h(we,pe,s,c,v)}}return ne?(v||(v=new _r),Eg(e,i,s,c,h,v)):!1}function Jp(e){return Ge(e)&&Dt(e)==Ee}function ho(e,i,s,c){var h=s.length,v=h,P=!c;if(e==null)return!v;for(e=De(e);h--;){var T=s[h];if(P&&T[2]?T[1]!==e[T[0]]:!(T[0]in e))return!1}for(;++h<v;){T=s[h];var L=T[0],Q=e[L],Y=T[1];if(P&&T[2]){if(Q===r&&!(L in e))return!1}else{var Z=new _r;if(c)var ne=c(Q,Y,L,e,i,Z);if(!(ne===r?sn(Y,Q,H|X,c,Z):ne))return!1}}return!0}function Jc(e){if(!We(e)||Ag(e))return!1;var i=Dr(e)?Jd:qf;return i.test(hi(e))}function Qp(e){return Ge(e)&&Lt(e)==Je}function Yp(e){return Ge(e)&&Dt(e)==$e}function Xp(e){return Ge(e)&&_s(e.length)&&!!ke[Lt(e)]}function Qc(e){return typeof e=="function"?e:e==null?Jt:typeof e=="object"?ve(e)?Zc(e[0],e[1]):Xc(e):vl(e)}function fo(e){if(!cn(e))return tp(e);var i=[];for(var s in De(e))Re.call(e,s)&&s!="constructor"&&i.push(s);return i}function Zp(e){if(!We(e))return Dg(e);var i=cn(e),s=[];for(var c in e)c=="constructor"&&(i||!Re.call(e,c))||s.push(c);return s}function po(e,i){return e<i}function Yc(e,i){var s=-1,c=Wt(e)?M(e.length):[];return Wr(e,function(h,v,P){c[++s]=i(h,v,P)}),c}function Xc(e){var i=To(e);return i.length==1&&i[0][2]?Ru(i[0][0],i[0][1]):function(s){return s===e||ho(s,e,i)}}function Zc(e,i){return Ao(e)&&Au(i)?Ru(Or(e),i):function(s){var c=ko(s,e);return c===r&&c===i?zo(s,e):sn(i,c,H|X)}}function is(e,i,s,c,h){e!==i&&ao(i,function(v,P){if(h||(h=new _r),We(v))eg(e,i,P,s,is,c,h);else{var T=c?c($o(e,P),v,P+"",e,i,h):r;T===r&&(T=v),so(e,P,T)}},Gt)}function eg(e,i,s,c,h,v,P){var T=$o(e,s),L=$o(i,s),Q=P.get(L);if(Q){so(e,s,Q);return}var Y=v?v(T,L,s+"",e,i,P):r,Z=Y===r;if(Z){var ne=ve(L),ue=!ne&&Yr(L),de=!ne&&!ue&&Ui(L);Y=L,ne||ue||de?ve(T)?Y=T:Ye(T)?Y=Kt(T):ue?(Z=!1,Y=hu(L,!0)):de?(Z=!1,Y=fu(L,!0)):Y=[]:ln(L)||fi(L)?(Y=T,fi(T)?Y=cl(T):(!We(T)||Dr(T))&&(Y=Cu(L))):Z=!1}Z&&(P.set(L,Y),h(Y,L,c,v,P),P.delete(L)),so(e,s,Y)}function eu(e,i){var s=e.length;if(s)return i+=i<0?s:0,Fr(i,s)?e[i]:r}function tu(e,i,s){i.length?i=ze(i,function(v){return ve(v)?function(P){return ui(P,v.length===1?v[0]:v)}:v}):i=[Jt];var c=-1;i=ze(i,tr(fe()));var h=Yc(e,function(v,P,T){var L=ze(i,function(Q){return Q(v)});return{criteria:L,index:++c,value:v}});return Pd(h,function(v,P){return dg(v,P,s)})}function tg(e,i){return ru(e,i,function(s,c){return zo(e,c)})}function ru(e,i,s){for(var c=-1,h=i.length,v={};++c<h;){var P=i[c],T=ui(e,P);s(T,P)&&on(v,Jr(P,e),T)}return v}function rg(e){return function(i){return ui(i,e)}}function go(e,i,s,c){var h=c?xd:xi,v=-1,P=i.length,T=e;for(e===i&&(i=Kt(i)),s&&(T=ze(e,tr(s)));++v<P;)for(var L=0,Q=i[v],Y=s?s(Q):Q;(L=h(T,Y,L,c))>-1;)T!==e&&Wn.call(T,L,1),Wn.call(e,L,1);return e}function iu(e,i){for(var s=e?i.length:0,c=s-1;s--;){var h=i[s];if(s==c||h!==v){var v=h;Fr(h)?Wn.call(e,h,1):_o(e,h)}}return e}function yo(e,i){return e+Qn(Uc()*(i-e+1))}function ig(e,i,s,c){for(var h=-1,v=ut(Jn((i-e)/(s||1)),0),P=M(v);v--;)P[c?v:++h]=e,e+=s;return P}function mo(e,i){var s="";if(!e||i<1||i>te)return s;do i%2&&(s+=e),i=Qn(i/2),i&&(e+=e);while(i);return s}function be(e,i){return Fo($u(e,i,Jt),e+"")}function ng(e){return Mc(Li(e))}function sg(e,i){var s=Li(e);return ds(s,ci(i,0,s.length))}function on(e,i,s,c){if(!We(e))return e;i=Jr(i,e);for(var h=-1,v=i.length,P=v-1,T=e;T!=null&&++h<v;){var L=Or(i[h]),Q=s;if(L==="__proto__"||L==="constructor"||L==="prototype")return e;if(h!=P){var Y=T[L];Q=c?c(Y,L,T):r,Q===r&&(Q=We(Y)?Y:Fr(i[h+1])?[]:{})}tn(T,L,Q),T=T[L]}return e}var nu=Yn?function(e,i){return Yn.set(e,i),e}:Jt,og=Gn?function(e,i){return Gn(e,"toString",{configurable:!0,enumerable:!1,value:Vo(i),writable:!0})}:Jt;function ag(e){return ds(Li(e))}function dr(e,i,s){var c=-1,h=e.length;i<0&&(i=-i>h?0:h+i),s=s>h?h:s,s<0&&(s+=h),h=i>s?0:s-i>>>0,i>>>=0;for(var v=M(h);++c<h;)v[c]=e[c+i];return v}function cg(e,i){var s;return Wr(e,function(c,h,v){return s=i(c,h,v),!s}),!!s}function ns(e,i,s){var c=0,h=e==null?c:e.length;if(typeof i=="number"&&i===i&&h<=ge){for(;c<h;){var v=c+h>>>1,P=e[v];P!==null&&!ir(P)&&(s?P<=i:P<i)?c=v+1:h=v}return h}return vo(e,i,Jt,s)}function vo(e,i,s,c){var h=0,v=e==null?0:e.length;if(v===0)return 0;i=s(i);for(var P=i!==i,T=i===null,L=ir(i),Q=i===r;h<v;){var Y=Qn((h+v)/2),Z=s(e[Y]),ne=Z!==r,ue=Z===null,de=Z===Z,we=ir(Z);if(P)var pe=c||de;else Q?pe=de&&(c||ne):T?pe=de&&ne&&(c||!ue):L?pe=de&&ne&&!ue&&(c||!we):ue||we?pe=!1:pe=c?Z<=i:Z<i;pe?h=Y+1:v=Y}return Ft(v,ae)}function su(e,i){for(var s=-1,c=e.length,h=0,v=[];++s<c;){var P=e[s],T=i?i(P):P;if(!s||!wr(T,L)){var L=T;v[h++]=P===0?0:P}}return v}function ou(e){return typeof e=="number"?e:ir(e)?z:+e}function rr(e){if(typeof e=="string")return e;if(ve(e))return ze(e,rr)+"";if(ir(e))return Lc?Lc.call(e):"";var i=e+"";return i=="0"&&1/e==-ee?"-0":i}function Gr(e,i,s){var c=-1,h=Un,v=e.length,P=!0,T=[],L=T;if(s)P=!1,h=Ks;else if(v>=a){var Q=i?null:_g(e);if(Q)return qn(Q);P=!1,h=Ji,L=new ai}else L=i?[]:T;e:for(;++c<v;){var Y=e[c],Z=i?i(Y):Y;if(Y=s||Y!==0?Y:0,P&&Z===Z){for(var ne=L.length;ne--;)if(L[ne]===Z)continue e;i&&L.push(Z),T.push(Y)}else h(L,Z,s)||(L!==T&&L.push(Z),T.push(Y))}return T}function _o(e,i){return i=Jr(i,e),e=Fu(e,i),e==null||delete e[Or(pr(i))]}function au(e,i,s,c){return on(e,i,s(ui(e,i)),c)}function ss(e,i,s,c){for(var h=e.length,v=c?h:-1;(c?v--:++v<h)&&i(e[v],v,e););return s?dr(e,c?0:v,c?v+1:h):dr(e,c?v+1:0,c?h:v)}function cu(e,i){var s=e;return s instanceof Ie&&(s=s.value()),Ws(i,function(c,h){return h.func.apply(h.thisArg,Vr([c],h.args))},s)}function wo(e,i,s){var c=e.length;if(c<2)return c?Gr(e[0]):[];for(var h=-1,v=M(c);++h<c;)for(var P=e[h],T=-1;++T<c;)T!=h&&(v[h]=rn(v[h]||P,e[T],i,s));return Gr(At(v,1),i,s)}function uu(e,i,s){for(var c=-1,h=e.length,v=i.length,P={};++c<h;){var T=c<v?i[c]:r;s(P,e[c],T)}return P}function bo(e){return Ye(e)?e:[]}function Eo(e){return typeof e=="function"?e:Jt}function Jr(e,i){return ve(e)?e:Ao(e,i)?[e]:Lu(Ce(e))}var ug=be;function Qr(e,i,s){var c=e.length;return s=s===r?c:s,!i&&s>=c?e:dr(e,i,s)}var lu=Qd||function(e){return Ct.clearTimeout(e)};function hu(e,i){if(i)return e.slice();var s=e.length,c=Rc?Rc(s):new e.constructor(s);return e.copy(c),c}function So(e){var i=new e.constructor(e.byteLength);return new Bn(i).set(new Bn(e)),i}function lg(e,i){var s=i?So(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function hg(e){var i=new e.constructor(e.source,Ga.exec(e));return i.lastIndex=e.lastIndex,i}function fg(e){return en?De(en.call(e)):{}}function fu(e,i){var s=i?So(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function du(e,i){if(e!==i){var s=e!==r,c=e===null,h=e===e,v=ir(e),P=i!==r,T=i===null,L=i===i,Q=ir(i);if(!T&&!Q&&!v&&e>i||v&&P&&L&&!T&&!Q||c&&P&&L||!s&&L||!h)return 1;if(!c&&!v&&!Q&&e<i||Q&&s&&h&&!c&&!v||T&&s&&h||!P&&h||!L)return-1}return 0}function dg(e,i,s){for(var c=-1,h=e.criteria,v=i.criteria,P=h.length,T=s.length;++c<P;){var L=du(h[c],v[c]);if(L){if(c>=T)return L;var Q=s[c];return L*(Q=="desc"?-1:1)}}return e.index-i.index}function pu(e,i,s,c){for(var h=-1,v=e.length,P=s.length,T=-1,L=i.length,Q=ut(v-P,0),Y=M(L+Q),Z=!c;++T<L;)Y[T]=i[T];for(;++h<P;)(Z||h<v)&&(Y[s[h]]=e[h]);for(;Q--;)Y[T++]=e[h++];return Y}function gu(e,i,s,c){for(var h=-1,v=e.length,P=-1,T=s.length,L=-1,Q=i.length,Y=ut(v-T,0),Z=M(Y+Q),ne=!c;++h<Y;)Z[h]=e[h];for(var ue=h;++L<Q;)Z[ue+L]=i[L];for(;++P<T;)(ne||h<v)&&(Z[ue+s[P]]=e[h++]);return Z}function Kt(e,i){var s=-1,c=e.length;for(i||(i=M(c));++s<c;)i[s]=e[s];return i}function Ir(e,i,s,c){var h=!s;s||(s={});for(var v=-1,P=i.length;++v<P;){var T=i[v],L=c?c(s[T],e[T],T,s,e):r;L===r&&(L=e[T]),h?Ar(s,T,L):tn(s,T,L)}return s}function pg(e,i){return Ir(e,Co(e),i)}function gg(e,i){return Ir(e,Nu(e),i)}function os(e,i){return function(s,c){var h=ve(s)?wd:Up,v=i?i():{};return h(s,e,fe(c,2),v)}}function Fi(e){return be(function(i,s){var c=-1,h=s.length,v=h>1?s[h-1]:r,P=h>2?s[2]:r;for(v=e.length>3&&typeof v=="function"?(h--,v):r,P&&qt(s[0],s[1],P)&&(v=h<3?r:v,h=1),i=De(i);++c<h;){var T=s[c];T&&e(i,T,c,v)}return i})}function yu(e,i){return function(s,c){if(s==null)return s;if(!Wt(s))return e(s,c);for(var h=s.length,v=i?h:-1,P=De(s);(i?v--:++v<h)&&c(P[v],v,P)!==!1;);return s}}function mu(e){return function(i,s,c){for(var h=-1,v=De(i),P=c(i),T=P.length;T--;){var L=P[e?T:++h];if(s(v[L],L,v)===!1)break}return i}}function yg(e,i,s){var c=i&G,h=an(e);function v(){var P=this&&this!==Ct&&this instanceof v?h:e;return P.apply(c?s:this,arguments)}return v}function vu(e){return function(i){i=Ce(i);var s=Pi(i)?vr(i):r,c=s?s[0]:i.charAt(0),h=s?Qr(s,1).join(""):i.slice(1);return c[e]()+h}}function Di(e){return function(i){return Ws(yl(gl(i).replace(od,"")),e,"")}}function an(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var s=$i(e.prototype),c=e.apply(s,i);return We(c)?c:s}}function mg(e,i,s){var c=an(e);function h(){for(var v=arguments.length,P=M(v),T=v,L=ji(h);T--;)P[T]=arguments[T];var Q=v<3&&P[0]!==L&&P[v-1]!==L?[]:Br(P,L);if(v-=Q.length,v<s)return Su(e,i,as,h.placeholder,r,P,Q,r,r,s-v);var Y=this&&this!==Ct&&this instanceof h?c:e;return er(Y,this,P)}return h}function _u(e){return function(i,s,c){var h=De(i);if(!Wt(i)){var v=fe(s,3);i=Ot(i),s=function(T){return v(h[T],T,h)}}var P=e(i,s,c);return P>-1?h[v?i[P]:P]:r}}function wu(e){return $r(function(i){var s=i.length,c=s,h=hr.prototype.thru;for(e&&i.reverse();c--;){var v=i[c];if(typeof v!="function")throw new lr(g);if(h&&!P&&hs(v)=="wrapper")var P=new hr([],!0)}for(c=P?c:s;++c<s;){v=i[c];var T=hs(v),L=T=="wrapper"?No(v):r;L&&Ro(L[0])&&L[1]==($|y|b|x)&&!L[4].length&&L[9]==1?P=P[hs(L[0])].apply(P,L[3]):P=v.length==1&&Ro(v)?P[T]():P.thru(v)}return function(){var Q=arguments,Y=Q[0];if(P&&Q.length==1&&ve(Y))return P.plant(Y).value();for(var Z=0,ne=s?i[Z].apply(this,Q):Y;++Z<s;)ne=i[Z].call(this,ne);return ne}})}function as(e,i,s,c,h,v,P,T,L,Q){var Y=i&$,Z=i&G,ne=i&oe,ue=i&(y|E),de=i&re,we=ne?r:an(e);function pe(){for(var Se=arguments.length,Oe=M(Se),nr=Se;nr--;)Oe[nr]=arguments[nr];if(ue)var Mt=ji(pe),sr=Td(Oe,Mt);if(c&&(Oe=pu(Oe,c,h,ue)),v&&(Oe=gu(Oe,v,P,ue)),Se-=sr,ue&&Se<Q){var Xe=Br(Oe,Mt);return Su(e,i,as,pe.placeholder,s,Oe,Xe,T,L,Q-Se)}var br=Z?s:this,Ur=ne?br[e]:e;return Se=Oe.length,T?Oe=Ug(Oe,T):de&&Se>1&&Oe.reverse(),Y&&L<Se&&(Oe.length=L),this&&this!==Ct&&this instanceof pe&&(Ur=we||an(Ur)),Ur.apply(br,Oe)}return pe}function bu(e,i){return function(s,c){return Bp(s,e,i(c),{})}}function cs(e,i){return function(s,c){var h;if(s===r&&c===r)return i;if(s!==r&&(h=s),c!==r){if(h===r)return c;typeof s=="string"||typeof c=="string"?(s=rr(s),c=rr(c)):(s=ou(s),c=ou(c)),h=e(s,c)}return h}}function Io(e){return $r(function(i){return i=ze(i,tr(fe())),be(function(s){var c=this;return e(i,function(h){return er(h,c,s)})})})}function us(e,i){i=i===r?" ":rr(i);var s=i.length;if(s<2)return s?mo(i,e):i;var c=mo(i,Jn(e/Ni(i)));return Pi(i)?Qr(vr(c),0,e).join(""):c.slice(0,e)}function vg(e,i,s,c){var h=i&G,v=an(e);function P(){for(var T=-1,L=arguments.length,Q=-1,Y=c.length,Z=M(Y+L),ne=this&&this!==Ct&&this instanceof P?v:e;++Q<Y;)Z[Q]=c[Q];for(;L--;)Z[Q++]=arguments[++T];return er(ne,h?s:this,Z)}return P}function Eu(e){return function(i,s,c){return c&&typeof c!="number"&&qt(i,s,c)&&(s=c=r),i=jr(i),s===r?(s=i,i=0):s=jr(s),c=c===r?i<s?1:-1:jr(c),ig(i,s,c,e)}}function ls(e){return function(i,s){return typeof i=="string"&&typeof s=="string"||(i=gr(i),s=gr(s)),e(i,s)}}function Su(e,i,s,c,h,v,P,T,L,Q){var Y=i&y,Z=Y?P:r,ne=Y?r:P,ue=Y?v:r,de=Y?r:v;i|=Y?b:m,i&=~(Y?m:b),i&f||(i&=~(G|oe));var we=[e,i,h,ue,Z,de,ne,T,L,Q],pe=s.apply(r,we);return Ro(e)&&Du(pe,we),pe.placeholder=c,ju(pe,e,i)}function Oo(e){var i=ct[e];return function(s,c){if(s=gr(s),c=c==null?0:Ft(_e(c),292),c&&jc(s)){var h=(Ce(s)+"e").split("e"),v=i(h[0]+"e"+(+h[1]+c));return h=(Ce(v)+"e").split("e"),+(h[0]+"e"+(+h[1]-c))}return i(s)}}var _g=Ai&&1/qn(new Ai([,-0]))[1]==ee?function(e){return new Ai(e)}:Wo;function Iu(e){return function(i){var s=Dt(i);return s==Ee?eo(i):s==$e?jd(i):Nd(i,e(i))}}function Rr(e,i,s,c,h,v,P,T){var L=i&oe;if(!L&&typeof e!="function")throw new lr(g);var Q=c?c.length:0;if(Q||(i&=~(b|m),c=h=r),P=P===r?P:ut(_e(P),0),T=T===r?T:_e(T),Q-=h?h.length:0,i&m){var Y=c,Z=h;c=h=r}var ne=L?r:No(e),ue=[e,i,s,c,h,Y,Z,v,P,T];if(ne&&Fg(ue,ne),e=ue[0],i=ue[1],s=ue[2],c=ue[3],h=ue[4],T=ue[9]=ue[9]===r?L?0:e.length:ut(ue[9]-Q,0),!T&&i&(y|E)&&(i&=~(y|E)),!i||i==G)var de=yg(e,i,s);else i==y||i==E?de=mg(e,i,T):(i==b||i==(G|b))&&!h.length?de=vg(e,i,s,c):de=as.apply(r,ue);var we=ne?nu:Du;return ju(we(de,ue),e,i)}function Ou(e,i,s,c){return e===r||wr(e,Ci[s])&&!Re.call(c,s)?i:e}function xu(e,i,s,c,h,v){return We(e)&&We(i)&&(v.set(i,e),is(e,i,r,xu,v),v.delete(i)),e}function wg(e){return ln(e)?r:e}function Pu(e,i,s,c,h,v){var P=s&H,T=e.length,L=i.length;if(T!=L&&!(P&&L>T))return!1;var Q=v.get(e),Y=v.get(i);if(Q&&Y)return Q==i&&Y==e;var Z=-1,ne=!0,ue=s&X?new ai:r;for(v.set(e,i),v.set(i,e);++Z<T;){var de=e[Z],we=i[Z];if(c)var pe=P?c(we,de,Z,i,e,v):c(de,we,Z,e,i,v);if(pe!==r){if(pe)continue;ne=!1;break}if(ue){if(!Gs(i,function(Se,Oe){if(!Ji(ue,Oe)&&(de===Se||h(de,Se,s,c,v)))return ue.push(Oe)})){ne=!1;break}}else if(!(de===we||h(de,we,s,c,v))){ne=!1;break}}return v.delete(e),v.delete(i),ne}function bg(e,i,s,c,h,v,P){switch(s){case Ke:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Fe:return!(e.byteLength!=i.byteLength||!v(new Bn(e),new Bn(i)));case B:case q:case Te:return wr(+e,+i);case R:return e.name==i.name&&e.message==i.message;case Je:case He:return e==i+"";case Ee:var T=eo;case $e:var L=c&H;if(T||(T=qn),e.size!=i.size&&!L)return!1;var Q=P.get(e);if(Q)return Q==i;c|=X,P.set(e,i);var Y=Pu(T(e),T(i),c,h,v,P);return P.delete(e),Y;case Ve:if(en)return en.call(e)==en.call(i)}return!1}function Eg(e,i,s,c,h,v){var P=s&H,T=xo(e),L=T.length,Q=xo(i),Y=Q.length;if(L!=Y&&!P)return!1;for(var Z=L;Z--;){var ne=T[Z];if(!(P?ne in i:Re.call(i,ne)))return!1}var ue=v.get(e),de=v.get(i);if(ue&&de)return ue==i&&de==e;var we=!0;v.set(e,i),v.set(i,e);for(var pe=P;++Z<L;){ne=T[Z];var Se=e[ne],Oe=i[ne];if(c)var nr=P?c(Oe,Se,ne,i,e,v):c(Se,Oe,ne,e,i,v);if(!(nr===r?Se===Oe||h(Se,Oe,s,c,v):nr)){we=!1;break}pe||(pe=ne=="constructor")}if(we&&!pe){var Mt=e.constructor,sr=i.constructor;Mt!=sr&&"constructor"in e&&"constructor"in i&&!(typeof Mt=="function"&&Mt instanceof Mt&&typeof sr=="function"&&sr instanceof sr)&&(we=!1)}return v.delete(e),v.delete(i),we}function $r(e){return Fo($u(e,r,zu),e+"")}function xo(e){return Wc(e,Ot,Co)}function Po(e){return Wc(e,Gt,Nu)}var No=Yn?function(e){return Yn.get(e)}:Wo;function hs(e){for(var i=e.name+"",s=Ri[i],c=Re.call(Ri,i)?s.length:0;c--;){var h=s[c],v=h.func;if(v==null||v==e)return h.name}return i}function ji(e){var i=Re.call(p,"placeholder")?p:e;return i.placeholder}function fe(){var e=p.iteratee||Bo;return e=e===Bo?Qc:e,arguments.length?e(arguments[0],arguments[1]):e}function fs(e,i){var s=e.__data__;return Cg(i)?s[typeof i=="string"?"string":"hash"]:s.map}function To(e){for(var i=Ot(e),s=i.length;s--;){var c=i[s],h=e[c];i[s]=[c,h,Au(h)]}return i}function li(e,i){var s=$d(e,i);return Jc(s)?s:r}function Sg(e){var i=Re.call(e,si),s=e[si];try{e[si]=r;var c=!0}catch{}var h=Hn.call(e);return c&&(i?e[si]=s:delete e[si]),h}var Co=ro?function(e){return e==null?[]:(e=De(e),Hr(ro(e),function(i){return Fc.call(e,i)}))}:Go,Nu=ro?function(e){for(var i=[];e;)Vr(i,Co(e)),e=Kn(e);return i}:Go,Dt=Lt;(io&&Dt(new io(new ArrayBuffer(1)))!=Ke||Yi&&Dt(new Yi)!=Ee||no&&Dt(no.resolve())!=lt||Ai&&Dt(new Ai)!=$e||Xi&&Dt(new Xi)!=je)&&(Dt=function(e){var i=Lt(e),s=i==Pe?e.constructor:r,c=s?hi(s):"";if(c)switch(c){case sp:return Ke;case op:return Ee;case ap:return lt;case cp:return $e;case up:return je}return i});function Ig(e,i,s){for(var c=-1,h=s.length;++c<h;){var v=s[c],P=v.size;switch(v.type){case"drop":e+=P;break;case"dropRight":i-=P;break;case"take":i=Ft(i,e+P);break;case"takeRight":e=ut(e,i-P);break}}return{start:e,end:i}}function Og(e){var i=e.match(Et);return i?i[1].split(St):[]}function Tu(e,i,s){i=Jr(i,e);for(var c=-1,h=i.length,v=!1;++c<h;){var P=Or(i[c]);if(!(v=e!=null&&s(e,P)))break;e=e[P]}return v||++c!=h?v:(h=e==null?0:e.length,!!h&&_s(h)&&Fr(P,h)&&(ve(e)||fi(e)))}function xg(e){var i=e.length,s=new e.constructor(i);return i&&typeof e[0]=="string"&&Re.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Cu(e){return typeof e.constructor=="function"&&!cn(e)?$i(Kn(e)):{}}function Pg(e,i,s){var c=e.constructor;switch(i){case Fe:return So(e);case B:case q:return new c(+e);case Ke:return lg(e,s);case ot:case ht:case Tt:case $t:case Ut:case Bt:case Zt:case ar:case mr:return fu(e,s);case Ee:return new c;case Te:case He:return new c(e);case Je:return hg(e);case $e:return new c;case Ve:return fg(e)}}function Ng(e,i){var s=i.length;if(!s)return e;var c=s-1;return i[c]=(s>1?"& ":"")+i[c],i=i.join(s>2?", ":" "),e.replace(bt,`{
/* [wrapped with `+i+`] */
`)}function Tg(e){return ve(e)||fi(e)||!!(Dc&&e&&e[Dc])}function Fr(e,i){var s=typeof e;return i=i??te,!!i&&(s=="number"||s!="symbol"&&kf.test(e))&&e>-1&&e%1==0&&e<i}function qt(e,i,s){if(!We(s))return!1;var c=typeof i;return(c=="number"?Wt(s)&&Fr(i,s.length):c=="string"&&i in s)?wr(s[i],e):!1}function Ao(e,i){if(ve(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||ir(e)?!0:mt.test(e)||!yt.test(e)||i!=null&&e in De(i)}function Cg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Ro(e){var i=hs(e),s=p[i];if(typeof s!="function"||!(i in Ie.prototype))return!1;if(e===s)return!0;var c=No(s);return!!c&&e===c[0]}function Ag(e){return!!Ac&&Ac in e}var Rg=kn?Dr:Jo;function cn(e){var i=e&&e.constructor,s=typeof i=="function"&&i.prototype||Ci;return e===s}function Au(e){return e===e&&!We(e)}function Ru(e,i){return function(s){return s==null?!1:s[e]===i&&(i!==r||e in De(s))}}function $g(e){var i=ms(e,function(c){return s.size===F&&s.clear(),c}),s=i.cache;return i}function Fg(e,i){var s=e[1],c=i[1],h=s|c,v=h<(G|oe|$),P=c==$&&s==y||c==$&&s==x&&e[7].length<=i[8]||c==($|x)&&i[7].length<=i[8]&&s==y;if(!(v||P))return e;c&G&&(e[2]=i[2],h|=s&G?0:f);var T=i[3];if(T){var L=e[3];e[3]=L?pu(L,T,i[4]):T,e[4]=L?Br(e[3],C):i[4]}return T=i[5],T&&(L=e[5],e[5]=L?gu(L,T,i[6]):T,e[6]=L?Br(e[5],C):i[6]),T=i[7],T&&(e[7]=T),c&$&&(e[8]=e[8]==null?i[8]:Ft(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=h,e}function Dg(e){var i=[];if(e!=null)for(var s in De(e))i.push(s);return i}function jg(e){return Hn.call(e)}function $u(e,i,s){return i=ut(i===r?e.length-1:i,0),function(){for(var c=arguments,h=-1,v=ut(c.length-i,0),P=M(v);++h<v;)P[h]=c[i+h];h=-1;for(var T=M(i+1);++h<i;)T[h]=c[h];return T[i]=s(P),er(e,this,T)}}function Fu(e,i){return i.length<2?e:ui(e,dr(i,0,-1))}function Ug(e,i){for(var s=e.length,c=Ft(i.length,s),h=Kt(e);c--;){var v=i[c];e[c]=Fr(v,s)?h[v]:r}return e}function $o(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Du=Uu(nu),un=Xd||function(e,i){return Ct.setTimeout(e,i)},Fo=Uu(og);function ju(e,i,s){var c=i+"";return Fo(e,Ng(c,Lg(Og(c),s)))}function Uu(e){var i=0,s=0;return function(){var c=rp(),h=A-(c-s);if(s=c,h>0){if(++i>=I)return arguments[0]}else i=0;return e.apply(r,arguments)}}function ds(e,i){var s=-1,c=e.length,h=c-1;for(i=i===r?c:i;++s<i;){var v=yo(s,h),P=e[v];e[v]=e[s],e[s]=P}return e.length=i,e}var Lu=$g(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(vt,function(s,c,h,v){i.push(h?v.replace(Df,"$1"):c||s)}),i});function Or(e){if(typeof e=="string"||ir(e))return e;var i=e+"";return i=="0"&&1/e==-ee?"-0":i}function hi(e){if(e!=null){try{return zn.call(e)}catch{}try{return e+""}catch{}}return""}function Lg(e,i){return ur(et,function(s){var c="_."+s[0];i&s[1]&&!Un(e,c)&&e.push(c)}),e.sort()}function qu(e){if(e instanceof Ie)return e.clone();var i=new hr(e.__wrapped__,e.__chain__);return i.__actions__=Kt(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function qg(e,i,s){(s?qt(e,i,s):i===r)?i=1:i=ut(_e(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var h=0,v=0,P=M(Jn(c/i));h<c;)P[v++]=dr(e,h,h+=i);return P}function Mg(e){for(var i=-1,s=e==null?0:e.length,c=0,h=[];++i<s;){var v=e[i];v&&(h[c++]=v)}return h}function kg(){var e=arguments.length;if(!e)return[];for(var i=M(e-1),s=arguments[0],c=e;c--;)i[c-1]=arguments[c];return Vr(ve(s)?Kt(s):[s],At(i,1))}var zg=be(function(e,i){return Ye(e)?rn(e,At(i,1,Ye,!0)):[]}),Hg=be(function(e,i){var s=pr(i);return Ye(s)&&(s=r),Ye(e)?rn(e,At(i,1,Ye,!0),fe(s,2)):[]}),Vg=be(function(e,i){var s=pr(i);return Ye(s)&&(s=r),Ye(e)?rn(e,At(i,1,Ye,!0),r,s):[]});function Bg(e,i,s){var c=e==null?0:e.length;return c?(i=s||i===r?1:_e(i),dr(e,i<0?0:i,c)):[]}function Kg(e,i,s){var c=e==null?0:e.length;return c?(i=s||i===r?1:_e(i),i=c-i,dr(e,0,i<0?0:i)):[]}function Wg(e,i){return e&&e.length?ss(e,fe(i,3),!0,!0):[]}function Gg(e,i){return e&&e.length?ss(e,fe(i,3),!0):[]}function Jg(e,i,s,c){var h=e==null?0:e.length;return h?(s&&typeof s!="number"&&qt(e,i,s)&&(s=0,c=h),kp(e,i,s,c)):[]}function Mu(e,i,s){var c=e==null?0:e.length;if(!c)return-1;var h=s==null?0:_e(s);return h<0&&(h=ut(c+h,0)),Ln(e,fe(i,3),h)}function ku(e,i,s){var c=e==null?0:e.length;if(!c)return-1;var h=c-1;return s!==r&&(h=_e(s),h=s<0?ut(c+h,0):Ft(h,c-1)),Ln(e,fe(i,3),h,!0)}function zu(e){var i=e==null?0:e.length;return i?At(e,1):[]}function Qg(e){var i=e==null?0:e.length;return i?At(e,ee):[]}function Yg(e,i){var s=e==null?0:e.length;return s?(i=i===r?1:_e(i),At(e,i)):[]}function Xg(e){for(var i=-1,s=e==null?0:e.length,c={};++i<s;){var h=e[i];c[h[0]]=h[1]}return c}function Hu(e){return e&&e.length?e[0]:r}function Zg(e,i,s){var c=e==null?0:e.length;if(!c)return-1;var h=s==null?0:_e(s);return h<0&&(h=ut(c+h,0)),xi(e,i,h)}function ey(e){var i=e==null?0:e.length;return i?dr(e,0,-1):[]}var ty=be(function(e){var i=ze(e,bo);return i.length&&i[0]===e[0]?lo(i):[]}),ry=be(function(e){var i=pr(e),s=ze(e,bo);return i===pr(s)?i=r:s.pop(),s.length&&s[0]===e[0]?lo(s,fe(i,2)):[]}),iy=be(function(e){var i=pr(e),s=ze(e,bo);return i=typeof i=="function"?i:r,i&&s.pop(),s.length&&s[0]===e[0]?lo(s,r,i):[]});function ny(e,i){return e==null?"":ep.call(e,i)}function pr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function sy(e,i,s){var c=e==null?0:e.length;if(!c)return-1;var h=c;return s!==r&&(h=_e(s),h=h<0?ut(c+h,0):Ft(h,c-1)),i===i?Ld(e,i,h):Ln(e,Sc,h,!0)}function oy(e,i){return e&&e.length?eu(e,_e(i)):r}var ay=be(Vu);function Vu(e,i){return e&&e.length&&i&&i.length?go(e,i):e}function cy(e,i,s){return e&&e.length&&i&&i.length?go(e,i,fe(s,2)):e}function uy(e,i,s){return e&&e.length&&i&&i.length?go(e,i,r,s):e}var ly=$r(function(e,i){var s=e==null?0:e.length,c=oo(e,i);return iu(e,ze(i,function(h){return Fr(h,s)?+h:h}).sort(du)),c});function hy(e,i){var s=[];if(!(e&&e.length))return s;var c=-1,h=[],v=e.length;for(i=fe(i,3);++c<v;){var P=e[c];i(P,c,e)&&(s.push(P),h.push(c))}return iu(e,h),s}function Do(e){return e==null?e:np.call(e)}function fy(e,i,s){var c=e==null?0:e.length;return c?(s&&typeof s!="number"&&qt(e,i,s)?(i=0,s=c):(i=i==null?0:_e(i),s=s===r?c:_e(s)),dr(e,i,s)):[]}function dy(e,i){return ns(e,i)}function py(e,i,s){return vo(e,i,fe(s,2))}function gy(e,i){var s=e==null?0:e.length;if(s){var c=ns(e,i);if(c<s&&wr(e[c],i))return c}return-1}function yy(e,i){return ns(e,i,!0)}function my(e,i,s){return vo(e,i,fe(s,2),!0)}function vy(e,i){var s=e==null?0:e.length;if(s){var c=ns(e,i,!0)-1;if(wr(e[c],i))return c}return-1}function _y(e){return e&&e.length?su(e):[]}function wy(e,i){return e&&e.length?su(e,fe(i,2)):[]}function by(e){var i=e==null?0:e.length;return i?dr(e,1,i):[]}function Ey(e,i,s){return e&&e.length?(i=s||i===r?1:_e(i),dr(e,0,i<0?0:i)):[]}function Sy(e,i,s){var c=e==null?0:e.length;return c?(i=s||i===r?1:_e(i),i=c-i,dr(e,i<0?0:i,c)):[]}function Iy(e,i){return e&&e.length?ss(e,fe(i,3),!1,!0):[]}function Oy(e,i){return e&&e.length?ss(e,fe(i,3)):[]}var xy=be(function(e){return Gr(At(e,1,Ye,!0))}),Py=be(function(e){var i=pr(e);return Ye(i)&&(i=r),Gr(At(e,1,Ye,!0),fe(i,2))}),Ny=be(function(e){var i=pr(e);return i=typeof i=="function"?i:r,Gr(At(e,1,Ye,!0),r,i)});function Ty(e){return e&&e.length?Gr(e):[]}function Cy(e,i){return e&&e.length?Gr(e,fe(i,2)):[]}function Ay(e,i){return i=typeof i=="function"?i:r,e&&e.length?Gr(e,r,i):[]}function jo(e){if(!(e&&e.length))return[];var i=0;return e=Hr(e,function(s){if(Ye(s))return i=ut(s.length,i),!0}),Xs(i,function(s){return ze(e,Js(s))})}function Bu(e,i){if(!(e&&e.length))return[];var s=jo(e);return i==null?s:ze(s,function(c){return er(i,r,c)})}var Ry=be(function(e,i){return Ye(e)?rn(e,i):[]}),$y=be(function(e){return wo(Hr(e,Ye))}),Fy=be(function(e){var i=pr(e);return Ye(i)&&(i=r),wo(Hr(e,Ye),fe(i,2))}),Dy=be(function(e){var i=pr(e);return i=typeof i=="function"?i:r,wo(Hr(e,Ye),r,i)}),jy=be(jo);function Uy(e,i){return uu(e||[],i||[],tn)}function Ly(e,i){return uu(e||[],i||[],on)}var qy=be(function(e){var i=e.length,s=i>1?e[i-1]:r;return s=typeof s=="function"?(e.pop(),s):r,Bu(e,s)});function Ku(e){var i=p(e);return i.__chain__=!0,i}function My(e,i){return i(e),e}function ps(e,i){return i(e)}var ky=$r(function(e){var i=e.length,s=i?e[0]:0,c=this.__wrapped__,h=function(v){return oo(v,e)};return i>1||this.__actions__.length||!(c instanceof Ie)||!Fr(s)?this.thru(h):(c=c.slice(s,+s+(i?1:0)),c.__actions__.push({func:ps,args:[h],thisArg:r}),new hr(c,this.__chain__).thru(function(v){return i&&!v.length&&v.push(r),v}))});function zy(){return Ku(this)}function Hy(){return new hr(this.value(),this.__chain__)}function Vy(){this.__values__===r&&(this.__values__=ol(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function By(){return this}function Ky(e){for(var i,s=this;s instanceof Zn;){var c=qu(s);c.__index__=0,c.__values__=r,i?h.__wrapped__=c:i=c;var h=c;s=s.__wrapped__}return h.__wrapped__=e,i}function Wy(){var e=this.__wrapped__;if(e instanceof Ie){var i=e;return this.__actions__.length&&(i=new Ie(this)),i=i.reverse(),i.__actions__.push({func:ps,args:[Do],thisArg:r}),new hr(i,this.__chain__)}return this.thru(Do)}function Gy(){return cu(this.__wrapped__,this.__actions__)}var Jy=os(function(e,i,s){Re.call(e,s)?++e[s]:Ar(e,s,1)});function Qy(e,i,s){var c=ve(e)?bc:Mp;return s&&qt(e,i,s)&&(i=r),c(e,fe(i,3))}function Yy(e,i){var s=ve(e)?Hr:Bc;return s(e,fe(i,3))}var Xy=_u(Mu),Zy=_u(ku);function e0(e,i){return At(gs(e,i),1)}function t0(e,i){return At(gs(e,i),ee)}function r0(e,i,s){return s=s===r?1:_e(s),At(gs(e,i),s)}function Wu(e,i){var s=ve(e)?ur:Wr;return s(e,fe(i,3))}function Gu(e,i){var s=ve(e)?bd:Vc;return s(e,fe(i,3))}var i0=os(function(e,i,s){Re.call(e,s)?e[s].push(i):Ar(e,s,[i])});function n0(e,i,s,c){e=Wt(e)?e:Li(e),s=s&&!c?_e(s):0;var h=e.length;return s<0&&(s=ut(h+s,0)),ws(e)?s<=h&&e.indexOf(i,s)>-1:!!h&&xi(e,i,s)>-1}var s0=be(function(e,i,s){var c=-1,h=typeof i=="function",v=Wt(e)?M(e.length):[];return Wr(e,function(P){v[++c]=h?er(i,P,s):nn(P,i,s)}),v}),o0=os(function(e,i,s){Ar(e,s,i)});function gs(e,i){var s=ve(e)?ze:Yc;return s(e,fe(i,3))}function a0(e,i,s,c){return e==null?[]:(ve(i)||(i=i==null?[]:[i]),s=c?r:s,ve(s)||(s=s==null?[]:[s]),tu(e,i,s))}var c0=os(function(e,i,s){e[s?0:1].push(i)},function(){return[[],[]]});function u0(e,i,s){var c=ve(e)?Ws:Oc,h=arguments.length<3;return c(e,fe(i,4),s,h,Wr)}function l0(e,i,s){var c=ve(e)?Ed:Oc,h=arguments.length<3;return c(e,fe(i,4),s,h,Vc)}function h0(e,i){var s=ve(e)?Hr:Bc;return s(e,vs(fe(i,3)))}function f0(e){var i=ve(e)?Mc:ng;return i(e)}function d0(e,i,s){(s?qt(e,i,s):i===r)?i=1:i=_e(i);var c=ve(e)?Dp:sg;return c(e,i)}function p0(e){var i=ve(e)?jp:ag;return i(e)}function g0(e){if(e==null)return 0;if(Wt(e))return ws(e)?Ni(e):e.length;var i=Dt(e);return i==Ee||i==$e?e.size:fo(e).length}function y0(e,i,s){var c=ve(e)?Gs:cg;return s&&qt(e,i,s)&&(i=r),c(e,fe(i,3))}var m0=be(function(e,i){if(e==null)return[];var s=i.length;return s>1&&qt(e,i[0],i[1])?i=[]:s>2&&qt(i[0],i[1],i[2])&&(i=[i[0]]),tu(e,At(i,1),[])}),ys=Yd||function(){return Ct.Date.now()};function v0(e,i){if(typeof i!="function")throw new lr(g);return e=_e(e),function(){if(--e<1)return i.apply(this,arguments)}}function Ju(e,i,s){return i=s?r:i,i=e&&i==null?e.length:i,Rr(e,$,r,r,r,r,i)}function Qu(e,i){var s;if(typeof i!="function")throw new lr(g);return e=_e(e),function(){return--e>0&&(s=i.apply(this,arguments)),e<=1&&(i=r),s}}var Uo=be(function(e,i,s){var c=G;if(s.length){var h=Br(s,ji(Uo));c|=b}return Rr(e,c,i,s,h)}),Yu=be(function(e,i,s){var c=G|oe;if(s.length){var h=Br(s,ji(Yu));c|=b}return Rr(i,c,e,s,h)});function Xu(e,i,s){i=s?r:i;var c=Rr(e,y,r,r,r,r,r,i);return c.placeholder=Xu.placeholder,c}function Zu(e,i,s){i=s?r:i;var c=Rr(e,E,r,r,r,r,r,i);return c.placeholder=Zu.placeholder,c}function el(e,i,s){var c,h,v,P,T,L,Q=0,Y=!1,Z=!1,ne=!0;if(typeof e!="function")throw new lr(g);i=gr(i)||0,We(s)&&(Y=!!s.leading,Z="maxWait"in s,v=Z?ut(gr(s.maxWait)||0,i):v,ne="trailing"in s?!!s.trailing:ne);function ue(Xe){var br=c,Ur=h;return c=h=r,Q=Xe,P=e.apply(Ur,br),P}function de(Xe){return Q=Xe,T=un(Se,i),Y?ue(Xe):P}function we(Xe){var br=Xe-L,Ur=Xe-Q,_l=i-br;return Z?Ft(_l,v-Ur):_l}function pe(Xe){var br=Xe-L,Ur=Xe-Q;return L===r||br>=i||br<0||Z&&Ur>=v}function Se(){var Xe=ys();if(pe(Xe))return Oe(Xe);T=un(Se,we(Xe))}function Oe(Xe){return T=r,ne&&c?ue(Xe):(c=h=r,P)}function nr(){T!==r&&lu(T),Q=0,c=L=h=T=r}function Mt(){return T===r?P:Oe(ys())}function sr(){var Xe=ys(),br=pe(Xe);if(c=arguments,h=this,L=Xe,br){if(T===r)return de(L);if(Z)return lu(T),T=un(Se,i),ue(L)}return T===r&&(T=un(Se,i)),P}return sr.cancel=nr,sr.flush=Mt,sr}var _0=be(function(e,i){return Hc(e,1,i)}),w0=be(function(e,i,s){return Hc(e,gr(i)||0,s)});function b0(e){return Rr(e,re)}function ms(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new lr(g);var s=function(){var c=arguments,h=i?i.apply(this,c):c[0],v=s.cache;if(v.has(h))return v.get(h);var P=e.apply(this,c);return s.cache=v.set(h,P)||v,P};return s.cache=new(ms.Cache||Cr),s}ms.Cache=Cr;function vs(e){if(typeof e!="function")throw new lr(g);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function E0(e){return Qu(2,e)}var S0=ug(function(e,i){i=i.length==1&&ve(i[0])?ze(i[0],tr(fe())):ze(At(i,1),tr(fe()));var s=i.length;return be(function(c){for(var h=-1,v=Ft(c.length,s);++h<v;)c[h]=i[h].call(this,c[h]);return er(e,this,c)})}),Lo=be(function(e,i){var s=Br(i,ji(Lo));return Rr(e,b,r,i,s)}),tl=be(function(e,i){var s=Br(i,ji(tl));return Rr(e,m,r,i,s)}),I0=$r(function(e,i){return Rr(e,x,r,r,r,i)});function O0(e,i){if(typeof e!="function")throw new lr(g);return i=i===r?i:_e(i),be(e,i)}function x0(e,i){if(typeof e!="function")throw new lr(g);return i=i==null?0:ut(_e(i),0),be(function(s){var c=s[i],h=Qr(s,0,i);return c&&Vr(h,c),er(e,this,h)})}function P0(e,i,s){var c=!0,h=!0;if(typeof e!="function")throw new lr(g);return We(s)&&(c="leading"in s?!!s.leading:c,h="trailing"in s?!!s.trailing:h),el(e,i,{leading:c,maxWait:i,trailing:h})}function N0(e){return Ju(e,1)}function T0(e,i){return Lo(Eo(i),e)}function C0(){if(!arguments.length)return[];var e=arguments[0];return ve(e)?e:[e]}function A0(e){return fr(e,J)}function R0(e,i){return i=typeof i=="function"?i:r,fr(e,J,i)}function $0(e){return fr(e,U|J)}function F0(e,i){return i=typeof i=="function"?i:r,fr(e,U|J,i)}function D0(e,i){return i==null||zc(e,i,Ot(i))}function wr(e,i){return e===i||e!==e&&i!==i}var j0=ls(uo),U0=ls(function(e,i){return e>=i}),fi=Gc(function(){return arguments}())?Gc:function(e){return Ge(e)&&Re.call(e,"callee")&&!Fc.call(e,"callee")},ve=M.isArray,L0=gc?tr(gc):Kp;function Wt(e){return e!=null&&_s(e.length)&&!Dr(e)}function Ye(e){return Ge(e)&&Wt(e)}function q0(e){return e===!0||e===!1||Ge(e)&&Lt(e)==B}var Yr=Zd||Jo,M0=yc?tr(yc):Wp;function k0(e){return Ge(e)&&e.nodeType===1&&!ln(e)}function z0(e){if(e==null)return!0;if(Wt(e)&&(ve(e)||typeof e=="string"||typeof e.splice=="function"||Yr(e)||Ui(e)||fi(e)))return!e.length;var i=Dt(e);if(i==Ee||i==$e)return!e.size;if(cn(e))return!fo(e).length;for(var s in e)if(Re.call(e,s))return!1;return!0}function H0(e,i){return sn(e,i)}function V0(e,i,s){s=typeof s=="function"?s:r;var c=s?s(e,i):r;return c===r?sn(e,i,r,s):!!c}function qo(e){if(!Ge(e))return!1;var i=Lt(e);return i==R||i==u||typeof e.message=="string"&&typeof e.name=="string"&&!ln(e)}function B0(e){return typeof e=="number"&&jc(e)}function Dr(e){if(!We(e))return!1;var i=Lt(e);return i==he||i==me||i==V||i==st}function rl(e){return typeof e=="number"&&e==_e(e)}function _s(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=te}function We(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function Ge(e){return e!=null&&typeof e=="object"}var il=mc?tr(mc):Jp;function K0(e,i){return e===i||ho(e,i,To(i))}function W0(e,i,s){return s=typeof s=="function"?s:r,ho(e,i,To(i),s)}function G0(e){return nl(e)&&e!=+e}function J0(e){if(Rg(e))throw new ye(l);return Jc(e)}function Q0(e){return e===null}function Y0(e){return e==null}function nl(e){return typeof e=="number"||Ge(e)&&Lt(e)==Te}function ln(e){if(!Ge(e)||Lt(e)!=Pe)return!1;var i=Kn(e);if(i===null)return!0;var s=Re.call(i,"constructor")&&i.constructor;return typeof s=="function"&&s instanceof s&&zn.call(s)==Wd}var Mo=vc?tr(vc):Qp;function X0(e){return rl(e)&&e>=-te&&e<=te}var sl=_c?tr(_c):Yp;function ws(e){return typeof e=="string"||!ve(e)&&Ge(e)&&Lt(e)==He}function ir(e){return typeof e=="symbol"||Ge(e)&&Lt(e)==Ve}var Ui=wc?tr(wc):Xp;function Z0(e){return e===r}function em(e){return Ge(e)&&Dt(e)==je}function tm(e){return Ge(e)&&Lt(e)==Be}var rm=ls(po),im=ls(function(e,i){return e<=i});function ol(e){if(!e)return[];if(Wt(e))return ws(e)?vr(e):Kt(e);if(Qi&&e[Qi])return Dd(e[Qi]());var i=Dt(e),s=i==Ee?eo:i==$e?qn:Li;return s(e)}function jr(e){if(!e)return e===0?e:0;if(e=gr(e),e===ee||e===-ee){var i=e<0?-1:1;return i*D}return e===e?e:0}function _e(e){var i=jr(e),s=i%1;return i===i?s?i-s:i:0}function al(e){return e?ci(_e(e),0,ie):0}function gr(e){if(typeof e=="number")return e;if(ir(e))return z;if(We(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=We(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=xc(e);var s=Lf.test(e);return s||Mf.test(e)?vd(e.slice(2),s?2:8):Uf.test(e)?z:+e}function cl(e){return Ir(e,Gt(e))}function nm(e){return e?ci(_e(e),-te,te):e===0?e:0}function Ce(e){return e==null?"":rr(e)}var sm=Fi(function(e,i){if(cn(i)||Wt(i)){Ir(i,Ot(i),e);return}for(var s in i)Re.call(i,s)&&tn(e,s,i[s])}),ul=Fi(function(e,i){Ir(i,Gt(i),e)}),bs=Fi(function(e,i,s,c){Ir(i,Gt(i),e,c)}),om=Fi(function(e,i,s,c){Ir(i,Ot(i),e,c)}),am=$r(oo);function cm(e,i){var s=$i(e);return i==null?s:kc(s,i)}var um=be(function(e,i){e=De(e);var s=-1,c=i.length,h=c>2?i[2]:r;for(h&&qt(i[0],i[1],h)&&(c=1);++s<c;)for(var v=i[s],P=Gt(v),T=-1,L=P.length;++T<L;){var Q=P[T],Y=e[Q];(Y===r||wr(Y,Ci[Q])&&!Re.call(e,Q))&&(e[Q]=v[Q])}return e}),lm=be(function(e){return e.push(r,xu),er(ll,r,e)});function hm(e,i){return Ec(e,fe(i,3),Sr)}function fm(e,i){return Ec(e,fe(i,3),co)}function dm(e,i){return e==null?e:ao(e,fe(i,3),Gt)}function pm(e,i){return e==null?e:Kc(e,fe(i,3),Gt)}function gm(e,i){return e&&Sr(e,fe(i,3))}function ym(e,i){return e&&co(e,fe(i,3))}function mm(e){return e==null?[]:rs(e,Ot(e))}function vm(e){return e==null?[]:rs(e,Gt(e))}function ko(e,i,s){var c=e==null?r:ui(e,i);return c===r?s:c}function _m(e,i){return e!=null&&Tu(e,i,zp)}function zo(e,i){return e!=null&&Tu(e,i,Hp)}var wm=bu(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=Hn.call(i)),e[i]=s},Vo(Jt)),bm=bu(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=Hn.call(i)),Re.call(e,i)?e[i].push(s):e[i]=[s]},fe),Em=be(nn);function Ot(e){return Wt(e)?qc(e):fo(e)}function Gt(e){return Wt(e)?qc(e,!0):Zp(e)}function Sm(e,i){var s={};return i=fe(i,3),Sr(e,function(c,h,v){Ar(s,i(c,h,v),c)}),s}function Im(e,i){var s={};return i=fe(i,3),Sr(e,function(c,h,v){Ar(s,h,i(c,h,v))}),s}var Om=Fi(function(e,i,s){is(e,i,s)}),ll=Fi(function(e,i,s,c){is(e,i,s,c)}),xm=$r(function(e,i){var s={};if(e==null)return s;var c=!1;i=ze(i,function(v){return v=Jr(v,e),c||(c=v.length>1),v}),Ir(e,Po(e),s),c&&(s=fr(s,U|K|J,wg));for(var h=i.length;h--;)_o(s,i[h]);return s});function Pm(e,i){return hl(e,vs(fe(i)))}var Nm=$r(function(e,i){return e==null?{}:tg(e,i)});function hl(e,i){if(e==null)return{};var s=ze(Po(e),function(c){return[c]});return i=fe(i),ru(e,s,function(c,h){return i(c,h[0])})}function Tm(e,i,s){i=Jr(i,e);var c=-1,h=i.length;for(h||(h=1,e=r);++c<h;){var v=e==null?r:e[Or(i[c])];v===r&&(c=h,v=s),e=Dr(v)?v.call(e):v}return e}function Cm(e,i,s){return e==null?e:on(e,i,s)}function Am(e,i,s,c){return c=typeof c=="function"?c:r,e==null?e:on(e,i,s,c)}var fl=Iu(Ot),dl=Iu(Gt);function Rm(e,i,s){var c=ve(e),h=c||Yr(e)||Ui(e);if(i=fe(i,4),s==null){var v=e&&e.constructor;h?s=c?new v:[]:We(e)?s=Dr(v)?$i(Kn(e)):{}:s={}}return(h?ur:Sr)(e,function(P,T,L){return i(s,P,T,L)}),s}function $m(e,i){return e==null?!0:_o(e,i)}function Fm(e,i,s){return e==null?e:au(e,i,Eo(s))}function Dm(e,i,s,c){return c=typeof c=="function"?c:r,e==null?e:au(e,i,Eo(s),c)}function Li(e){return e==null?[]:Zs(e,Ot(e))}function jm(e){return e==null?[]:Zs(e,Gt(e))}function Um(e,i,s){return s===r&&(s=i,i=r),s!==r&&(s=gr(s),s=s===s?s:0),i!==r&&(i=gr(i),i=i===i?i:0),ci(gr(e),i,s)}function Lm(e,i,s){return i=jr(i),s===r?(s=i,i=0):s=jr(s),e=gr(e),Vp(e,i,s)}function qm(e,i,s){if(s&&typeof s!="boolean"&&qt(e,i,s)&&(i=s=r),s===r&&(typeof i=="boolean"?(s=i,i=r):typeof e=="boolean"&&(s=e,e=r)),e===r&&i===r?(e=0,i=1):(e=jr(e),i===r?(i=e,e=0):i=jr(i)),e>i){var c=e;e=i,i=c}if(s||e%1||i%1){var h=Uc();return Ft(e+h*(i-e+md("1e-"+((h+"").length-1))),i)}return yo(e,i)}var Mm=Di(function(e,i,s){return i=i.toLowerCase(),e+(s?pl(i):i)});function pl(e){return Ho(Ce(e).toLowerCase())}function gl(e){return e=Ce(e),e&&e.replace(zf,Cd).replace(ad,"")}function km(e,i,s){e=Ce(e),i=rr(i);var c=e.length;s=s===r?c:ci(_e(s),0,c);var h=s;return s-=i.length,s>=0&&e.slice(s,h)==i}function zm(e){return e=Ce(e),e&&dt.test(e)?e.replace(Gi,Ad):e}function Hm(e){return e=Ce(e),e&&_t.test(e)?e.replace(tt,"\\$&"):e}var Vm=Di(function(e,i,s){return e+(s?"-":"")+i.toLowerCase()}),Bm=Di(function(e,i,s){return e+(s?" ":"")+i.toLowerCase()}),Km=vu("toLowerCase");function Wm(e,i,s){e=Ce(e),i=_e(i);var c=i?Ni(e):0;if(!i||c>=i)return e;var h=(i-c)/2;return us(Qn(h),s)+e+us(Jn(h),s)}function Gm(e,i,s){e=Ce(e),i=_e(i);var c=i?Ni(e):0;return i&&c<i?e+us(i-c,s):e}function Jm(e,i,s){e=Ce(e),i=_e(i);var c=i?Ni(e):0;return i&&c<i?us(i-c,s)+e:e}function Qm(e,i,s){return s||i==null?i=0:i&&(i=+i),ip(Ce(e).replace(rt,""),i||0)}function Ym(e,i,s){return(s?qt(e,i,s):i===r)?i=1:i=_e(i),mo(Ce(e),i)}function Xm(){var e=arguments,i=Ce(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Zm=Di(function(e,i,s){return e+(s?"_":"")+i.toLowerCase()});function e1(e,i,s){return s&&typeof s!="number"&&qt(e,i,s)&&(i=s=r),s=s===r?ie:s>>>0,s?(e=Ce(e),e&&(typeof i=="string"||i!=null&&!Mo(i))&&(i=rr(i),!i&&Pi(e))?Qr(vr(e),0,s):e.split(i,s)):[]}var t1=Di(function(e,i,s){return e+(s?" ":"")+Ho(i)});function r1(e,i,s){return e=Ce(e),s=s==null?0:ci(_e(s),0,e.length),i=rr(i),e.slice(s,s+i.length)==i}function i1(e,i,s){var c=p.templateSettings;s&&qt(e,i,s)&&(i=r),e=Ce(e),i=bs({},i,c,Ou);var h=bs({},i.imports,c.imports,Ou),v=Ot(h),P=Zs(h,v),T,L,Q=0,Y=i.interpolate||Fn,Z="__p += '",ne=to((i.escape||Fn).source+"|"+Y.source+"|"+(Y===at?jf:Fn).source+"|"+(i.evaluate||Fn).source+"|$","g"),ue="//# sourceURL="+(Re.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++fd+"]")+`
`;e.replace(ne,function(pe,Se,Oe,nr,Mt,sr){return Oe||(Oe=nr),Z+=e.slice(Q,sr).replace(Hf,Rd),Se&&(T=!0,Z+=`' +
__e(`+Se+`) +
'`),Mt&&(L=!0,Z+=`';
`+Mt+`;
__p += '`),Oe&&(Z+=`' +
((__t = (`+Oe+`)) == null ? '' : __t) +
'`),Q=sr+pe.length,pe}),Z+=`';
`;var de=Re.call(i,"variable")&&i.variable;if(!de)Z=`with (obj) {
`+Z+`
}
`;else if(Ff.test(de))throw new ye(O);Z=(L?Z.replace(zr,""):Z).replace(ii,"$1").replace(Si,"$1;"),Z="function("+(de||"obj")+`) {
`+(de?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(T?", __e = _.escape":"")+(L?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Z+`return __p
}`;var we=ml(function(){return Ne(v,ue+"return "+Z).apply(r,P)});if(we.source=Z,qo(we))throw we;return we}function n1(e){return Ce(e).toLowerCase()}function s1(e){return Ce(e).toUpperCase()}function o1(e,i,s){if(e=Ce(e),e&&(s||i===r))return xc(e);if(!e||!(i=rr(i)))return e;var c=vr(e),h=vr(i),v=Pc(c,h),P=Nc(c,h)+1;return Qr(c,v,P).join("")}function a1(e,i,s){if(e=Ce(e),e&&(s||i===r))return e.slice(0,Cc(e)+1);if(!e||!(i=rr(i)))return e;var c=vr(e),h=Nc(c,vr(i))+1;return Qr(c,0,h).join("")}function c1(e,i,s){if(e=Ce(e),e&&(s||i===r))return e.replace(rt,"");if(!e||!(i=rr(i)))return e;var c=vr(e),h=Pc(c,vr(i));return Qr(c,h).join("")}function u1(e,i){var s=d,c=S;if(We(i)){var h="separator"in i?i.separator:h;s="length"in i?_e(i.length):s,c="omission"in i?rr(i.omission):c}e=Ce(e);var v=e.length;if(Pi(e)){var P=vr(e);v=P.length}if(s>=v)return e;var T=s-Ni(c);if(T<1)return c;var L=P?Qr(P,0,T).join(""):e.slice(0,T);if(h===r)return L+c;if(P&&(T+=L.length-T),Mo(h)){if(e.slice(T).search(h)){var Q,Y=L;for(h.global||(h=to(h.source,Ce(Ga.exec(h))+"g")),h.lastIndex=0;Q=h.exec(Y);)var Z=Q.index;L=L.slice(0,Z===r?T:Z)}}else if(e.indexOf(rr(h),T)!=T){var ne=L.lastIndexOf(h);ne>-1&&(L=L.slice(0,ne))}return L+c}function l1(e){return e=Ce(e),e&&ft.test(e)?e.replace(Ii,qd):e}var h1=Di(function(e,i,s){return e+(s?" ":"")+i.toUpperCase()}),Ho=vu("toUpperCase");function yl(e,i,s){return e=Ce(e),i=s?r:i,i===r?Fd(e)?zd(e):Od(e):e.match(i)||[]}var ml=be(function(e,i){try{return er(e,r,i)}catch(s){return qo(s)?s:new ye(s)}}),f1=$r(function(e,i){return ur(i,function(s){s=Or(s),Ar(e,s,Uo(e[s],e))}),e});function d1(e){var i=e==null?0:e.length,s=fe();return e=i?ze(e,function(c){if(typeof c[1]!="function")throw new lr(g);return[s(c[0]),c[1]]}):[],be(function(c){for(var h=-1;++h<i;){var v=e[h];if(er(v[0],this,c))return er(v[1],this,c)}})}function p1(e){return qp(fr(e,U))}function Vo(e){return function(){return e}}function g1(e,i){return e==null||e!==e?i:e}var y1=wu(),m1=wu(!0);function Jt(e){return e}function Bo(e){return Qc(typeof e=="function"?e:fr(e,U))}function v1(e){return Xc(fr(e,U))}function _1(e,i){return Zc(e,fr(i,U))}var w1=be(function(e,i){return function(s){return nn(s,e,i)}}),b1=be(function(e,i){return function(s){return nn(e,s,i)}});function Ko(e,i,s){var c=Ot(i),h=rs(i,c);s==null&&!(We(i)&&(h.length||!c.length))&&(s=i,i=e,e=this,h=rs(i,Ot(i)));var v=!(We(s)&&"chain"in s)||!!s.chain,P=Dr(e);return ur(h,function(T){var L=i[T];e[T]=L,P&&(e.prototype[T]=function(){var Q=this.__chain__;if(v||Q){var Y=e(this.__wrapped__),Z=Y.__actions__=Kt(this.__actions__);return Z.push({func:L,args:arguments,thisArg:e}),Y.__chain__=Q,Y}return L.apply(e,Vr([this.value()],arguments))})}),e}function E1(){return Ct._===this&&(Ct._=Gd),this}function Wo(){}function S1(e){return e=_e(e),be(function(i){return eu(i,e)})}var I1=Io(ze),O1=Io(bc),x1=Io(Gs);function vl(e){return Ao(e)?Js(Or(e)):rg(e)}function P1(e){return function(i){return e==null?r:ui(e,i)}}var N1=Eu(),T1=Eu(!0);function Go(){return[]}function Jo(){return!1}function C1(){return{}}function A1(){return""}function R1(){return!0}function $1(e,i){if(e=_e(e),e<1||e>te)return[];var s=ie,c=Ft(e,ie);i=fe(i),e-=ie;for(var h=Xs(c,i);++s<e;)i(s);return h}function F1(e){return ve(e)?ze(e,Or):ir(e)?[e]:Kt(Lu(Ce(e)))}function D1(e){var i=++Kd;return Ce(e)+i}var j1=cs(function(e,i){return e+i},0),U1=Oo("ceil"),L1=cs(function(e,i){return e/i},1),q1=Oo("floor");function M1(e){return e&&e.length?ts(e,Jt,uo):r}function k1(e,i){return e&&e.length?ts(e,fe(i,2),uo):r}function z1(e){return Ic(e,Jt)}function H1(e,i){return Ic(e,fe(i,2))}function V1(e){return e&&e.length?ts(e,Jt,po):r}function B1(e,i){return e&&e.length?ts(e,fe(i,2),po):r}var K1=cs(function(e,i){return e*i},1),W1=Oo("round"),G1=cs(function(e,i){return e-i},0);function J1(e){return e&&e.length?Ys(e,Jt):0}function Q1(e,i){return e&&e.length?Ys(e,fe(i,2)):0}return p.after=v0,p.ary=Ju,p.assign=sm,p.assignIn=ul,p.assignInWith=bs,p.assignWith=om,p.at=am,p.before=Qu,p.bind=Uo,p.bindAll=f1,p.bindKey=Yu,p.castArray=C0,p.chain=Ku,p.chunk=qg,p.compact=Mg,p.concat=kg,p.cond=d1,p.conforms=p1,p.constant=Vo,p.countBy=Jy,p.create=cm,p.curry=Xu,p.curryRight=Zu,p.debounce=el,p.defaults=um,p.defaultsDeep=lm,p.defer=_0,p.delay=w0,p.difference=zg,p.differenceBy=Hg,p.differenceWith=Vg,p.drop=Bg,p.dropRight=Kg,p.dropRightWhile=Wg,p.dropWhile=Gg,p.fill=Jg,p.filter=Yy,p.flatMap=e0,p.flatMapDeep=t0,p.flatMapDepth=r0,p.flatten=zu,p.flattenDeep=Qg,p.flattenDepth=Yg,p.flip=b0,p.flow=y1,p.flowRight=m1,p.fromPairs=Xg,p.functions=mm,p.functionsIn=vm,p.groupBy=i0,p.initial=ey,p.intersection=ty,p.intersectionBy=ry,p.intersectionWith=iy,p.invert=wm,p.invertBy=bm,p.invokeMap=s0,p.iteratee=Bo,p.keyBy=o0,p.keys=Ot,p.keysIn=Gt,p.map=gs,p.mapKeys=Sm,p.mapValues=Im,p.matches=v1,p.matchesProperty=_1,p.memoize=ms,p.merge=Om,p.mergeWith=ll,p.method=w1,p.methodOf=b1,p.mixin=Ko,p.negate=vs,p.nthArg=S1,p.omit=xm,p.omitBy=Pm,p.once=E0,p.orderBy=a0,p.over=I1,p.overArgs=S0,p.overEvery=O1,p.overSome=x1,p.partial=Lo,p.partialRight=tl,p.partition=c0,p.pick=Nm,p.pickBy=hl,p.property=vl,p.propertyOf=P1,p.pull=ay,p.pullAll=Vu,p.pullAllBy=cy,p.pullAllWith=uy,p.pullAt=ly,p.range=N1,p.rangeRight=T1,p.rearg=I0,p.reject=h0,p.remove=hy,p.rest=O0,p.reverse=Do,p.sampleSize=d0,p.set=Cm,p.setWith=Am,p.shuffle=p0,p.slice=fy,p.sortBy=m0,p.sortedUniq=_y,p.sortedUniqBy=wy,p.split=e1,p.spread=x0,p.tail=by,p.take=Ey,p.takeRight=Sy,p.takeRightWhile=Iy,p.takeWhile=Oy,p.tap=My,p.throttle=P0,p.thru=ps,p.toArray=ol,p.toPairs=fl,p.toPairsIn=dl,p.toPath=F1,p.toPlainObject=cl,p.transform=Rm,p.unary=N0,p.union=xy,p.unionBy=Py,p.unionWith=Ny,p.uniq=Ty,p.uniqBy=Cy,p.uniqWith=Ay,p.unset=$m,p.unzip=jo,p.unzipWith=Bu,p.update=Fm,p.updateWith=Dm,p.values=Li,p.valuesIn=jm,p.without=Ry,p.words=yl,p.wrap=T0,p.xor=$y,p.xorBy=Fy,p.xorWith=Dy,p.zip=jy,p.zipObject=Uy,p.zipObjectDeep=Ly,p.zipWith=qy,p.entries=fl,p.entriesIn=dl,p.extend=ul,p.extendWith=bs,Ko(p,p),p.add=j1,p.attempt=ml,p.camelCase=Mm,p.capitalize=pl,p.ceil=U1,p.clamp=Um,p.clone=A0,p.cloneDeep=$0,p.cloneDeepWith=F0,p.cloneWith=R0,p.conformsTo=D0,p.deburr=gl,p.defaultTo=g1,p.divide=L1,p.endsWith=km,p.eq=wr,p.escape=zm,p.escapeRegExp=Hm,p.every=Qy,p.find=Xy,p.findIndex=Mu,p.findKey=hm,p.findLast=Zy,p.findLastIndex=ku,p.findLastKey=fm,p.floor=q1,p.forEach=Wu,p.forEachRight=Gu,p.forIn=dm,p.forInRight=pm,p.forOwn=gm,p.forOwnRight=ym,p.get=ko,p.gt=j0,p.gte=U0,p.has=_m,p.hasIn=zo,p.head=Hu,p.identity=Jt,p.includes=n0,p.indexOf=Zg,p.inRange=Lm,p.invoke=Em,p.isArguments=fi,p.isArray=ve,p.isArrayBuffer=L0,p.isArrayLike=Wt,p.isArrayLikeObject=Ye,p.isBoolean=q0,p.isBuffer=Yr,p.isDate=M0,p.isElement=k0,p.isEmpty=z0,p.isEqual=H0,p.isEqualWith=V0,p.isError=qo,p.isFinite=B0,p.isFunction=Dr,p.isInteger=rl,p.isLength=_s,p.isMap=il,p.isMatch=K0,p.isMatchWith=W0,p.isNaN=G0,p.isNative=J0,p.isNil=Y0,p.isNull=Q0,p.isNumber=nl,p.isObject=We,p.isObjectLike=Ge,p.isPlainObject=ln,p.isRegExp=Mo,p.isSafeInteger=X0,p.isSet=sl,p.isString=ws,p.isSymbol=ir,p.isTypedArray=Ui,p.isUndefined=Z0,p.isWeakMap=em,p.isWeakSet=tm,p.join=ny,p.kebabCase=Vm,p.last=pr,p.lastIndexOf=sy,p.lowerCase=Bm,p.lowerFirst=Km,p.lt=rm,p.lte=im,p.max=M1,p.maxBy=k1,p.mean=z1,p.meanBy=H1,p.min=V1,p.minBy=B1,p.stubArray=Go,p.stubFalse=Jo,p.stubObject=C1,p.stubString=A1,p.stubTrue=R1,p.multiply=K1,p.nth=oy,p.noConflict=E1,p.noop=Wo,p.now=ys,p.pad=Wm,p.padEnd=Gm,p.padStart=Jm,p.parseInt=Qm,p.random=qm,p.reduce=u0,p.reduceRight=l0,p.repeat=Ym,p.replace=Xm,p.result=Tm,p.round=W1,p.runInContext=j,p.sample=f0,p.size=g0,p.snakeCase=Zm,p.some=y0,p.sortedIndex=dy,p.sortedIndexBy=py,p.sortedIndexOf=gy,p.sortedLastIndex=yy,p.sortedLastIndexBy=my,p.sortedLastIndexOf=vy,p.startCase=t1,p.startsWith=r1,p.subtract=G1,p.sum=J1,p.sumBy=Q1,p.template=i1,p.times=$1,p.toFinite=jr,p.toInteger=_e,p.toLength=al,p.toLower=n1,p.toNumber=gr,p.toSafeInteger=nm,p.toString=Ce,p.toUpper=s1,p.trim=o1,p.trimEnd=a1,p.trimStart=c1,p.truncate=u1,p.unescape=l1,p.uniqueId=D1,p.upperCase=h1,p.upperFirst=Ho,p.each=Wu,p.eachRight=Gu,p.first=Hu,Ko(p,function(){var e={};return Sr(p,function(i,s){Re.call(p.prototype,s)||(e[s]=i)}),e}(),{chain:!1}),p.VERSION=n,ur(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),ur(["drop","take"],function(e,i){Ie.prototype[e]=function(s){s=s===r?1:ut(_e(s),0);var c=this.__filtered__&&!i?new Ie(this):this.clone();return c.__filtered__?c.__takeCount__=Ft(s,c.__takeCount__):c.__views__.push({size:Ft(s,ie),type:e+(c.__dir__<0?"Right":"")}),c},Ie.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),ur(["filter","map","takeWhile"],function(e,i){var s=i+1,c=s==w||s==k;Ie.prototype[e]=function(h){var v=this.clone();return v.__iteratees__.push({iteratee:fe(h,3),type:s}),v.__filtered__=v.__filtered__||c,v}}),ur(["head","last"],function(e,i){var s="take"+(i?"Right":"");Ie.prototype[e]=function(){return this[s](1).value()[0]}}),ur(["initial","tail"],function(e,i){var s="drop"+(i?"":"Right");Ie.prototype[e]=function(){return this.__filtered__?new Ie(this):this[s](1)}}),Ie.prototype.compact=function(){return this.filter(Jt)},Ie.prototype.find=function(e){return this.filter(e).head()},Ie.prototype.findLast=function(e){return this.reverse().find(e)},Ie.prototype.invokeMap=be(function(e,i){return typeof e=="function"?new Ie(this):this.map(function(s){return nn(s,e,i)})}),Ie.prototype.reject=function(e){return this.filter(vs(fe(e)))},Ie.prototype.slice=function(e,i){e=_e(e);var s=this;return s.__filtered__&&(e>0||i<0)?new Ie(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),i!==r&&(i=_e(i),s=i<0?s.dropRight(-i):s.take(i-e)),s)},Ie.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ie.prototype.toArray=function(){return this.take(ie)},Sr(Ie.prototype,function(e,i){var s=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),h=p[c?"take"+(i=="last"?"Right":""):i],v=c||/^find/.test(i);h&&(p.prototype[i]=function(){var P=this.__wrapped__,T=c?[1]:arguments,L=P instanceof Ie,Q=T[0],Y=L||ve(P),Z=function(Se){var Oe=h.apply(p,Vr([Se],T));return c&&ne?Oe[0]:Oe};Y&&s&&typeof Q=="function"&&Q.length!=1&&(L=Y=!1);var ne=this.__chain__,ue=!!this.__actions__.length,de=v&&!ne,we=L&&!ue;if(!v&&Y){P=we?P:new Ie(this);var pe=e.apply(P,T);return pe.__actions__.push({func:ps,args:[Z],thisArg:r}),new hr(pe,ne)}return de&&we?e.apply(this,T):(pe=this.thru(Z),de?c?pe.value()[0]:pe.value():pe)})}),ur(["pop","push","shift","sort","splice","unshift"],function(e){var i=Mn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var h=arguments;if(c&&!this.__chain__){var v=this.value();return i.apply(ve(v)?v:[],h)}return this[s](function(P){return i.apply(ve(P)?P:[],h)})}}),Sr(Ie.prototype,function(e,i){var s=p[i];if(s){var c=s.name+"";Re.call(Ri,c)||(Ri[c]=[]),Ri[c].push({name:i,func:s})}}),Ri[as(r,oe).name]=[{name:"wrapper",func:r}],Ie.prototype.clone=lp,Ie.prototype.reverse=hp,Ie.prototype.value=fp,p.prototype.at=ky,p.prototype.chain=zy,p.prototype.commit=Hy,p.prototype.next=Vy,p.prototype.plant=Ky,p.prototype.reverse=Wy,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=Gy,p.prototype.first=p.prototype.head,Qi&&(p.prototype[Qi]=By),p},Ti=Hd();ni?((ni.exports=Ti)._=Ti,Vs._=Ti):Ct._=Ti}).call(wn)})(wa,wa.exports);var mI=Object.defineProperty,vI=Object.defineProperties,_I=Object.getOwnPropertyDescriptors,Ch=Object.getOwnPropertySymbols,wI=Object.prototype.hasOwnProperty,bI=Object.prototype.propertyIsEnumerable,Ah=(o,t,r)=>t in o?mI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Is=(o,t)=>{for(var r in t||(t={}))wI.call(t,r)&&Ah(o,r,t[r]);if(Ch)for(var r of Ch(t))bI.call(t,r)&&Ah(o,r,t[r]);return o},EI=(o,t)=>vI(o,_I(t));function Wi(o,t,r){var n;const a=lI(o);return((n=t.rpcMap)==null?void 0:n[a.reference])||`${yI}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function Ei(o){return o.includes(":")?o.split(":")[1]:o}function Rf(o){return o.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function SI(o,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(o));if(!r.length)return[];const n=[];return r.forEach(a=>{const l=t.namespaces[a].accounts;n.push(...l)}),n}function II(o={},t={}){const r=Rh(o),n=Rh(t);return wa.exports.merge(r,n)}function Rh(o){var t,r,n,a;const l={};if(!fI(o))return l;for(const[g,O]of Object.entries(o)){const N=Ba(g)?[g]:O.chains,F=O.methods||[],C=O.events||[],U=O.rpcMap||{},K=En(g);l[K]=EI(Is(Is({},l[K]),O),{chains:aa(N,(t=l[K])==null?void 0:t.chains),methods:aa(F,(r=l[K])==null?void 0:r.methods),events:aa(C,(n=l[K])==null?void 0:n.events),rpcMap:Is(Is({},U),(a=l[K])==null?void 0:a.rpcMap)})}return l}function OI(o){return o.includes(":")?o.split(":")[2]:o}function xI(o){const t={};for(const[r,n]of Object.entries(o)){const a=n.methods||[],l=n.events||[],g=n.accounts||[],O=Ba(r)?[r]:n.chains?n.chains:Rf(n.accounts);t[r]={chains:O,methods:a,events:l,accounts:g}}return t}function ca(o){return typeof o=="number"?o:o.includes("0x")?parseInt(o,16):o.includes(":")?Number(o.split(":")[1]):Number(o)}const $f={},Ze=o=>$f[o],ua=(o,t)=>{$f[o]=t};class PI{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=Ei(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Wi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ti(new yi(n,Ze("disableProviderPing")))}}class NI{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||Wi(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ti(new yi(n,Ze("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=parseInt(Ei(r));t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const l=parseInt(a,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class TI{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=Ei(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Wi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ti(new yi(n,Ze("disableProviderPing")))}}class CI{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=Ei(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Wi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ti(new yi(n,Ze("disableProviderPing")))}}class AI{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),a=Ei(r);t[a]=this.createHttpProvider(a,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ti(new yi(n,Ze("disableProviderPing")))}}class RI{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=Ei(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Wi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ti(new yi(n,Ze("disableProviderPing")))}}class $I{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ri.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=Ei(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Wi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ti(new yi(n,Ze("disableProviderPing")))}}var FI=Object.defineProperty,DI=Object.defineProperties,jI=Object.getOwnPropertyDescriptors,$h=Object.getOwnPropertySymbols,UI=Object.prototype.hasOwnProperty,LI=Object.prototype.propertyIsEnumerable,Fh=(o,t,r)=>t in o?FI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Os=(o,t)=>{for(var r in t||(t={}))UI.call(t,r)&&Fh(o,r,t[r]);if($h)for(var r of $h(t))LI.call(t,r)&&Fh(o,r,t[r]);return o},la=(o,t)=>DI(o,jI(t));class Ka{constructor(t){this.events=new Na,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:xe.pino(xe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Nh})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Ka(t);return await r.initialize(),r}async request(t,r){const[n,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:Os({},t),chainId:`${n}:${a}`,topic:this.session.topic})}sendAsync(t,r,n){this.request(t,n).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:xh("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await a().then(l=>{this.session=l,this.namespaces||(this.namespaces=xI(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==Cf)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,a]=this.validateChain(t);this.getProvider(n).setDefaultChain(a,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Ph(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await QS.init({logger:this.providerOpts.logger||Nh,relayUrl:this.providerOpts.relayUrl||dI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>En(r)))];ua("client",this.client),ua("events",this.events),ua("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=SI(r,this.session),a=Rf(n),l=II(this.namespaces,this.optionalNamespaces),g=la(Os({},l[r]),{accounts:n,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new NI({namespace:g});break;case"solana":this.rpcProviders[r]=new TI({namespace:g});break;case"cosmos":this.rpcProviders[r]=new CI({namespace:g});break;case"polkadot":this.rpcProviders[r]=new PI({namespace:g});break;case"cip34":this.rpcProviders[r]=new AI({namespace:g});break;case"elrond":this.rpcProviders[r]=new RI({namespace:g});break;case"multiversx":this.rpcProviders[r]=new $I({namespace:g});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const a=n.data;a&&Ph(a)&&this.events.emit("accountsChanged",a.map(OI))}else if(n.name==="chainChanged"){const a=r.chainId,l=r.event.data,g=En(a),O=ca(a)!==ca(l)?`${g}:${ca(l)}`:a;this.onChainChanged(O)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:a}=r,l=(n=this.client)==null?void 0:n.session.get(t);this.session=la(Os({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",la(Os({},xh("USER_DISCONNECTED")),{data:t.topic}))}),this.on(ri.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(g=>En(g)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const a=En(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var n;if(!this.namespaces)return;const[a,l]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(l),((n=this.namespaces[a])!=null?n:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Th}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Th}/${t}`)}}const qI=Ka,MI="wc",kI="ethereum_provider",zI=`${MI}@2:${kI}:`,HI="https://rpc.walletconnect.com/v1/",ba=["eth_sendTransaction","personal_sign"],VI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Ea=["chainChanged","accountsChanged"],BI=["chainChanged","accountsChanged","message","disconnect","connect"];var KI=Object.defineProperty,WI=Object.defineProperties,GI=Object.getOwnPropertyDescriptors,Dh=Object.getOwnPropertySymbols,JI=Object.prototype.hasOwnProperty,QI=Object.prototype.propertyIsEnumerable,jh=(o,t,r)=>t in o?KI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Sn=(o,t)=>{for(var r in t||(t={}))JI.call(t,r)&&jh(o,r,t[r]);if(Dh)for(var r of Dh(t))QI.call(t,r)&&jh(o,r,t[r]);return o},Uh=(o,t)=>WI(o,GI(t));function Rs(o){return Number(o[0].split(":")[1])}function ha(o){return`0x${o.toString(16)}`}function YI(o){const{chains:t,optionalChains:r,methods:n,optionalMethods:a,events:l,optionalEvents:g,rpcMap:O}=o;if(!da(t))throw new Error("Invalid chains");const N={chains:t,methods:n||ba,events:l||Ea,rpcMap:Sn({},t.length?{[Rs(t)]:O[Rs(t)]}:{})},F=l==null?void 0:l.filter(J=>!Ea.includes(J)),C=n==null?void 0:n.filter(J=>!ba.includes(J));if(!r&&!g&&!a&&!(F!=null&&F.length)&&!(C!=null&&C.length))return{required:t.length?N:void 0};const U=(F==null?void 0:F.length)&&(C==null?void 0:C.length)||!r,K={chains:[...new Set(U?N.chains.concat(r||[]):r)],methods:[...new Set(N.methods.concat(a!=null&&a.length?a:VI))],events:[...new Set(N.events.concat(g!=null&&g.length?g:BI))],rpcMap:O};return{required:t.length?N:void 0,optional:r.length?K:void 0}}class Wa{constructor(){this.events=new Nr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=zI,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Wa;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:n}=YI(this.rpc);try{const a=await new Promise(async(g,O)=>{var N;this.rpc.showQrModal&&((N=this.modal)==null||N.subscribeModal(F=>{!F.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),O(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Uh(Sn({namespaces:Sn({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(F=>{g(F)}).catch(F=>{O(new Error(F.message))})});if(!a)return;const l=bv(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:l),this.setAccounts(l),this.events.emit("connect",{chainId:ha(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",ha(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Uh(Sn({},Sv("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",ha(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,n,a]=t.split(":");return{chainId:`${r}:${n}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,n;const a=(r=t==null?void 0:t.chains)!=null?r:[],l=(n=t==null?void 0:t.optionalChains)!=null?n:[],g=a.concat(l);if(!g.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const O=a.length?(t==null?void 0:t.methods)||ba:[],N=a.length?(t==null?void 0:t.events)||Ea:[],F=(t==null?void 0:t.optionalMethods)||[],C=(t==null?void 0:t.optionalEvents)||[],U=(t==null?void 0:t.rpcMap)||this.buildRpcMap(g,t.projectId),K=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(J=>this.formatChainId(J)),optionalChains:l.map(J=>this.formatChainId(J)),methods:O,events:N,optionalMethods:F,optionalEvents:C,rpcMap:U,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:K,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const n={};return t.forEach(a=>{n[a]=this.getRpcUrl(a,r)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Rs(this.rpc.chains):Rs(this.rpc.optionalChains),this.signer=await qI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await rv(()=>import("./index-65c577a6.js").then(a=>a.i),["assets/index-65c577a6.js","assets/index-f9203ab0.js","assets/index-be01e7d4.css"]);r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Sn({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:n,rpcMap:a}=t;r&&da(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)})),n&&da(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(l=>this.formatChainId(l)),n.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)}))}getRpcUrl(t,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${HI}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const lO=Wa;export{lO as EthereumProvider,BI as OPTIONAL_EVENTS,VI as OPTIONAL_METHODS,Ea as REQUIRED_EVENTS,ba as REQUIRED_METHODS,Wa as default};
